<!DOCTYPE html>
<html lang="en-US">
<head>
<title>ERDDAP - Set Up Your Own ERDDAP</title>
<meta charset="UTF-8">
<link rel="shortcut icon" href="https://coastwatch.pfeg.noaa.gov/erddap/images/favicon.ico">
<link href="../images/erddap2.css" rel="stylesheet" type="text/css">
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body> 
<table class="compact nowrap" style="width:100%; background-color:#128CB5;"> 
  <tr> 
    <td style="text-align:center; width:80px;"><a rel="bookmark"
      href="https://www.noaa.gov/"><img 
      title="National Oceanic and Atmospheric Administration" 
      src="../images/noaab.png" alt="NOAA"
      style="vertical-align:middle;"></a></td> 
    <td style="text-align:left; font-size:x-large; color:#FFFFFF; ">
      <strong>ERDDAP</strong>
      <br><small><small><small>Easier access to scientific data</small></small></small>
      </td> 
    <td style="text-align:right; font-size:small;"> 
      &nbsp; &nbsp;
      <br>Brought to you by 
      <a title="National Oceanic and Atmospheric Administration" rel="bookmark"
      href="https://www.noaa.gov">NOAA</a>  
      <a title="National Marine Fisheries Service" rel="bookmark"
      href="https://www.fisheries.noaa.gov">NMFS</a>  
      <a title="Southwest Fisheries Science Center" rel="bookmark"
      href="https://swfsc.noaa.gov">SWFSC</a> 
      <a title="Environmental Research Division" rel="bookmark"
      href="https://swfsc.noaa.gov/textblock.aspx?Division=ERD&amp;id=1315&amp;ParentMenuId=200">ERD</a>  
      &nbsp; &nbsp;
      </td> 
  </tr> 
</table>

<div class="standard_width"> 

&nbsp;

<h1 style="text-align:center;">Set Up Your Own ERDDAP</h1>
<div style="text-align:center;">Why? |
<a rel="help" href="#initialSetup">Initial Setup</a> | 
<a rel="help" href="#update">Update</a> | 
<a rel="help" href="#needToKnow">Need To Know</a> | 
<a rel="help" href="#dontNeedToKnow">Don't Need To Know</a> | 
<br>
<a rel="help" href="#slideShows">Slide Shows</a> | 
<a rel="help" href="#programmersGuide">Programmer's Guide</a> | 
<a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/changes.html">List of Changes</a> | 
<a rel="license" href="#credits">Credits</a> | 
<a rel="license" href="#license">License</a> |
<a rel="help" href="#contact">Contact</a>
<br>&nbsp;
<br>And see the related document 
<a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html"><strong>Working with the datasets.xml File</strong></a>
</div>

<p>ERDDAP is a
<a rel="bookmark" href="https://en.wikipedia.org/wiki/Free_and_open-source_software"
   >Free and Open Source<img 
   src="../images/external.png" alt=" (external link)" 
   title="This link to an external website does not constitute an endorsement."></a>,
all-Java (servlet), web application that
runs in a web application server 
(for example, Tomcat). This web page is mostly for people ("ERDDAP administrators")
who want to set up their own ERDDAP installation at their own website.

<h2><a class="selfLink" id="why" href="#why" rel="bookmark">Why use ERDDAP to distribute your data?</a></h2>
Because the small effort to setup ERDDAP brings many benefits.
<ul>
<li>If you already have a web service for distributing your data, 
  <br>you can set up ERDDAP to access your data via the existing service.
  <br>Or, you can set up ERDDAP to access your data directly from local files.
<li>For each dataset, you only have to write a small chunk of XML to tell ERDDAP how to access the dataset.
<li>Once you have ERDDAP serving your data, end users can:
  <ul>
  <li>Request the data in various ways (DAP, WMS, and more in the future).
  <li>Get the data response in various file formats.  (That's probably the biggest reason!)
  <li>Make graphs and maps.  (Everyone likes pretty pictures.)
  <li>Build other useful and interesting things on top of ERDDAP's web services
    -- see the 
    <a rel="bookmark" href="https://github.com/IrishMarineInstitute/awesome-erddap">Awesome ERDDAP<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
      list of awesome ERDDAP-related projects.
  </ul>
</ul>
You can <a rel="help" href="#customize">customize</a> your ERDDAP's appearance 
so ERDDAP reflects your organization and fits in with the rest of your website.

<h2><a class="selfLink" id="organizations" href="#organizations" rel="bookmark">ERDDAP 
 has been installed by over 80 organizations in at least 10 countries
 (Australia, Canada, France, Ireland, Italy, South Africa, Spain, Thailand, UK, USA),</a></h2>
 including:
<ul>
<li><a rel="bookmark" href="http://apdrc.soest.hawaii.edu/erddap/index.html">APDRC</a>
(Asia-Pacific Data-Research Center, International Pacific Research Center) 
at the University of Hawaii (UH)
  <!-- 2017-07-20 email Kin Lik Wang  -->
<li><a rel="bookmark" href="https://erddap.bco-dmo.org/erddap/index.html">BCO-DMO at WHOI</a> 
(Biological and Chemical Oceanography Data Management Office at Woods Hole Oceanographic Institution)
  <!-- 2017-11-20 email from Adam Shepherd  -->
<li><a rel="bookmark" href="http://rs-data1-mel.csiro.au/erddap/index.html">CSIRO and IMOS</a> (Australia's Commonwealth Scientific and Industrial Research Organisation and the Integrated Marine Observing System)
  <!-- 2015-06-28 email Jonathan Hodge  -->
<li><a rel="bookmark" href="http://erddap.emodnet-physics.eu/erddap/index.html">EMODnet Physics</a> 
(The European Marine Observation and Data Network -- Physics)
  <!-- 2017-08-21 marco.alba at ettsolutions.com announced it on ERDDAP Google Group  -->
<li><a rel="bookmark" href="http://erddap.incois.gov.in/erddap/index.html">INCOIS</a> 
(Indian National Centre for Ocean Information Services)
  <!-- 2017-08-08 email Devender Raju, was https://bluehub.jrc.ec.europa.eu/erddap/index.html  -->
<li>IPSC JRC EC (Maritime Affairs Unit, Institute for the Protection and Security of the Citizen,
Joint Research Centre of the European Commission)
  <!-- 2014-11-19 and 2015-03-18 Conor Delaney  -->
<li>IRD (Institut de Recherche pour le Développement, France)
  <br>CNRS (Centre National de la Recherche Scientifique, France)
  <br>UPMC (Université Pierre et Marie CURIE, Paris, France)
  <br>UCAD (Université Cheikh Anta Diop de Dakar, Sénégal)
  <br>UGB (Université Gaston Berger -- Saint-Louis du Sénégal)
  <br>UFHB (Université Félix HOUPHOUËT-BOIGNY, Abidjan, Côte d'Ivoire)
  <br>IPSL (Institut Pierre Simon Laplace des sciences de l'environnement, Paris, France)
  <br>LMI ECLAIRS (Laboratoire Mixte International «Etude du Climat en Afrique de l’Ouest et de ses Interactions avec l’Environnement Régional, et appui aux services climatiques») 
  <!-- 2015-03-17 Thierry Valero -->
<li><a rel="bookmark" href="https://erddap.marine.ie/erddap/index.html">The Marine Institute</a>  (Ireland)
  <!-- 2015-03-19 Damian Smyth -->
<li>Marine Instruments S.A. (Spain)
  <!-- 2015-03-25 Iago Tejeda Pérez -->
<li><a rel="bookmark" href="http://cwcgom.aoml.noaa.gov/erddap/index.html">NOAA CW CGOM</a>  (CoastWatch Caribbean/Gulf of Mexico Node)
  <!-- assumed public, Joaquin Trinanes -->
<li><a rel="bookmark" href="https://coastwatch.pfeg.noaa.gov/erddap/index.html">NOAA CW WC</a>  (CoastWatch West Coast Node) which is co-located with and works with 
  <!-- 2015-03-17 Bob Simons-->
<br><a rel="bookmark" href="https://coastwatch.pfeg.noaa.gov/erddap/index.html">NOAA ERD</a>  (Environmental Research Division of SWFSC of NMFS)
  <!-- 2015-03-17 Bob Simons (since this is a public IOOS server) -->
<li><a rel="bookmark" href="http://erddap.sensors.ioos.us/erddap/">NOAA IOOS Sensors</a> 
  (Integrated Ocean Observing System) 
  <!-- was 2017-11-13 Tiffany Vance email announcement -->
<li><a rel="bookmark" href="http://erddap.axiomdatascience.com/erddap/index.html">NOAA IOOS CeNCOOS</a> (Central and Northern California Ocean Observing System, run by Axiom Data Science) 
  <!-- was 2015-03-18 Jennifer Patterson -->
<li><a rel="bookmark" href="http://www.neracoos.org/erddap/index.html">NOAA IOOS NERACOOS</a> (Northeastern Regional Association of Coastal and Ocean Observing Systems) 
  <!-- 2015-03-18 Eric Bridger -->
<li><a rel="bookmark" href="https://data.ioos.us/gliders/erddap/index.html">NOAA IOOS NGDAC</a> (National Glider Data Assembly Center) 
  <!-- 2015-03-17 Luke Campbell -->
<li><a rel="bookmark" href="http://oos.soest.hawaii.edu/erddap/index.html">NOAA IOOS PacIOOS</a> (Pacific Islands Ocean Observing System) at the University of Hawaii (UH) 
  <!-- 2015-03-16 John Maurer, 2015-03-17 James Potemra -->
<li><a rel="bookmark" href="http://sccoos.org/erddap/index.html">NOAA IOOS SCCOOS</a> 
(Southern California Coastal Ocean Observing System) 
  <!-- 2015-05-26 Sarah Heim -->
<li><a rel="bookmark" href="http://erddap.secoora.org/erddap/index.html">NOAA IOOS SECOORA</a> (Southeast Coastal Ocean Observing Regional Association) 
  <!-- 2015-03-27 Jeremy Cothran -->
<li><a rel="bookmark" href="https://ecowatch.ncddc.noaa.gov/erddap/index.html">NOAA NCEI</a> (National Centers for Environmental Information) / NCDDC 
  <!-- 2015-03-17 (was NCDDC) Glenn Rutledge, Charles Carleton -->
<li>NOAA NGDC STP (National Geophysical Data Center, Solar -- Terrestrial Physics)
  <!-- 2015-03-23 Dominic Fuller-Rowell -->
<li><a rel="bookmark" href="http://osmc.noaa.gov/erddap/index.html">NOAA OSMC</a> (Observing System Monitoring Center) 
  <!-- 2015-03-23 Kevin O'Brien -->
<li><a rel="bookmark" href="https://upwell.pfeg.noaa.gov/erddap/index.html">NOAA UAF</a> (Unified Access Framework)
  <!-- 2015-03-17 Bob Simons-->
<li><a rel="bookmark" href="http://dap.onc.uvic.ca/erddap/index.html"
 >Ocean Networks Canada</a>
  <!-- 2015-03-17 Reyna Jenkyns -->
<li><a rel="bookmark"
  href="https://erddap-uncabled.oceanobservatories.org/uncabled/erddap/index.html"
  >Ocean Observatories Initiative (OOI) / Uncabled Data</a>
  <!-- 2017-10-19 They made it public. -->
<li><a rel="bookmark" href="https://members.oceantrack.org/erddap/index.html"
  >Ocean Tracking Network</a>
  <!-- 2017-05-15 Jonathan Pye -->
<li><a rel="bookmark" href="http://hydromet-thredds.princeton.edu:8000/erddap/index.html">Princeton, Hydrometeorology Research Group</a>
  <!-- 2017-05-17 James Smith -->
<li><a rel="bookmark" href="https://meteo.rtech.fr/erddap/index.html">R.Tech Engineering</a>, France 
  <!-- 2015-03-20 Philippe Makowski -->
<li><a rel="bookmark" href="https://www.myroms.org:8080/erddap/"
  >Rutgers University, Department of Marine and Coastal Sciences</a>
 and
 <a rel="bookmark"
 href="http://tds.marine.rutgers.edu/erddap/info/index.html?page=1&amp;itemsPerPage=1000"
 >a second ERDDAP</a>
  <!-- 2017-05-16 John Wilkin -->
<li><a rel="bookmark" href="http://sfbaynutrients.sfei.org/erddap/index.html"
 >San Francisco Estuary Institute</a>
  <!-- 2016-10-26 Rusty Holleman -->
<li><a rel="bookmark" href="https://spraydata.ucsd.edu/erddap/index.html"
 >Scripps Institution of Oceanography, Spray Underwater Gliders</a>
  <!-- 2018-02-01 Guilherme Pimenta Castelao -->
<li>South African Environmental Observation Network
  <!-- 2018-01-19 Kyle Cooper -->
<li>Spyglass Technologies 
  <!-- 2015-08-24 Paul Janecek -->
<li>Stanford University, Hopkins Marine Station 
  <!-- 2015-03-24 James Ganong -->
<li>USGS Coastal and Marine Geology Program 
  <!-- 2015-03-18 Ellyn Montgomery -->
<li><a rel="bookmark" href="https://salishsea.eos.ubc.ca/erddap/index.html"
  >University of British Columbia, Earth, Ocean &amp; Atmospheric Sciences Department</a>
  <!-- 2017-05-18 Doug Latornell -->
<li><a rel="bookmark" href="http://bmlsc.ucdavis.edu:8080/erddap/index.html"
 >University of California at Davis, Bodega Marine Laboratory</a>
  <!-- 2015-03-17 Marcel Losekoot -->
<li>University of Washington, Applied Physics Laboratory
  <!-- 2015-04-02 Mike Harrington -->
</ul>
This is a list of just some of the organizations where ERDDAP has been installed 
by some individual or some group. 
It does not imply that the individual, the group, or the organization recommends
or endorses ERDDAP.

<p><strong>ERDDAP is recommended within NOAA</strong> 
<br><a rel="bookmark" 
href="https://geo-ide.noaa.gov/wiki/index.php?title=Data_Access_Technical_Recommendations#Software_implementations">NOAA's Data Access Procedural Directive<img 
  src="../images/external.png" alt=" (external link)" 
  title="This is a link to an external website."/></a> 
includes ERDDAP in its list of recommended data servers for use by groups within NOAA. 

<h2>Is the installation procedure hard? Can I do it?</h2>
The initial installation takes some time, but it isn't very hard. You can do it.
If you get stuck, email me at <kbd>bob dot simons at noaa dot gov</kbd> .  I will help you.
<br>Or, you can join the <a rel="help"
href="#ERDDAPMailingList">ERDDAP Google Group / Mailing List</a> 
and post your question there.


<!-- ******* -->
<h2><a class="selfLink" id="initialSetup" href="#initialSetup" rel="bookmark">How To Do the Initial Setup of ERDDAP on Your Server</a></h2>
ERDDAP can run on any server that supports Java and Tomcat (and perhaps other application servers).  
ERDDAP has been tested on Linux (including on Amazon's AWS), Mac, and Windows computers.   
<ul>
<li><strong>Amazon</strong> -- If you are installing
ERDDAP on an Amazon Web Services EC2 instance, see this 
<a rel="help" href="#amazon">Amazon Web Services Overview</a> (below)
first.
<li><strong>Docker</strong> -- Axiom now offers 
<a rel="bookmark" href="https://hub.docker.com/u/axiom/">ERDDAP in a Docker container<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>.
    <br>If you don't already use Docker, we don't recommend this. 
    <br>If you chose to install ERDDAP via Docker, we don't offer any support
      for the installation process.
    <br>We haven't worked with Docker yet. If you work with this, please send us your comments.

<li><strong>Linux and Macs</strong> -- ERDDAP works great on Linux and Mac computers. 
<li><strong>Windows</strong> -- Windows is fine for testing ERDDAP and for personal use, 
but we don't recommend using it for public ERDDAPs. 
Running ERDDAP on Windows may have problems: 
notably, ERDDAP may be unable to delete 
and/or rename files quickly. This is probably due to antivirus software (e.g., from McAfee
and Norton) which is checking the files for viruses. If you run into this problem (which
can be seen by error messages in the <a rel="help" href="#log">log.txt</a> file like "Unable to delete ..."), changing the
antivirus software's settings may partially alleviate the problem. Or consider using a Linux
or Mac server instead.
</ul>

<p><strong>The standard ERDDAP installation instructions are:</strong>
<ol>
<li><a class="selfLink" id="java" href="#java" rel="bookmark">Set up Java 8 (also known as 1.8).</a>  
    <br>For security reasons, it is almost always best to use the latest version of Java 8.
    <br>Please download and install the latest version of  
    <br><a rel="bookmark" href="https://adoptopenjdk.net/">AdoptOpenJDK's OpenJDK 8 (LTS) + HotSpot<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>.
    To verify the installation, type "/<i>javaJreBinDirectory</i>/java -version", for example
    <br><kbd>/usr/local/jdk8u202-b08/jre/bin/java -version</kbd> <!-- javaVersion -->

    <p>ERDDAP works with Java from other sources, but we recommend AdoptOpenJDK because it is the 
    main, community-supported, free (as in beer and speech) version of Java 8 <!-- javaVersion -->
    that offers Long Term Support (free upgrades until at least September 2023).
    For security reasons, please update your ERDDAP's version of Java periodically 
    as new versions of Java 8 become available from AdoptOpenJDK. <!-- javaVersion -->

    <p>ERDDAP has been tested and used extensively with Java 8 (also known as 1.8), 
    not other versions.
    For various reasons, we have not tested ERDDAP with Java 9, 10, or 11, 
    and thus don't support them yet.
    Java 7 (1.7) is no longer supported because it reached its 
    <a rel="help" href="https://www.oracle.com/technetwork/java/eol-135779.html">end of life<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
    and so is no longer supported by Oracle or AdoptOpenJDK. 
    <br>&nbsp;

<li><a class="selfLink" id="tomcat" href="#tomcat" rel="bookmark">Set up</a> <!-- tomcatVersion below -->
    <a rel="help" href="https://tomcat.apache.org/download-80.cgi">Tomcat 8<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>.    
    <br>For security reasons, it is almost always best to use the latest version of Tomcat 8, <!-- tomcatVersion -->
    which is designed to work with Java 8 (1.8). <!-- javaVersion -->
    Below, the Tomcat directory will be referred to as <i>tomcat</i>.
    Warning! If you already have a Tomcat running some other web application (especially THREDDS), 
    we recommend that you install ERDDAP in 
      <a rel="help" href="#secondTomcat">a&nbsp;second&nbsp;Tomcat</a>,
      because ERDDAP needs different Tomcat settings 
    and shouldn't have to contend with other applications for memory.
    <br>&nbsp;
    <ul>

    <li>Follow the instructions at    <!-- tomcatVersion below -->
      <a rel="help" href="https://tomcat.apache.org/download-80.cgi">https://tomcat.apache.org/<img 
        src="../images/external.png" alt=" (external link)" 
        title="This link to an external website does not constitute an endorsement."></a> 
      to set up Tomcat 8 on your server.
      <br>On Linux, we recommend installing it in /usr/local.
      <br>On a Mac, it is probably already installed in /Library/Tomcat,
        but you may want to update it to the latest version of Tomcat 8. <!-- tomcatVersion -->
      <br>On Windows, select the "32-bit/64-bit Windows Service Installer".
        It will be installed in c:/Program Files.
      <br>&nbsp;

    <li><a class="selfLink" id="server.xml" href="#server.xml" rel="bookmark"
      >server.xml</a> -
      In <i>tomcat</i>/conf/server.xml file, 
      there are two changes that you should make to each of the two 
      &lt;Connector&gt; tags (one for port="8080" and one for port="8443"):
      <ol>
      <li>Increase the <kbd>connectionTimeout</kbd> parameter value, perhaps to 
        300000 (milliseconds) (which is 5 minutes).
      <li>Add a new parameter: <kbd>relaxedQueryChars='[]|'</kbd> 
        This removes the need for users to percent-encode these characters when 
        they occur in the parameters of a user's request URL.
        <br>&nbsp;
      </ol>
     
    <li><a class="selfLink" id="ResourcesCache" href="#ResourcesCache" rel="bookmark">Resources Cache</a>
      <br>To avoid Tomcat throwing warnings during startup about 
          "org.apache.catalina.webresources.Cache.getResource Unable to add the resource 
          at <i>someFile</i> to the cache because there was insufficient free space 
          available after evicting expired cache entries -- consider increasing the 
          maximum size of the cache",
          do this:
      <br>In your [tomcat]/conf/context.xml, add this tag right before &lt;/Context&gt; :
      <!-- 2019-05-22 On Bob's PC 50000 KB was sufficient. Add extra to be safe. -->
      <br><kbd>&lt;Resources cachingAllowed="true" cacheMaxSize="80000" /&gt;</kbd>
      <br>(or some other number, in KB.)
      <br>For more information see
          <a rel="help"
            href="https://tomcat.apache.org/tomcat-8.0-doc/config/resources.html"
                 >https://tomcat.apache.org/tomcat-8.0-doc/config/resources.html<img 
            src="../images/external.png" alt=" (external link)" 
            title="This link to an external website does not constitute an endorsement."></a>.

    <li><a class="selfLink" id="ApacheTimeout" href="#ApacheTimeout" rel="bookmark"
    >On Linux computers, change the Apache timeout settings</a>
    so that time-consuming user requests don't timeout 
    (with what often appears as a "Proxy" or "Bad Gateway" error).
    As the root user:
      <ol>
      <li>Modify the Apache httpd.conf file (usually in /etc/httpd/conf/ ):
        <br>Change the existing <kbd>&lt;Timeout&gt;</kbd> setting 
          (or add one at the end of the file)
          to 3600 (seconds), instead of the default 60 or 120 seconds.
        <br>Change the existing <kbd>&lt;ProxyTimeout&gt;</kbd> setting 
          (or add one at the end of the file)
          to 3600 (seconds), instead of the default 60 or 120 seconds.
      <li>Restart Apache: <kbd>/usr/sbin/apachectl -k graceful</kbd> 
        (but sometimes it is in a different directory).
        <br>&nbsp;
      </ol>

    <li>Security recommendation: you can remove some possible avenues for attackers by following 
      <a rel="help" href="http://www.j2eeprogrammer.com/2011/11/disabling-certain-http-methods-in.html"
      >these&nbsp;instructions<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
      (especially the article's second recommendation) 
      to disable certain HTTP methods 
      (TRACE, PUT, OPTIONS, DELETE) in Tomcat.
      (<a rel="help" href="https://www.owasp.org/index.php/Test_HTTP_Methods_(OTG-CONFIG-006)"
      >background&nbsp;information<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>)
      <br>&nbsp;

    <li>For public ERDDAP installations on Linux and Macs, 
      it is best to set up Tomcat (the program) as belonging to 
      user "tomcat" (a separate user with limited permissions and which <a rel="help" 
      href="https://unix.stackexchange.com/questions/56765/creating-an-user-without-a-password">has no password</a>.
      Thus, only the super user can switch to acting as user tomcat.
      This makes it impossible for hackers to log in to your server as user tomcat.
      And in any case, you should make it so that the tomcat user has very limited 
      permissions on the server's file system 
      (read+write+execute privileges for the apache-tomcat directory tree and 
      &lt;bigParentDirectory&gt; 
      and read-only privileges for directories with data that ERDDAP needs access to). 
      <ul>
      <li>You can create the tomcat user account (which has no password) by using the command
        <br><kbd>sudo useradd tomcat -s /bin/bash -p '*'</kbd>
      <li>You can switch to working as user tomcat by using the command
        <br><kbd>sudo su - tomcat</kbd>
        <br>(It will ask you for the superuser password for permission to do this.)
      <li>You can stop working as user tomcat by using the command
        <br><kbd>exit</kbd>
      <li>Do most of the rest of the Tomcat and ERDDAP setup instructions as user "tomcat".
        Later, run the startup.sh and shutdown.sh scripts as user "tomcat" so that Tomcat has 
        permission to write to its log files.
      <li>After unpacking Tomcat, from the parent of the apache-tomcat directory:
        <ul>
        <li>Change ownership of the apache-tomcat directory tree to the tomcat user.
          <br><kbd>chown -R tomcat apache-tomcat-<i>8.5.38</i></kbd>  <!-- tomcatVersion -->
          <br>(but substitute the actual name of your tomcat directory). 
        <li>Change the "group" to be tomcat, your username, 
          or the name of a small group that includes tomcat and 
          all the administrators of Tomcat/ERDDAP, e.g., 
          <br><kbd>chgrp -R <i>yourUserName</i> apache-tomcat-<i>8.5.38</i></kbd>  <!-- tomcatVersion -->
        <li>Change permissions so that tomcat and the group have 
          read, write, execute privileges, e.g,. 
          <br><kbd>chmod -R ug+rwx apache-tomcat-<i>8.5.38</i></kbd>  <!-- tomcatVersion -->
        <li>Remove "other" user's permissions to read, write, or execute:
          <br><kbd>chmod -R o-rwx apache-tomcat-<i>8.5.38</i></kbd>  <!-- tomcatVersion -->
          <br>This is important, because it prevents other users from
            reading possibly sensitive information in ERDDAP setup files.
        </ul>
      <br>&nbsp;
      </ul>

    <li><a class="selfLink" id="memory" href="#memory" rel="bookmark">Set</a> 
        <a class="selfLink" id="WindowsMemory" href="#WindowsMemory" rel="bookmark">Tomcat's</a>
        <a class="selfLink" id="MacMemory" href="#MacMemory" rel="bookmark">Environment</a> 
        <a class="selfLink" id="LinuxMemory" href="#LinuxMemory" rel="bookmark">Variables</a>
      
      <p>On Linux and Macs:
      <br>Create a file <i>tomcat</i>/bin/setenv.sh
      (or in Red Hat Enterprise Linux [RHEL], edit ~tomcat/conf/tomcat8.conf) <!-- tomcatVersion -->
      to set Tomcat's environment variables.
      This file will be used by <i>tomcat</i>/bin/startup.sh and shutdown.sh.
      The file should contain something like:<kbd>
      <br>export JAVA_HOME=/usr/local/jdk8u202-b08/jre  <!-- javaVersion -->
      <br>export JAVA_OPTS='-server -Djava.awt.headless=true -Xmx1500M -Xms1500M'
      <br>export TOMCAT_HOME=/usr/local/apache-tomcat-<i>8.5.38</i>         <!-- tomcatVersion -->
      <br>export CATALINA_HOME=/usr/local/apache-tomcat-<i>8.5.38</i></kbd>  <!-- tomcatVersion -->
      <br>(but substitute the directory names from your computer).        
      <br>(If you previously set JRE_HOME, you can remove that.)
      <br>On Macs, you probably don't need to set JAVA_HOME.

      <p>On Windows:
      <br>Create a file <i>tomcat</i>\bin\setenv.bat
      to set Tomcat's environment variables.
      This file will be used by <i>tomcat</i>\bin\startup.bat and shutdown.bat.
      The file should contain something like:<kbd>
      <br>SET "JAVA_HOME=\<i>someDirectory</i>\jdk8u202-b08\jre"  <!-- javaVersion -->
      <br>SET "JAVA_OPTS=-server -Xmx1500M -Xms1500M"
      <br>SET "TOMCAT_HOME=\Program Files\apache-tomcat-<i>8.5.38</i>"         <!-- tomcatVersion -->
      <br>SET "CATALINA_HOME=\Program Files\apache-tomcat-<i>8.5.38</i>"</kbd>  <!-- tomcatVersion -->
      <br>(but substitute the directory names from your computer).
      <br>If this is just for local testing, remove "-server".      
      <br>(If you previously set JRE_HOME, you can remove that.)

      <p>The -Xmx and -Xms memory settings are important 
      <br>because ERDDAP works better with more 
      memory. Always set -Xms to the same value as -Xmx.
      <ul>
        <li>For 32 bit Operating Systems and 32 bit Java:
        <br>The more physical memory in the server the better: 4+ GB is really good, 2 GB is okay, 
        less is not recommended.  With 32 bit Java, even with abundant physical memory, 
        Tomcat and Java won't run if you try to set -Xmx much above 1500M (1200M on some computers).
        If your server has less than 2GB of memory, reduce the -Xmx value (in 'M'egaBytes) 
        to 1/2 of the computer's physical memory.

        <li>For 64 bit Operating Systems and 64 bit Java:
        <br>64 bit Java will only work on a 64 bit operating system.
        To enable 64 bit Java, add -d64 to the list of JAVA_OPTS in startup.sh and shutdown.sh, for example, 
        <br><kbd>export JAVA_OPTS='-server -Djava.awt.headless=true -Xmx8000M -Xms8000M -d64'</kbd>
        <br>With 64 bit Java, Tomcat and Java can use very high -Xmx and -Xms settings.
        The more physical memory in the server the better. As a simplistic suggestion: 
        we recommend you set -Xmx and -Xms to (in 'M'egaBytes) to 1/2 (or less) of the computer's
        physical memory.
        You can see if Tomcat, Java, and ERDDAP are indeed running in 64 bit mode by searching for 
        " bit," in ERDDAP's Daily Report email or in the 
        <i>bigParentDirectory</i>/logs/<a rel="help" href="#log">log.txt</a> file 
        (<i>bigParentDirectory</i> is specified in 
          <a rel="help" href="#setup.xml">setup.xml</a>). 

        <li><a class="selfLink" id="GC" href="#GC" rel="bookmark"
          >In ERDDAP's</a> <a rel="help" href="#log">log.txt</a> file, 
        you will see many "GC (Allocation Failure)" messages.
        <br>This is usually not a problem. It is a frequent message from a normally 
        operating Java saying that it just finished a minor garbage collection
        because it ran out of room in Eden (the section of the Java heap for 
        very young objects). Usually the message shows you 
        <i>memoryUseBefore</i>-&gt;<i>memoryUseAfter</i>.  
        If those two numbers are close together, it means that the garbage 
        collection wasn't productive. The message is only a sign of trouble 
        if it is very frequent (every few seconds), not productive, 
        and the numbers are large and not growing, 
        which together indicate that Java needs more memory, 
        is struggling to free up memory, 
        and is unable to free up memory.
        This may happen during a stressful time, then go away. But if it persists,
        that is a sign of trouble.

        <li>If you see java.lang.OutOfMemoryError's in ERDDAP's <a rel="help" href="#log">log.txt</a> file,
        see <a href="#OutOfMemoryError" rel="bookmark">OutOfMemoryError</a>
        for tips on how to diagnose and resolve the problems.
        <br>&nbsp;
      </ul>

      <!--p>Optional: You can add <kbd>-verbose:gc</kbd> to the JAVA_OPTS (or to the list of Java Options
      <br>in the Window's Tomcat Manager icon in the systemtry). It tells Java to send   
  <a rel="help" href="https://download.oracle.com/javase/technologies/hotspot/gc/gc_tuning_6.html">Java garbage collection</a>
      information to <i>tomcat</i>/logs/catalina.out (or some other Tomcat log file) 
      which is useful if your ERDDAP has memory problems. -->

    <li><a class="selfLink" id="permissions" href="#permissions" rel="bookmark">On Linux and Macs, change the permissions</a>
      of all *.sh files in <i>tomcat</i>/bin/ to be executable by the owner, e.g., with
      <br><kbd>chmod +x *.sh</kbd>
      <br>&nbsp;

    <li><a class="selfLink" id="fonts" href="#fonts" rel="bookmark">Fonts for images:</a>
      We strongly prefer the free 
      <a rel="help" href="https://dejavu-fonts.github.io/">DejaVu fonts<img 
          src="../images/external.png" alt=" (external link)" 
          title="This link to an external website does not constitute an endorsement."></a>       
      to the other Java fonts. 
      Using these fonts is strongly recommended but not required.  

      <p>If you choose not to use the DejaVu fonts, you need to change the fontFamily setting in 
        setup.xml to <kbd>&lt;fontFamily&gt;SansSerif&lt;/fontFamily&gt;</kbd>,
        which is available with all Java distributions. If you set fontFamily to 
        the name of a font that isn't available, ERDDAP won't load and will 
        print a list of available fonts in the log.txt file. You must use one of those fonts.

      <p>If you choose to use the DejaVu fonts, please make sure the fontFamily setting in 
        setup.xml is <kbd>&lt;fontFamily&gt;DejaVu Sans&lt;/fontFamily&gt;</kbd>. 
        
      <p>To install the DejaVu fonts, please download 
          <a rel="bookmark"  href="https://coastwatch.pfeg.noaa.gov/erddap/download/DejaVuFonts.zip">DejaVuFonts.zip</a> 
          (5,522,795 bytes, MD5=33E1E61FAB06A547851ED308B4FFEF42) 
          and unzip the font files to a temporary directory.
          <!-- was <fontFamily>Bitstream Vera Sans</fontFamily> 
            BitstreamVeraSans.zip (344,753 bytes, MD5=E16AF0C9838FD2443434F6E0E9FD0A0D) -->
        <ul>
        <li>On Linux:
          <ul>
          <li>With Linux AdoptOpenJDK Java distributions: DejaVu fonts are built in,
            so you don't have to do separately install them.
          <li>With other Java distributions: 
           As the Tomcat user, copy the font files into <i>JAVA_HOME</i>/lib/fonts 
           so Java can find the fonts.
           Remember: if/when you later upgrade to a newer version of Java, you need to reinstall
           these fonts.
          </ul>
        <li>On Macs: for each font file, double click on it and then click <kbd>Install Font</kbd>.
        <li>On Windows 7 and 10: in Windows Explorer, select all of the font files. 
            Right click.  Click on <kbd>Install</kbd>.
          <br>&nbsp;
        </ul>


    <li><a class="selfLink" id="testTomcat" href="#testTomcat" rel="bookmark">Test your Tomcat installation.</a>
      <ul>
      <li>Linux:
        <ul>
        <li>As user "tomcat", run <kbd><i>tomcat</i>/bin/startup.sh</kbd>
        <li>View your URL + ":8080/" in your browser (e.g., 
          <a href="https://coastwatch.pfeg.noaa.gov:8080/">https://coastwatch.pfeg.noaa.gov:8080/</a>).
        <li>You should see the Tomcat "Congratulations" page. 
          <br>If there is trouble, see the Tomcat log file <i>tomcat</i>/logs/catalina.out.
        </ul>
      <li>Mac (run tomcat as the system administrator user):
        <ul>
        <li>Run <kbd><i>tomcat</i>/bin/startup.sh</kbd>
        <li>View your URL + ":8080/" in your browser (e.g., 
          <a href="https://coastwatch.pfeg.noaa.gov:8080/">https://coastwatch.pfeg.noaa.gov:8080/</a>).
          Note that by default, your Tomcat is only accessible by you. It is not publicly accessible.
        <li>You should see the Tomcat "Congratulations" page. 
          <br>If there is trouble, see the Tomcat log file <i>tomcat</i>/logs/catalina.out.
        </ul>
      <li>Windows localhost: 
        <ul>
        <li>Right click on the Tomcat icon in the system tray, and choose "Start service".
        <li>View <a href="http://127.0.0.1:8080/">http://127.0.0.1:8080/</a> in your browser.
          Note that by default, your Tomcat is only accessible by you. It is not publicly accessible.
        <li>You should see the Tomcat "Congratulations" page. 
          <br>If there is trouble, see the Tomcat log file <i>tomcat</i>/logs/catalina.out.
        </ul>
        <br>&nbsp;
      </ul>

    <li>Troubles with the Tomcat installation? 
      <ul>
      <li>On Linux and Mac, if you can't reach Tomcat or ERDDAP (or perhaps
        you just can't reach them from a computer outside your firewall), 
        you can test if Tomcat is listening to port 8080, by typing (as root)
        on a command line of the server: 
        <br><kbd>netstat -tuplen | grep 8080</kbd> 
        <br>That should return one line with something like:
        <br><kbd>tcp 0 0 :::8080 :::* LISTEN ## ##### ####/java</kbd>
        <br>(where '#' is some digit), indicating that 
        a "java" process (presumably Tomcat) is listening on port "8080" for "tcp" traffic. 
        If no lines were returned, if the line returned is significantly different,  
        or if two or more lines were returned, 
        then there may be a problem with the port settings.
      <li>See the Tomcat log file <i>tomcat</i>/logs/catalina.out.  
        Tomcat problems and some ERDDAP startup problems are almost always indicated there.
        This is common when you are first setting up ERDDAP.
      <li>See the <a rel="help" href="https://tomcat.apache.org/">Tomcat<img 
          src="../images/external.png" alt=" (external link)" 
          title="This link to an external website does not constitute an endorsement."></a> 
        website or search the web for help,
        but please let us know the problems you had and the solutions you found.
      <li>Email me at <kbd>bob dot simons at noaa dot gov</kbd> .  I will try to help you.
      <li>Or, you can join the <a rel="help"
        href="#ERDDAPMailingList">ERDDAP Google Group / Mailing List</a> 
        and post your question there.
        <br>&nbsp;
      </ul>
    </ul>

<li><a class="selfLink" id="erddapContent" href="#erddapContent" rel="bookmark"
>Set up the <i>tomcat</i>/content/erddap configuration files.</a> 
  <!-- 
    <br>Starting 2019-06-18, we are currently testing ERDDAP v2.00. 
    We hope to make it publicly available around 2019-06-26. 
    Unless getting ERDDAP is urgent, we advise waiting for v2.00 to avoid the transition from v1.82 to v2.00.
    We're sorry for the inconvenience, but the new version is worth the wait. 
    <br>&nbsp;  -->

  <br>On Linux, Mac, and Windows, download
     <!-- Use: md5 erddapContent1.82.zip -->
    <a rel="bookmark"
    href="https://coastwatch.pfeg.noaa.gov/erddap/download/erddapContent.zip">erddapContent.zip</a>
    (version 2.00, 19,652 bytes, MD5=86DC8F13E660A6B2BEDBC7A61BD202C4, dated 2018-01-26)
    and unzip it into <i>tomcat</i>, creating <i>tomcat</i>/content/erddap .

  <p>Other Directory: For Red Hat Enterprise Linux (RHEL) or for other situations where
    you want/need to put the ERDDAP content directory in some other location, 
    unzip erddapContent.zip into ~tomcat (or some other directory to which only tomcat has access)
    and set the system property 
    <kbd>erddapContentDirectory=~tomcat/content/erddap</kbd>
    in ~tomcat/conf/tomcat8.conf <!-- tomcatVersion --> so ERDDAP can find the content directory.
    
  <p>[Some previous versions are also available:  
    <br><a rel="bookmark"
    href="https://coastwatch.pfeg.noaa.gov/erddap/download/erddapContent1.78.zip">1.78</a>
    (23,878 bytes, MD5=9AB513BE1DFB6C9EA8DAA24A8114E855, dated 2017-05-27)
    <br><a rel="bookmark"
    href="https://coastwatch.pfeg.noaa.gov/erddap/download/erddapContent1.80.zip">1.80</a>
    (23,878 bytes, MD5=7F85DEF1445B247010049C73984554EB, dated 2017-08-04)
    <br><a rel="bookmark"
    href="https://coastwatch.pfeg.noaa.gov/erddap/download/erddapContent1.82.zip">1.82</a>
    (21,414 bytes, MD5=85AAD46840A7E4A7691C6433B59A2458, dated 2018-01-26)
    ]

  <p>Then,
  <ul>
  <li><a class="selfLink" id="setup.xml" href="#setup.xml" rel="bookmark"
    >Read the comments in <i>tomcat</i>/content/erddap/<strong>setup.xml</strong></a>
      and make the requested changes.
    setup.xml is the file with all of the settings which specify how your ERDDAP behaves.
    <br>For the initial setup, you MUST at least change these settings:
      <kbd>&lt;bigParentDirectory&gt;, &lt;emailEverythingTo&gt;, &lt;baseUrl&gt;,
      &lt;baseHttpsUrl&gt;, &lt;email.*&gt;, &lt;admin.*&gt;</kbd> 
      (and <kbd>&lt;fontFamily&gt;</kbd> if you are using Bitstream Vera Sans fonts).

    <p>When you create the bigParentDirectory, from the parent directory of
      bigParentDirectory:
      <ul>
      <li>Make user=tomcat the owner of the bigParentDirectory, e.g.,
        <br><kbd>chown -R tomcat <i>bigParentDirectory</i></kbd>
      <li>Change the "group" to be tomcat, your username, 
        or the name of a small group that includes tomcat and 
        all the administrators of Tomcat/ERDDAP, e.g., 
        <br><kbd>chgrp -R <i>yourUserName</i> <i>bigParentDirectory</i></kbd>
      <li>Change permissions so that tomcat and the group have 
        read, write, execute privileges, e.g,. 
        <br><kbd>chmod -R ug+rwx <i>bigParentDirectory</i></kbd>
      <li>Remove "other" user's permissions to read, write, or execute:
        <br><kbd>chmod -R o-rwx <i>bigParentDirectory</i></kbd>
          reading possibly sensitive information in ERDDAP log files
          and files with information about private datasets.
      </ul>

  <li><a class="selfLink" id="datasets.xml" href="#datasets.xml" rel="bookmark">Read the comments in</a> 
      <a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html"><strong>Working with the datasets.xml File</strong></a>, then modify the XML in 
    <i>tomcat</i>/content/erddap/<strong>datasets.xml</strong> to specify all of the datasets 
      you want your ERDDAP to serve.
  <li>(Unlikely) Now or (slightly more likely) in the future, 
    if you want to modify erddap's CSS file,
    make a copy of <i>tomcat</i>/content/erddap/images/erddapStart2.css called erddap2.css 
    and then make changes to it.    
    Changes to erddap2.css only take effect when ERDDAP is restarted 
    and often also require the user to clear the browser's cached files.
  </ul>
  After you edit the .xml files, it is a good idea to verify that the result is well-formed XML
  by pasting the XML text into an XML checker like
    <a rel="help" href="https://www.xmlvalidation.com/">xmlvalidation<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>.

  <p>In the unusual situation where you aren't allowed to modify the Tomcat directory,
  you can put the ERDDAP content directory somewhere else (e.g., /usr/local/erddap). 
  To let ERDDAP know where it is,
  set the system property erddapContentDirectory=/usr/local/erddap/content/erddap/
  (or wherever it is).
  If you aren't allowed to set this property in startup.sh, 
  perhaps you can set it in Tomcat's context.xml.

<li><a class="selfLink" id="erddap.war" href="#erddap.war" rel="bookmark">Install the erddap.war file.</a>
  <br>On Linux, Mac, and Windows, download 
    <!-- use: c:\content\bat\md5.bat erddap1.80.war  
         ver, size, md5 duplicated below -->
    <a rel="bookmark"
    href="https://github.com/BobSimons/erddap/releases/download/v2.00b/erddap.war">erddap.war</a>
    into <i>tomcat</i>/webapps .  
    <br>(version 2.00, 512,875,729 bytes, MD5=B5FA224EDDB0BC8F2B257B0FF7F6936D, dated
    <span class="N">2019-06-26</span>)
    <br>The .war file is big because it contains high resolution coastline, boundary, 
    and elevation data needed to create maps.

  <p>[Some previous versions are also available.
    <br><a rel="bookmark"
    href="https://github.com/BobSimons/erddap/releases/download/v1.78/erddap.war">1.78</a>
    (534,713,263 bytes, MD5=E8407EDC977C073CB816D873EF85320F, dated 2017-05-27)
    <br><a rel="bookmark"
    href="https://github.com/BobSimons/erddap/releases/download/v1.80/erddap.war">1.80</a>
    (502,908,740 bytes, MD5=F09D55AAACF1221F13276541FEF61AE8, dated 2017-08-04)
    <br><a rel="bookmark"
    href="https://github.com/BobSimons/erddap/releases/download/v1.82/erddap.war">1.82</a>
    (504,431,073 bytes, MD5=2B342B3E6CD9CE562236753ED28ED5FB, dated 2018-01-26)
    ]

<li><a class="selfLink" id="ProxyPass" href="#ProxyPass" rel="bookmark">Use ProxyPass</a> 
  so users don't have to put the port number, e.g., :8080, in the URL.
  <br>On Linux computers, if Tomcat is running in Apache, please modify the
  Apache httpd.conf file
  (usually in /etc/httpd/conf/ )
  to allow HTTP traffic to/from ERDDAP without requiring the port number, e.g., :8080, in the URL.
  As the root user:
  <ol>
  <li>Modify the existing &lt;VirtualHost&gt; tag (if there is one),
    or add one at the end of the file:
<pre>
&lt;VirtualHost *:80&gt;
   ServerName <i>YourDomain.org</i>
   ProxyRequests Off
   ProxyPreserveHost On
   ProxyPass /erddap http://localhost:8080/erddap
   ProxyPassReverse /erddap http://localhost:8080/erddap
&lt;/VirtualHost&gt;
</pre>
  <li>Then restart Apache: <kbd>/usr/sbin/apachectl -k graceful</kbd> 
  (but sometimes it is in a different directory).
    <br>&nbsp;
  </ol>

<li><a class="selfLink" id="startTomcat" href="#startTomcat" rel="bookmark">Start Tomcat.</a>
  <ul>
  <li>(I don't recommend using the Tomcat Web Application Manager. If you don't 
   fully shutdown and startup Tomcat, sooner or later you will have PermGen 
   memory issues.)
    <br>&nbsp;

  <li>(In Linux or Mac OS, if you have created a special user to run Tomcat, 
    e.g., tomcat, remember to do the following steps as that user.)
    <br>&nbsp;

  <li>If Tomcat is already running, shut down Tomcat 
    with (in Linux or Mac OS) <kbd><i>tomcat</i>/bin/shutdown.sh</kbd>
    <br>or (in Windows)  <kbd><i>tomcat</i>\bin\shutdown.bat</kbd>

    <p>On Linux, use <kbd>ps -ef | grep tomcat</kbd> before and after shutdown.sh 
    to make sure the tomcat process has stopped.  
    The process should be listed before the shutdown and eventually not listed
    after the shutdown. It may take a minute or two for ERDDAP to fully shut down. 
    Be patient.
    Or if it looks like it won't stop on its own, use: 
    <br><kbd>kill -9 <i>processID</i></kbd>

  <li>Start Tomcat with (in Linux or Mac OS) <kbd><i>tomcat</i>/bin/startup.sh</kbd> 
    <br>or (in Windows) <kbd><i>tomcat</i>\bin\startup.bat</kbd>
    <br>&nbsp;
  </ul>

<li><a class="selfLink" id="isErddapRunning" href="#isErddapRunning" rel="bookmark">Is ERDDAP running?</a>
  <br>Use a browser to try to view http://<i>www.YourServer.org</i>/erddap/ 
  <br>ERDDAP starts up without any datasets loaded. 
  Datasets are loaded in a background thread and so become available one-by-one.

  <p><a class="selfLink" id="LookInLogFiles" href="#LookInLogFiles" rel="bookmark">Trouble? Look in the log files.</a>
  <br>If ERDDAP won't run or some datasets won't load, look for error messages in 
  <br><a rel="help" href="#tomcatLogs">Tomcat's log file</a> (<i>tomcat</i>/logs/catalina.out) and
  <br><a rel="help" href="#log">ERDDAP's log file</a> (<i>bigParentDirectory</i>/logs/log.txt).

  <p><a class="selfLink" id="OldVersionOfJava" href="#OldVersionOfJava" rel="bookmark">Trouble: Old Version of Java</a>
  <br>If you are using a version of Java that is too old for ERDDAP,
  ERDDAP won't run and you will see an error message in Tomcat's log file like
  <br><kbd>Exception in thread "main" java.lang.UnsupportedClassVersionError: 
  <br><i>some/class/name</i>: Unsupported major.minor version <i>someNumber</i></kbd>
  <br>The solution is to update to the most recent version of Java
  and make sure that Tomcat is using it.

  <p><a class="selfLink" id="SlowStartup" href="#SlowStartup" rel="bookmark">Trouble: Slow Startup First Time</a>
  <br>Tomcat has to do a lot of work the first time an application like 
  ERDDAP is started.
  On some servers, the first attempt to view ERDDAP stalls (30 seconds?) until 
  this work is finished.
  On other servers, the first attempt will fail immediately. But if you wait 
  30 seconds and try again,
  it will succeed if ERDDAP was installed correctly.
  <br>There is no fix for this, but it usually only occurs the first time after 
  you install a new version of ERDDAP.

<li>In the future, to shut down (and restart) ERDDAP, see 
  <br><a rel="help" href="#shutdown">How to Shut Down and Restart Tomcat and ERDDAP</a>.
  <br>&nbsp;

<li>Troubles installing Tomcat or ERDDAP?
  <br>Email me at <kbd>bob dot simons at noaa dot gov</kbd> .  I will help you.
    <br>Or, you can join the <a rel="help"
        href="#ERDDAPMailingList">ERDDAP Google Group / Mailing List</a> 
        and post your question there.
  <br>&nbsp;

<li>Email <a class="selfLink" id="updateNotification" href="#updateNotification" rel="bookmark">Notification of New Versions of ERDDAP</a>
  <br>If you want to receive an email whenever a new version of ERDDAP 
  is available, send an email to <kbd>bob dot simons at noaa dot gov</kbd> 
  requesting to be added to the ERDDAP Announcements mailing list.
  This list averages roughly one email every three months.
  <br>&nbsp;

<li><a class="selfLink" id="customize" href="#customize" rel="bookmark">Customize your ERDDAP to highlight your organization (not NOAA ERD).</a>
  <ul>
  <li>To change the banner that appears at the top of all ERDDAP .html pages,
    copy the default &lt;startBodyHtml5&gt; tag from 
    <br>[tomcat]/webapps/erddap/WEB-INF/classes/gov/noaa/pfel/erddap/util/messages.xml
    into your setup.xml file. Then, edit it. For example, you could:
    <ul>
    <li>Use a different image (i.e., your organization's logo).
    <li>Change the background color.
    <li>Change "ERDDAP" to "<i>YourOrganization</i>'s ERDDAP" 
    <li>Change "Easier access to scientific data" to "Easier access to <i>YourOrganization</i>'s data".
    <li>Change the "Brought to you by" links to be links to your organization and funding sources.
    </ul>
  <li>To change the information on the left side of the home page, e.g., to 
    information about your project, change the HTML content specified in the setup.xml 
    file in the &lt;theShortDescriptionHtml&gt; tag.
  <li>To change the icon that appears on browser tabs, put your organization's favicon.ico in 
    <i>tomcat</i>/content/erddap/images/ .
    See <a rel="help"
    href="https://en.wikipedia.org/wiki/Favicon">https://en.wikipedia.org/wiki/Favicon<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>.
  </ul>

</ol>

<!-- ******* -->
<h2><a class="selfLink" id="update" href="#update" rel="bookmark">How To Do an Update of an Existing ERDDAP on Your Server</a></h2>
<ol>
<li>Make the changes listed in 
  <a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/changes.html">Changes</a> 
  in the section entitled "Things ERDDAP Administrators Need to Know and Do"
  for all of the ERDDAP versions since the version you were using.
  <br>&nbsp;

<li>Download 
    <a rel="bookmark"
    href="https://github.com/BobSimons/erddap/releases/download/v2.00b/erddap.war">erddap.war</a>
    into <i>tomcat</i>/webapps .  
    <br>(version 2.00, 512,875,729 bytes, MD5=B5FA224EDDB0BC8F2B257B0FF7F6936D, dated
    <span class="N">2019-06-26</span>)

  <br>&nbsp;

<li><a class="selfLink" id="messages.xml" href="#messages.xml" rel="bookmark">messages.xml</a>
  <ul>
  <li>Common: If you are upgrading from ERDDAP version 1.46 (or above)
    and you just use the standard messages, 
    the new standard messages.xml will be installed automatically 
    (amongst the .class files via erddap.war).
    <br>&nbsp;
  <li>Rare: If you are upgrading from ERDDAP version 1.44 (or below), 
    <br>you MUST delete the old messages.xml file:
    <br><i>tomcat</i>/content/erddap/messages.xml .
    <br>The new standard messages.xml will be installed automatically 
    (amongst the .class files via erddap.war).
    <br>&nbsp;
  <li>Rare: If you always make changes to the standard messages.xml file (in place), 
    <br>you need to make those changes to the new messages.xml file (which is
    <br>WEB-INF/classes/gov/noaa/pfel/erddap/util/messages.xml after erddap.war 
    is decompressed by Tomcat).
    <br>&nbsp;
  <li>Rare: If you maintain a custom messages.xml file in <i>tomcat</i>/content/erddap/,
    <br>you need to figure out (via diff) what changes have been made to the default messages.xml 
    (which are in the new erddap.war as
    <br>WEB-INF/classes/gov/noaa/pfel/erddap/util/messages.xml)
    and modify your custom messages.xml file accordingly.
    <br>&nbsp;
  </ul>

<li>Install the new ERDDAP in Tomcat:
  <br>* Don't use Tomcat Manager. Sooner or later there will be PermGen memory issues. 
    It is better to actually shutdown and startup Tomcat.
  <br>* Replace references to <kbd><i>tomcat</i></kbd> below with the actual 
    Tomcat directory on your computer.
  <br>&nbsp;

  <ul>
  <li>For Linux and Macs:
    <ol>
    <li>Shutdown Tomcat: 
      From a command line, use: <kbd><i>tomcat</i>/bin/shutdown.sh</kbd>
      <br>And use <kbd>ps -ef | grep tomcat</kbd> to see if/when 
        the process has been stopped.  (It may take a minute or two.)
    <li>Remove the decompressed ERDDAP installation:
      In <kbd><i>tomcat</i>/webapps</kbd>, use
      <br><kbd>rm -rf erddap</kbd>
    <li>Delete the old erddap.war file:
      In <kbd><i>tomcat</i>/webapps</kbd>, use <kbd>rm erddap.war</kbd>
    <li>Copy the new erddap.war file from the temporary directory to 
      <kbd><i>tomcat</i>/webapps</kbd> 
    <li>Restart Tomcat and ERDDAP: 
      use <kbd><i>tomcat</i>/bin/startup.sh</kbd>
    <li>View ERDDAP in your browser to check that the restart succeeded.
     <br>(Often, you have to try a few times and wait a minute before you see ERDDAP.)
     <br>&nbsp;
    </ol>

  <li>For Windows:
    <ol>
    <li>Shutdown Tomcat: 
      From a command line, use: <kbd><i>tomcat</i>\bin\shutdown.bat</kbd>
    <li>Remove the decompressed ERDDAP installation:
      In <kbd><i>tomcat</i>/webapps</kbd>, use 
      <br><kbd>del /S/Q erddap</kbd>
    <li>Delete the old erddap.war file:
      In <kbd><i>tomcat</i>\webapps</kbd>, use <kbd>del erddap.war</kbd>
    <li>Copy the new erddap.war file from the temporary directory to
      <kbd><i>tomcat</i>\webapps</kbd> 
    <li>Restart Tomcat and ERDDAP: use <kbd><i>tomcat</i>\bin\startup.bat</kbd>
    <li>View ERDDAP in your browser to check that the restart succeeded.
     <br>(Often, you have to try a few times and wait a minute before you see ERDDAP.)
    </ol>
  </ul>

</ol>

Troubles updating ERDDAP?
<br>Email me at <kbd>bob dot simons at noaa dot gov</kbd> .  I will help you.
  <br>Or, you can join the <a rel="help"
      href="#ERDDAPMailingList">ERDDAP Google Group / Mailing List</a> 
      and post your question there.


<!-- ******* -->
<h2><a class="selfLink" id="needToKnow" href="#needToKnow" rel="bookmark">Things You Need To Know</a></h2>
<ul>

<li><strong><a class="selfLink" id="useCtrlF" href="#useCtrlF" rel="bookmark">Use Ctrl-F To Find Things On This Web Page</a></strong> 
<br>All of the information about administering ERDDAP 
(other than 
<a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html"
>working with datasets.xml</a>)
is on this one, very long, .html web page,
not several .html pages as some people prefer.
The advantage of one .html web page is that you can use Ctrl-F (Command-F on a Mac) 
in your web browser to search for text (for example, <kbd>flag</kbd>) within this web page.
<p>Alternatively, at the top of this document, there is a 
<a rel="help" href="#">list of main topics</a> (a Table of Contents).

<li><strong><a class="selfLink" id="InternalLinks" href="#InternalLinks"
rel="bookmark">Internal Links</a></strong> 
<br>ERDDAP's web pages 
have a large number of almost invisible, internal links 
(the text is black and not underlined). 
If you hover over one of these links (usually the first few words of headings 
and paragraphs), the cursor becomes a hand.
If you click on the link, the URL is the internal link to that section of the 
document. This makes it easy to refer to specific sections of ERDDAP web pages.
As an example, hover over, and click on, the bold "Internal Links" at the start 
of this paragraph.
<br>&nbsp;

<li><strong><a class="selfLink" id="proxyErrors" href="#proxyErrors" rel="bookmark">Proxy Errors</a></strong>
  <br>Sometimes, a request to ERDDAP will return a Proxy Error, 
  an HTTP 502 Bad Gateway Error, or some similar error.
  These errors are being thrown by Apache or Tomcat, not ERDDAP itself.
  <ul>
  <li>If every request generates these errors, especially when you are first
    setting up your ERDDAP, then it probably is a proxy or bad gateway error,
    and the solution is probably to fix  
    <a rel="help" href="#ProxyPass">ERDDAP's proxy settings</a>.
    This may also be the problem when an established ERDDAP suddenly starts
    throwing these errors for every request.
  <li>Otherwise, "proxy" errors are usually actually time out errors thrown by Apache or Tomcat. 
    Even when they happen relatively quickly, it is some sort of response from 
    Apache or Tomcat that occurs when ERDDAP is very busy, memory-limited,
    or limited by some other resource.
    In these cases, see the advice below to deal with 
    <a rel="help" href="#respondingSlowly">ERDDAP responding slowly</a>.

    <p>Requests for a long time range (&gt;30 time points) 
      from a gridded dataset are prone to time out failures, 
      which often appear as Proxy Errors, 
      because it takes significant time for ERDDAP to open all of the data files one-by-one.
      If ERDDAP is otherwise busy during the request, the problem is more likely to occur.
      If the dataset's files are compressed, the problem is more likely to occur,
      although it's hard for a user to determine if a dataset's files are compressed.
      <br>The solution is to make several requests, each with a smaller time range. 
      How small of a time range? 
      I suggest starting really small (~30 time points?), 
      then (approximately) double the time range until the request fails, 
      then go back one doubling. 
      Then make all the requests (each for a different chunk of time) 
      needed to get all of the data.
      <br>An ERDDAP administrator can lessen this problem by increasing the 
      <a rel="help" href="#ApacheTimeout">Apache timeout settings</a>.
  </ul>


<li><strong><a class="selfLink" id="respondingSlowly" href="#respondingSlowly" rel="bookmark">If ERDDAP Is Responding Slowly</a></strong> 
  or if just certain requests are responding slowly,
  <br>you may be able to figure out if the slowness is reasonable 
    and temporary (e.g., because of lots of requests from scripts or WMS users),
    or if something is inexplicably wrong and you need to 
    <a rel="help" href="#restart">shut down and restart Tomcat and ERDDAP</a>.

  <p>If ERDDAP is responding slowly, see the advice below to determine the 
    cause, which hopefully will enable you to fix the problem. 
    <br>You may have a specific starting point (e.g., a specific request URL)
      or a vague starting point (e.g., ERDDAP is slow).
    <br>You may know the user involved (e.g., because they emailed you), or not.
    <br>You may have other clues, or not.
    <br>Since all of these situations and all of the possible causes of the problems
      blur together, the advice below tries to deal will all possible 
      starting points and all possible problems related to slow responses.


  <ul>
  <li><strong>Look for clues in 
    <a rel="help" href="#log">ERDDAP's log file</a></strong> (<i>bigParentDirectory</i>/logs/log.txt).
    <br>[On rare occasions, there are clues in 
      <a rel="help" href="#tomcatLogs">Tomcat's log file</a> (<i>tomcat</i>/logs/catalina.out).]     
    <br>Look for error messages.
    <br>Look for a large number of requests coming from one (or a few) users and perhaps
      hogging a lot of your server's resources (memory, CPU time, disk access, 
      internet bandwidth).
    
    <p>If the trouble is tied to <strong>one user</strong>, 
      you can often get a clue about who the user is via web services like
        <a rel="help"  href="https://whatismyipaddress.com/ip-lookup"
                            >https://whatismyipaddress.com/ip-lookup<img 
          src="../images/external.png" alt=" (external link)" 
          title="This is a link to an external website."/></a>
        that can give you information related to the user's IP address 
        (which you can find in ERDDAP's <a rel="help" href="#log">log.txt</a> file).
      <ul>
      <li>If the user seems to be a <strong>bot</strong> behaving badly
        (notably, a search engine trying to fill out the ERDDAP forms
        with every possible permutation of entry values), make sure you have 
        properly set up your server's 
        <a rel="help" href="#robots">robots.txt</a> file.
      <li>If the user seems to be a <strong>script(s)</strong> that is making multiple simultaneous
        requests,
        contact the user, explain that your ERDDAP has limited resources 
        (e.g., memory, CPU time, disk access, internet bandwidth), 
        and ask them to be considerate of other users
        and just make one request at a time.
        You might also mention that you will blacklist them if they don't back off.
      <li>If the user seems to be a <strong>script</strong> 
        making a large number of time-consuming requests, 
        ask the user to be considerate of other users by putting
        a small pause (2 seconds?) in the script between requests.        
      <li><strong>WMS client software</strong> can be very demanding. One client will often 
        ask for 6 custom images at a time. 
        If the user seems to be a WMS client that is making legitimate requests, 
        you can:
        <ul>
        <li>Ignore it. (recommended, because they'll move on pretty soon)
        <li>Turn off your server's WMS service via ERDDAP's setup.html file. (not recommended)
        </ul>
      <li>If the requests seem <strong>stupid, insane, excessive, or malicious,</strong>
        or if you can't resolve the problem any other way, 
        consider temporarily or permanently adding the user's IP address to the 
        <a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#requestBlacklist"
      >&lt;requestBlacklist&gt; in your datasets.xml file</a>.      

        <br>&nbsp;
      </ul>

  <li><strong>Try to duplicate the problem yourself, from your computer.</strong>
    <br>Figure out if the problem is with one dataset or all datasets,
      for one user or all users, for just certain types of requests, etc..
    <br>If you can duplicate the problem, try to narrow down the problem.
    <br>If you can't duplicate the problem, then the problem may be tied to the
      user's computer, the user's internet connection, or your institution's
      internet connection.
    <br>&nbsp;

  <li>If just <strong>one dataset</strong> is responding slowly 
    (perhaps only for <strong>one type of request</strong> from one user),
    the problem may be:
    <ul>
    <li>ERDDAP's access to the dataset's source data 
      (notably from relational databases, Cassandra, and remote datasets) 
      may be temporarily or permanently slow.
      Try to check the source's speed independent of ERDDAP. 
      If it is slow, perhaps you can improve it.
    <li>Is the problem related to the specific request or general type of request?
      <br>The larger the requested subset of a dataset, the more likely the
        request will fail. If the user is making huge requests, 
        ask the user to make smaller requests
        that are more likely to get a fast and successful response.
      <p>Almost all data sets are better at handling some types of requests 
        than others types of requests.
      For example, when a dataset stores different time chunks in different files,
      requests for data from a huge number of time points may be very slow.
      If the current requests are of a difficult type,
      consider offering a variant of the dataset that is optimized for these requests.
      Or just explain to the user that that type of request is difficult and
      time consuming, and ask for their patience.
    <li>The dataset may be not optimally configured. You may be able to make changes to the dataset's
      datasets.xml chunk to help ERDDAP handle the dataset better. For example,
      <ul>
      <li>EDDGridFromNcFiles datasets that access data from compressed nc4/hdf5 files are
        slow when getting data for the entire geographic range (e.g., for a world map)
        because the entire file must be decompressed. 
        You could convert the files to uncompressed files, but then the disk space
        requirement will be much, much larger. It is probably better to just
        accept that such datasets will be slow in certain circumstances.
      <li>The configuration of the 
<a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#subsetVariables"><kbd>&lt;subsetVariables&gt;</kbd></a> tag has a huge influence on how ERDDAP handles EDDTable datasets.
      <li>You may be able to increase the 
<a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#databaseSpeed"
        >speed of an EDDTableFromDatabase</a> dataset.
      <li>Many EDDTable datasets can be sped up by 
        <a rel="help" 
href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#EDDTableFromFiles"
        >storing a copy of the data in NetCDF Contiguous Ragged Array files</a>,
        which ERDDAP can read very quickly.        
      </ul>
      If you want help speeding up a specific dataset, 
      email a description of the problem and the dataset's chunk of datasets.xml to
      <kbd>bob dot simons at noaa dot gov</kbd>.  
      <br>Or, you can join the <a rel="help"
        href="#ERDDAPMailingList">ERDDAP Google Group / Mailing List</a> 
        and post your question there.
      <br>&nbsp;
    </ul>

  <li>If <strong>everything</strong> in ERDDAP is <strong>always</strong> slow,
    the problem may be:
    <ul>
    <li>The computer that is running ERDDAP may not have enough memory or processing power.
        It is good to run ERDDAP on a modern, multi-core server.
        For heavy use, the server should have a 64-bit operating system and 8 GB or more of memory.
    <li>The computer that is running ERDDAP may be also running other applications that
        are consuming lots of system resources. If so, can you get a dedicated server
        for ERDDAP? For example (this is not an endorsement), you can get 
        a quad-core Mac Mini Server with 8 GB of memory for ~$1100.
      <br>&nbsp;
    </ul>

  <li>If <strong>everything</strong> in ERDDAP is <strong>temporarily</strong> slow, view your ERDDAP's 
    <a rel="help" href="#statusPage"><strong>/erddap/status.html page</strong></a> in your browser.
    <ul>
    <li>Does the ERDDAP status page fail to load?
        <br>If so, <a rel="help" href="#restart">restart ERDDAP</a>.
    <li>Did the ERDDAP status page load slowly (e.g., &gt;5 seconds)?
        <br>That is a sign that everything in ERDDAP is running slowly, 
        but it isn't necessarily trouble. ERDDAP may just be really busy.
    <li>For "Response Failed Time (since last major LoadDatasets)", is n= a large number?
        <br>That indicates there have been lots of failed requests recently.
        That may be trouble or the start of trouble.
        The <kbd>median</kbd> time for the failures is often large (e.g., 210000 ms), 
        <br>which means that there were (are?) lots of active threads. 
        <br>which were tying up lots of resources (like memory, open files, open sockets, ...),
        <br>which is not good.
    <li>For "Response Succeeded Time (since last major LoadDatasets)", is n= a large number?
        <br>That indicates there have been lots of successful requests recently.
        This isn't trouble. It just means your ERDDAP is getting heavy use.
    <li>Is the "Number of non-Tomcat-waiting threads" double a typical value?
        <br>This is often serious trouble that will cause ERDDAP to slow down and eventually 
        freeze. 
        If this persists for hours, you may want to proactively
        <a rel="help" href="#restart">restart ERDDAP</a>.
    <li>At the bottom of the "Memory Use Summary" list, is the last 
      "Memory: currently using" value very high?
        <br>That may just indicate high usage, or it may be a sign of trouble.
    <li>Look at the list of threads and their status. 
      Are an unusual number of them doing something unusual?     
      <br>&nbsp;
    </ul>

  <li>Is <strong>your institution's internet connection</strong> currently slow?
      <br>Search the internet for "internet speed test" 
      and use one of the free online tests, such as 
      <a rel="help"   href="https://www.speakeasy.net/speedtest/">https://www.speakeasy.net/speedtest/<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>.
      If your institution's internet connection is slow, 
      then connections between ERDDAP and remote data sources will be slow, 
      and connections between ERDDAP and the user will be slow.
      Sometimes, you can solve this by stopping unnecessary internet use 
      (e.g., people watching streaming videos or on video conference calls).
      <br>&nbsp;

  <li>Is <strong>the user's internet connection</strong> currently slow?
      <br>Have the user search the internet for "internet speed test" 
      and use one of the free online tests, such as 
      <a rel="help"   href="https://www.speakeasy.net/speedtest/">https://www.speakeasy.net/speedtest/<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>.
      If the user's internet connection is slow, it slows down their access to ERDDAP.
      Sometimes, they can solve this by stopping unnecessary internet use at 
      their institution
      (e.g., people watching streaming videos or on video conference calls).
      <br>&nbsp;

  <li><strong>Stuck?</strong>
      <br>Email all the details to bob.simons at noaa.gov .
      <br>&nbsp;
  </ul>

<li><strong><a class="selfLink" id="frozen" href="#frozen" rel="bookmark">How to</a> 
       <a class="selfLink" id="shutdown" href="#shutdown" rel="bookmark">Shut Down</a>
       and 
       <a class="selfLink" id="restart" href="#restart" rel="bookmark">Restart Tomcat and ERDDAP</a></strong> 

  <br>You don't need to shut down and restart Tomcat and ERDDAP
  if ERDDAP is temporarily slow, slow for some known reason 
  (like lots of requests from scripts or WMS users),
  or to apply changes to datasets.xml file.

  <p>You do need to shut down and restart Tomcat and ERDDAP 
  if you need to apply changes to the setup.xml file,
  or if ERDDAP freezes, hangs, or locks up.
  In extreme circumstances, Java may freeze for a minute or two 
  while it does a full garbage collection, but then recover. So it is good to 
  wait a minute or two to see if Java/ERDDAP is really frozen or 
  if it is just doing a long garbage collection.
  (If garbage collection is a common problem, 
  <a rel="help" href="#LinuxMemory">allocate more memory to Tomcat</a>.)

  <p>I don't recommend using the Tomcat Web Application Manager to 
    start or shutdown Tomcat. 
    If you don't fully shutdown and startup Tomcat, sooner or later you will 
    have PermGen memory issues. 

  <p>To shutdown and restart Tomcat and ERDDAP:
  &nbsp;
  <ul> 
  <li>If you use Linux or a Mac:
    <br>(If you have created a special user to run Tomcat, e.g., tomcat, 
      remember to do the following steps as that user.)
      <br>&nbsp;
    <ol>
    <li>Use <kbd>cd <i>tomcat</i>/bin</kbd>
      <br>&nbsp;

    <li>Use <kbd>ps -ef | grep tomcat</kbd> to find the java/tomcat processID
      (hopefully, just one process will be listed),
      which we'll call <kbd><i>javaProcessID</i></kbd> below.
      <br>&nbsp;

    <li>If ERDDAP is frozen/hung/locked up, use <kbd>kill -3 <i>javaProcessID</i></kbd> 
      to tell Java (which is running Tomcat)
      to do a thread dump to the Tomcat log file: <i>tomcat</i>/logs/catalina.out .  
      After you reboot, you can diagnose the problem by finding the thread 
      dump information 
      (and any other useful information above it) in <i>tomcat</i>/logs/catalina.out 
      and also by reading relevant parts of the 
      <a rel="help" href="#log">ERDDAP log archive</a>.
      If you want, you can email that information to 
      <kbd>bob dot simons at noaa dot gov</kbd> 
      so I can see what went wrong.
      <br>Or, you can join the <a rel="help"
        href="#ERDDAPMailingList">ERDDAP Google Group / Mailing List</a> 
        and post your question there.
      <br>&nbsp;

    <li>Use <kbd>./shutdown.sh</kbd>
      <br>&nbsp;

    <li>Use <kbd>ps -ef | grep tomcat</kbd> repeatedly until the 
      java/tomcat process isn't listed.

      <p>Sometimes, the java/tomcat process will take up to two minutes to fully 
      shut down.  
      The reason is: ERDDAP sends a message to its background threads
      to tell them to stop, but sometimes it takes these threads a long time
      to get to a good stopping place.

    <li>If after a minute or so, java/tomcat isn't stopping by itself, 
      you can use 
      <br><kbd>kill -9 <i>javaProcessID</i></kbd> 
      <br>to force the java/tomcat process to stop immediately.
      If possible, use this only as a last resort.
      The -9 switch is powerful, but it may cause various problems.
      <br>&nbsp;

    <li>To restart ERDDAP, use <kbd>./startup.sh</kbd>
      <br>&nbsp;

    <li>View ERDDAP in your browser to check that the restart succeeded.
      (Sometimes, you need to wait 30 seconds and try to load ERDDAP again 
      in your browser for it to succeed.)
      <br>&nbsp;
    </ol>

  <li>If you use Windows:
      <br>&nbsp;
    <ol>
    <li>Use <kbd>cd <i>tomcat</i>/bin</kbd>
      <br>&nbsp;
    <li>Use <kbd>shutdown.bat</kbd>
      <br>&nbsp;
    <li>You may want/need to use the Windows Task Manager (accessible via Ctrl Alt Del) 
      to ensure that the Java/Tomcat/ERDDAP process/application has fully stopped.
      <br>Sometimes, the process/application will take up to two minutes to shut down.  
      The reason is: ERDDAP sends a message to its background threads
      to tell them to stop, but sometimes it takes these threads a long time
      to get to a good stopping place.
      <br>&nbsp;
    <li>To restart ERDDAP, use <kbd>startup.bat</kbd>
      <br>&nbsp;
    <li>View ERDDAP in your browser to check that the restart succeeded.
      (Sometimes, you need to wait 30 seconds and try to load ERDDAP again 
      in your browser for it to succeed.)
      <br>&nbsp;
    </ol>

  </ul>

<li><strong><a class="selfLink" id="frequentCrashes" href="#frequentCrashes" rel="bookmark">Frequent Crashes or Freezes</a></strong> -- 
  If ERDDAP becomes slow, crashes or freezes, something is wrong. 
  Look in <a rel="help" href="#log">ERDDAP's log file</a> 
  to try to figure out the cause. If you can't, 
  please email the details to <kbd>bob dot simons at noaa dot gov</kbd> .

  <p>The most common problem is a troublesome user who is 
  running several scripts at once and/or someone making a large number of invalid requests. 
  If this happens, you should probably blacklist that user. 
  When a blacklisted user makes a request, the error message in the response encourages 
  them to email you to work out the problems. Then, you can encourage them
  to run just one script at a time and to fix the problems in their script
  (e.g., requesting data from a remote dataset that can't respond before timing out).
  See <a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#requestBlacklist"
      >&lt;requestBlacklist&gt; in your datasets.xml file</a>.

  <p>In extreme circumstances, Java may freeze for a minute or two 
  while it does a full garbage collection, but then recover. So it is good to 
  wait a minute or two to see if Java/ERDDAP is really frozen or 
  if it is just doing a long garbage collection.
  (If garbage collection is a common problem, 
  <a rel="help" href="#LinuxMemory">allocate more memory to Tomcat</a>.)

  <p>If ERDDAP becomes slow or freezes and the problem isn't a troublesome user
  or a long garbage collection, 
  you can usually solve the problem by 
  <a rel="help" href="#restart">restarting ERDDAP</a>. 
  My experience is that ERDDAP can run for months without needing a restart.
  <br>&nbsp;


<li><strong><a class="selfLink" id="monitor" href="#monitor" rel="bookmark">Monitor ERDDAP</a></strong> -- 
  You can monitor your ERDDAP's status by looking at the <a rel="help" href="#statusPage">/erddap/status.html page</a>,
  notably the statistics in the top section.
  If ERDDAP becomes slow or freezes and the problem isn't just extremely heavy usage, 
  you can usually solve the problem by 
  <a rel="help" href="#restart">restarting ERDDAP</a>. 

  <p>My experience is that ERDDAP can run for months without needing a restart.
  You should only need to restart it if you want
  to apply some changes to you made to ERDDAP's setup.xml
  or when you need to install new versions 
  of ERDDAP, Java, Tomcat, or the operating system.
  If you need to restart ERDDAP frequently, something is wrong. 
  Look in <a rel="help" href="#log">ERDDAP's log file</a> 
  to try to figure out the cause. If you can't, 
  please email the details to <kbd>bob dot simons at noaa dot gov</kbd> .
  As a temporary solution, you might try using  
  <a rel="help" href="https://mmonit.com/monit/">Monit<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
  to monitor your ERDDAP and restart it if needed.
  Or, you could make a cron job to restart ERDDAP (proactively) periodically.
  It may be a little challenging to write a script to automate monitoring and restarting ERDDAP.
  Some tips that might help:
  <ul>
  <li>You can simplify testing if the Tomcat process is still running 
    by using the -c switch with grep:
    <br><kbd>ps -u <i>tomcatUser</i> | grep -c java</kbd>
    <br>That will reduce the output to "1" if the tomcat process is still alive,
    or "0" if the process has stopped.
    <br>&nbsp;
  <li>If you are good with gawk, you can extract the processID from the results of 
     <br><kbd>ps -u <i>tomcatUser</i> | grep java</kbd>, and use the 
     processID in other lines of the script.
    <br>&nbsp;
  </ul>
  If you do set up Monit or a cron job, please email the details to 
  <kbd>bob dot simons at noaa dot gov</kbd> .
    <br>Or, you can join the <a rel="help"
        href="#ERDDAPMailingList">ERDDAP Google Group / Mailing List</a> 
        and share the information there.
  <br>&nbsp;

<li><strong><a class="selfLink" id="permgen" href="#permgen" rel="bookmark">PermGen</a></strong> -- 
If you repeatedly use Tomcat Manager to <kbd>Reload</kbd> (or <kbd>Stop</kbd> and <kbd>Start</kbd>) ERDDAP, 
  ERDDAP may fail to start up and throw <kbd>java.lang.OutOfMemoryError: PermGen</kbd>.
  The solution is to periodically (or every time?) 
  <a rel="help" href="#restart">shut down and restart tomcat and ERDDAP</a>,
  instead of just reloading ERDDAP.
  <br>[Update: This problem should be greatly minimized or fixed in ERDDAP version 1.24.]
  <br>&nbsp;

<li><strong><a class="selfLink" id="log" href="#log" rel="bookmark">log.txt</a></strong> -
  If ERDDAP doesn't start up or if something isn't working as expected, 
  it is very useful to look at the error and diagnostic messages in the ERDDAP log file.  
  <ul>
  <li>The log file is <i>bigParentDirectory</i>/logs/log.txt 
    <br>(<i>bigParentDirectory</i> is specified in <a rel="help" href="#setup.xml">setup.xml</a>).
    If there is no log.txt file or if the log.txt file hasn't been updated since
    you restarted ERDDAP, look in the <a rel="help" href="#tomcatLogs">Tomcat Log Files</a> 
    to see if there is an error message there.
  <li>Types of diagnostic messages in the log file:
    <ul>
    <li>The word "error" is used when something went so wrong that the procedure failed to complete.
      Although it is annoying to get an error, the error forces you to deal with the problem.
      Our thinking is that it is better to throw an error, than to have ERDDAP hobble along, 
      working in a way you didn't expect.
    <li>The word "warning" is used when something went wrong, but the procedure was able to complete. 
      These are pretty rare.
    <li>Anything else is just an informative message. 
      You can control how much information is logged with 
      <a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#logLevel"><kbd>&lt;logLevel&gt;</kbd></a>
      datasets.xml.
    </ul>
  <li>Information is written to the log file on the disk drive in fairly big chunks. 
    The advantage is that this is very efficient -- ERDDAP will never block
    waiting for information to be written to the log file.
    The disadvantage is that the log will almost always end with a 
    partial message, which won't be completed until the next chunk is written.
    You can make it up-to-date (for an instant) by viewing your ERDDAP's 
    status web page at http://<i>your.domain.org</i>/erddap/status.html .
  <li>When the log.txt files gets to 20 MB, 
    <br>the file is renamed log.txt.previous and a new log.txt file is created.
    So log files don't accumulate.
    <p>In setup.xml, you can specify a different maximum size for the log file, in MegaBytes.
    The minimum allowed is 1 (MB). The maximum allowed is 2000 (MB). 
    The default is 20 (MB). For example:
    <br>&lt;logMaxSizeMB&gt;20&lt;/logMaxSizeMB&gt;

  <li>Whenever you restart ERDDAP, 
    <br>ERDDAP makes an archive copy of the 
    log.txt and log.txt.previous files with a time stamp in the file's name. 
    If there was trouble before the restart, 
    it may be useful to analyze these archived files for clues as to what the trouble was.
    You can delete the archive files if they are no longer needed.
    <br>&nbsp;
  </ul>

<li><strong><a class="selfLink" id="parsingLogTxt" href="#parsingLogTxt" rel="bookmark">Parsing log.txt</a></strong> -
  log.txt isn't designed for parsing (although you might be able to create
  regular expressions that extract desired information). 
  It is designed to help a human figure out what is going wrong 
  when something is going wrong.

  <p>For most of the things that people want to gather from a log file 
  (e.g., usage statistics), please use the Apache and/or Tomcat logs. 
  They are nicely formatted and have that type of information.

<li><strong><a class="selfLink" id="tomcatLogs" href="#tomcatLogs" rel="bookmark">Tomcat Log Files</a></strong> -- 
  If ERDDAP doesn't start up because an error occurred very early in ERDDAP's startup, 
  the error message will show up in Tomcat's log files
  (<i>tomcat</i>/logs/catalina.<i>today</i>.log or 
   <i>tomcat</i>/logs/catalina.out),
  not in <a rel="help" href="#log">ERDDAP's log.txt file</a>.
  <br>&nbsp;

<li><strong><a class="selfLink" id="emailLog" href="#emailLog" rel="bookmark">emailLogYEAR-MM-DD.txt</a></strong> -
  ERDDAP always writes the text of all out-going email messages 
  in the current day's emailLogYEAR-MM-DD.txt file in <i>bigParentDirectory</i>/logs 
  (<i>bigParentDirectory</i> is specified in <a rel="help" href="#setup.xml">setup.xml</a>).
  <ul>
  <li>If the server can't send out email messages, or if you have configured ERDDAP not to send 
    out email messages, or if you are just curious, this file is a convenient way to see 
    all of the email messages that have been sent out.
  <li>You can delete previous days' email log files if they are no longer needed.
    <br>&nbsp;
  </ul>

<li><strong><a class="selfLink" id="dailyReport" href="#dailyReport" rel="bookmark">Daily Report</a></strong> -- 
  The Daily Report has lots of useful information -- all of the information from 
  your ERDDAP's <a rel="help" href="#statusPage">/erddap/status.html page</a> and more.
  <ul>
  <li>It is the most complete summary of your ERDDAP's status.
  <li>Among other statistics, it includes a list of datasets that didn't load and the exceptions 
    they generated.
  <li>It is generated when you start up ERDDAP (just after ERDDAP finishes trying to load all of 
    the datasets) and generated soon after 7 am local time every morning.
  <li>Whenever it is generated, it is written to <a rel="help" href="#log">ERDDAP's log.txt file</a>.
  <li>Whenever it is generated, it is emailed to <kbd>&lt;emailDailyReportsTo&gt;</kbd> and 
    <kbd>&lt;emailEverythingTo&gt;</kbd> (which are specified in 
    <a rel="help" href="#setup.xml">setup.xml</a>) 
    provided you have set up the email system (in setup.xml).
    <br>&nbsp;
  </ul>

<li><strong><a class="selfLink" id="statusPage" href="#statusPage" rel="bookmark">Status Page</a></strong> -- 
  You can view the status of your ERDDAP from any browser by going to 
  &lt;baseUrl&gt;/erddap/status.html 
  <ul>
  <li>This page is generated dynamically, so it always has up-to-the-moment statistics for your ERDDAP. 
  <li>It includes statistics regarding the number of requests, memory usage, thread stack traces, 
    the taskThread, etc.
  <li>Because the Status Page can be viewed by anyone, it doesn't include quite as much information
    as the <a rel="help" href="#dailyReport">Daily Report</a>.
    <br>&nbsp;
  </ul>

<li><strong><a class="selfLink" id="addingDatasets" href="#addingDatasets" rel="bookmark">Adding/Changing Datasets</a></strong> -- 
  ERDDAP usually rereads datasets.xml every <kbd><i>loadDatasetsMinMinutes</i></kbd> 
  (specified in <a rel="help" href="#setup.xml">setup.xml</a>). 
    So you can make changes to datasets.xml any time, even while ERDDAP is running.
  <br>A new dataset will be detected soon, usually within 
    <kbd><i>loadDatasetsMinMinutes</i></kbd>.
  <br>A changed dataset will be reloaded when it is <kbd><i>reloadEveryNMinutes</i></kbd>
    old (as specified in datasets.xml).
<br>&nbsp;

<li><strong><a class="selfLink" id="flag" href="#flag" rel="bookmark">A Flag File</a> 
  <a class="selfLink" id="hardFlag" href="#hardFlag" rel="bookmark">Tells ERDDAP to Try to</a> 
  <a class="selfLink" id="reloadingDatasets" href="#reloadingDatasets" rel="bookmark">Reload a Dataset As Soon As Possible</a></strong> 
  <ul>
  <li>ERDDAP won't notice any changes to a dataset's setup in datasets.xml until ERDDAP reloads the dataset.
  <li>To tell ERDDAP to reload a dataset as soon as possible
    (before the dataset's <kbd>&lt;reloadEveryNMinutes&gt;</kbd> would cause it to be reloaded),
    put a file in <i>bigParentDirectory</i>/flag 
      (<i>bigParentDirectory</i> is specified in <a rel="help" href="#setup.xml">setup.xml</a>) that has the
    same name as the dataset's datasetID. 
    <br>This tells ERDDAP to try to load new and changed datasets.
    <br>The old version of the dataset will remain available to users until 
      the new version is available and swapped atomically into place.
    <br>For EDDGridFromFiles and EDDTableFromFiles, the reload is a will look for 
      new or changed files, read those, and incorporate them into the dataset.
      So the time to reload is dependent on the number of new or changed files.
    <br>If the dataset has <kbd>active="false"</kbd>, ERDDAP will remove the dataset.
    
  <li>There is a variant of the /flag directory: the /hardFlag directory. (Added in ERDDAP v1.74.)
    If you put a file in <i>bigParentDirectory</i>/hardFlag /a>) that has the
    same name as the dataset's datasetID,
    as soon as ERDDAP sees the hardFlag file,
    ERDDAP will:
    <ol>
    <li>Delete the hardFlagFile.
    <li>Remove the dataset from ERDDAP.
    <li>Delete all of the information that ERDDAP has stored 
      about this dataset.
      <br>For EDDGridFromFiles and EDDTableFromFiles subclasses, 
      this deletes the internal database of data files and their contents. 
      <br>For datasets like EDDGridSideBySide that have childDatasets,
      this also deletes the internal database of data files and their contents
      for all child datasets.  
    <li>Reload the dataset.
      <br>For EDDGridFromFiles and EDDTableFromFiles subclasses, 
      this causes ERDDAP to reread <strong>all</strong> of the data files. 
      Thus, the reload time is dependent on the total number of data files in the dataset.
      Because the dataset was removed from ERDDAP when the hardFlag was noticed,
      the dataset will be unavailable until the dataset finishes reloading.
      Be patient. Look in the <a rel="help" href="#log">log.txt</a> file if you want to see what's going on.
    </ol>
    The hardFlag variant deletes the dataset's stored information 
    even if the dataset isn't currently loaded in ERDDAP.

    <p>HardFlags are very useful when you do something that causes a 
    change in how ERDDAP reads and interprets the source data, for example,
    when you install a new version of ERDDAP or when you have made a change to a 
    dataset's definition in datasets.xml

  <li>The contents of the flag and hardFlag file are irrelevant.
  <li>In between major dataset reloads, ERDDAP looks continuously for flag and hardFlag files. 
  <li>Note that when a dataset is reloaded, all files in the 
    <i>bigParentDirectory</i>/<a rel="help" href="#cachedResponses">cache</a>/<i>datasetID</i> 
    directory are deleted. This includes .nc and image files that are normally cached 
    for ~15 minutes.
  <li>Note that if the dataset's xml includes     
<a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#active"><kbd>active="false"</kbd></a>,
    a flag will cause the dataset to be made inactive 
    (if it is active), and in any case, not reloaded.
  <li>Any time ERDDAP runs LoadDatasets to do a major reload (the timed reload
    controlled by &lt;loadDatasetsMinMinutes&gt;) or a minor reload
    (as a result of an external or internal flag), 
    ERDDAP reads all &lt;decompressedCacheMaxGB&gt;, &lt;decompressedCacheMaxMinutesOld&gt;, 
    &lt;user&gt;, &lt;requestBlacklist&gt;, &lt;slowDownTroubleMillis&gt;,
    and &lt;subscriptionEmailBlacklist&gt; tags and switches to the new settings.
    So you can use a flag as a way to get ERDDAP to notice changes
    to those tags ASAP.
  </ul>

<p><a class="selfLink" id="setDatasetFlag" href="#setDatasetFlag" rel="bookmark">ERDDAP has a web service so that flags can be set via URLs.</a> 
  <ul>
  <li>For example,
    <br><kbd>https://coastwatch.pfeg.noaa.gov/erddap/setDatasetFlag.txt?datasetID=rPmelTao&amp;flagKey=123456789</kbd>
    <br>(that's a fake flagKey) will set a flag for the rPmelTao dataset.  
  <li>There is a different flagKey for each datasetID. 
  <li>Administrators can see a list of flag URLs for all datasets by looking at the bottom of 
    their <a rel="help" href="#dailyReport">Daily Report</a> email.
  <li>Administrators should treat these URLs as confidential, since they give someone the right to
    reset a dataset at will.
  <li>If you think the flagKeys have fallen into the hands of someone who is abusing them,
    you can change <kbd>&lt;flagKeyKey&gt;</kbd> in <a rel="help" href="#setup.xml">setup.xml</a> and 
    restart ERDDAP
    to force ERDDAP to generate and use a different set of flagKeys.
  <li>If you change <kbd>&lt;flagKeyKey&gt;</kbd>, delete all of the old subscriptions (see
    the list in your Daily Report) and remember to send the new URLs to the 
    people who you do want to have them.
  </ul>

<p>The flag system can serve as the basis for a more efficient mechanism for telling ERDDAP when to 
  reload a dataset. For example, you could set a dataset's <kbd>&lt;reloadEveryNMinutes&gt;</kbd> 
  to a large number (e.g., 10080 = 1 week).
  Then, when you know the dataset has changed (perhaps because you added a file to the dataset's data 
  directory), set a flag so that the dataset is reloaded as soon as possible.
  Flags are usually seen quickly.  But if the LoadDatasets thread is already
  busy, it may be a while before it is available to act on the flag.
  But the flag system is much more responsive and much more efficient than setting 
  <kbd>&lt;reloadEveryNMinutes&gt;</kbd> to a small number.

<li><strong>Force Dataset <a class="selfLink" id="removingDatasets" href="#removingDatasets" rel="bookmark">Removal</a></strong> -- 
  If a dataset is active in ERDDAP and you want to deactivate it temporarily or permanently:
    <ol>
    <li>In datasets.xml for the dataset, set <a rel="help"
      href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#active"
      ><kbd>active="false"</kbd></a> in the dataset tag.
    <li>Wait for ERDDAP to remove the dataset during the next major reload 
      or <a rel="help" href="#flag">set a flag</a>
      for the dataset to tell ERDDAP to notice this change as soon as possible.
      When you do this, ERDDAP doesn't throw out any information it may have
      stored about the dataset and certainly doesn't do anything to the actual data.
    <li>Then you can leave the <kbd>active="false"</kbd> dataset in datasets.xml
      or remove it.       
      <br>&nbsp;
    </ol>

<li><strong><a class="selfLink" id="DatasetsReloaded" href="#DatasetsReloaded" rel="bookmark">When Are Datasets Reloaded?</a></strong> 
  A thread called RunLoadDatasets is the master thread that controls 
  when datasets are reloaded. RunLoadDatasets loops forever:
  <ol>
  <li>RunLoadDatasets notes the current time.
  <li>RunLoadDatasets starts a LoadDatasets thread to do a "majorLoad".  
    You can see information about the current/previous majorLoad at the top of 
    your ERDDAP's 
    <br><a rel="help" href="#statusPage">/erddap/status.html page</a>
    (<a href="https://coastwatch.pfeg.noaa.gov/erddap/status.html">status&nbsp;page&nbsp;example</a>).
    <ol>
    <li>LoadDatasets makes a copy of datasets.xml.
    <li>LoadDatasets reads through the copy of datasets.xml and, for each dataset,
       sees if the dataset needs to be (re)loaded or removed.
       <ul>
       <li>If a <a rel="help" href="#flag">flag</a> file exists for this dataset, 
         the file is deleted and 
         the dataset is removed if <kbd>active="false"</kbd> 
         or (re)loaded if <kbd>active="true"</kbd> (regardless of the dataset's age).
       <li>If the dataset's dataset.xml chunk has <kbd>active="false"</kbd>
         and the dataset is currently loaded (active), is is unloaded (removed).       
       <li>If the dataset has <kbd>active="true"</kbd> and the dataset isn't already loaded,
         it is loaded.
       <li>If the dataset has <kbd>active="true"</kbd> and the dataset is already loaded,
         the data set is reloaded if the dataset's age (time since last load) is greater than 
         its <kbd>&lt;reloadEveryNMinutes&gt;</kbd> (default = 10080 minutes),
         otherwise, the dataset is left alone.
       </ul>
    <li>LoadDatasets finishes.
    </ol>
    The RunLoadDatasets thread waits for the LoadDatasets thread to finish.
    If LoadDatasets takes longer than <kbd>loadDatasetsMinMinutes</kbd>
    (as specified in setup.xml), RunLoadDatasets interrupts the LoadDatasets thread.
    Ideally, LoadDatasets notices the interrupt and finishes.
    But if it doesn't notice the interrupt within a minute, 
    RunLoadDatasets calls <kbd>loadDatasets.stop()</kbd>, which is undesirable.

  <li>While the time since the start of the last majorLoad is less than
    <kbd>loadDatasetsMinMinutes</kbd> (as specified in setup.xml, e.g., 15 minutes),
    RunLoadDatasets repeatedly looks for <a rel="help" href="#flag">flag</a> files
    in the <i>bigParentDirectory</i>/flag directory.  If one or more flag files are 
    found, they are deleted, and RunLoadDatasets starts a LoadDatasets thread to do a 
    "minorLoad" (majorLoad=false).  You can't see minorLoad information on 
    your ERDDAP's <a rel="help" href="#statusPage">/erddap/status.html page</a>. 
    <ol>
    <li>LoadDatasets makes a copy of datasets.xml.
    <li>LoadDatasets reads through the copy of datasets.xml and, 
       for each dataset for which there was a flag file:
       <ul>
       <li>If the dataset's dataset.xml chunk has <kbd>active="false"</kbd>
         and the dataset is currently loaded (active), is is unloaded (removed).
       <li>If the dataset has <kbd>active="true"</kbd>, the dataset is (re)loaded,
         regardless of its age.
       </ul>
       Non-flagged datasets are ignored.
    <li>LoadDatasets finishes.
    </ol>

  <li>RunLoadDatasets goes back to step 1.
  </ol>
<br>Notes:
  <ul>
  <li><a class="selfLink" id="DRStartup" href="#DRStartup" rel="bookmark">Startup</a>
    <br>When you restart ERDDAP, every dataset with <kbd>active="true"</kbd> is loaded.
  <li><a class="selfLink" id="DRCache" href="#DRCache" rel="bookmark">Cache</a>
    <br>When a dataset is (re)loaded, its cache (including any data response files
    and/or image files) is emptied.  
  <li><a class="selfLink" id="DRLotsOfDatasets" href="#DRLotsOfDatasets" rel="bookmark">Lots of Datasets</a>
    <br>If you have a lot of datasets and/or one or more datasets are slow to (re)load,
    a LoadDatasets thread may take a long time to finish its work,
    perhaps even longer than <kbd>loadDatasetsMinMinutes</kbd>.
  <li><a class="selfLink" id="DROneLoadDatasetsThread" href="#DROneLoadDatasetsThread" rel="bookmark">One LoadDatasets Thread</a>
    <br>There is never more than one LoadDatasets thread running at once.
    If a flag is set when LoadDatasets is already running,
    the flag probably won't be noticed or acted on until that LoadDatasets thread finishes running.
    You might say: "That's stupid. Why don't you just start a bunch of new threads
    to load datasets?"  But if you have lots of datasets which get data from
    one remote server, even one LoadDatasets thread will put substantial stress
    on the remote server.  The same is true if you have lots of datasets which get data from 
    files on one RAID.  There are rapidly diminishing returns from having 
    more than one LoadDatasets thread.
  <li><a class="selfLink" id="DRFlagASAP" href="#DRFlagASAP" rel="bookmark">Flag = ASAP</a>
    <br>Setting a flag just signals that the dataset should be (re)loaded
    as soon as possible, not necessarily immediately.
    If no LoadDatasets thread is currently running, the dataset will start to be reloaded
    within a few seconds.
    But if a LoadDatasets thread is currently running, the dataset probably won't be reloaded
    until after that LoadDatasets thread is finished.
  <li><a class="selfLink" id="DRFlagFileDeleted" href="#DRFlagFileDeleted" rel="bookmark">Flag File Deleted</a>
    <br>In general, if you put a flag file in the <kbd><i>bigParentDirectory</i>/erddap/flag</kbd>
    directory (by visiting the dataset's flagUrl or putting an actual file there), the
    dataset will usually be reloaded very soon after that flag file is deleted.    
  <li><a class="selfLink" id="DRFlagVsReloadEveryNMinutes" href="#DRFlagVsReloadEveryNMinutes" rel="bookmark">Flag versus Small <kbd>reloadEveryNMinutes</kbd></a>
    <br>If you have some external way of knowing when a dataset needs to be reloaded
    and if it is convenient for you,
    the best way to make sure that a dataset is always up-to-date is to 
    set its <kbd>reloadEveryNMinutes</kbd> to a large number (10080?) and
    set a flag (via a script?) whenever it needs to be reloaded.
    That is the system that EDDGridFromErddap and EDDTableFromErddap use
    receive messages that the dataset needs to be reloaded.
  <li><a class="selfLink" id="DRLookInLog" href="#DRLookInLog" rel="bookmark">Look in log.txt</a>
    <br>Lots of relevant information is written to the 
    <i>bigParentDirectory</i>/logs/log.txt file.
    If things aren't working as you expect, looking at log.txt
    lets you diagnose the problem by finding out exactly what ERDDAP did.
    <ul>
    <li>Search for "majorLoad=true" for the start of major LoadDataset threads.
    <li>Search for "majorLoad=false" for the start of minor LoadDatasets threads.
    <li>Search for a given dataset's datasetID for information about it being
       (re)loaded or queried.
    </ul>
    <br>&nbsp;
  </ul>

<li><strong><a class="selfLink" id="cachedResponses" href="#cachedResponses" rel="bookmark">Cached Responses</a></strong> -
  In general, ERDDAP doesn't cache (store) responses to user requests.
  The rationale was that most requests would be slightly different so the cache wouldn't be very effective.
  The biggest exceptions are requests for image files 
  (which are cached since browsers and programs like Google Earth often re-request images) 
  and requests for .nc files (because they can't be created on-the-fly).
  ERDDAP stores each dataset's cached files in a different directory:
    <i>bigParentDirectory</i>/cache/<i>datasetID</i> 
  since a single cache directory might have a huge number of files which might become slow to access.
  <br>Files are removed from the cache for one of three reasons:
  <ul>
  <li> All files in this cache are deleted when ERDDAP is restarted.
  <li> Periodically, any file more than <kbd>&lt;cacheMinutes&gt;</kbd> old (as specified in 
    <a rel="help" href="#setup.xml">setup.xml</a>) will be deleted.  
    Removing files in the cache based on age (not Least-Recently-Used) ensures that files won't stay 
    in the cache very long.
    Although it might seem like a given request should always return the same response, that isn't true.
    For example, a tabledap request which includes <kbd>&amp;time><i>someTime</i></kbd> will change if 
    new data arrives for the dataset.
    And a griddap request which includes <kbd>[last]</kbd> for the time dimension will change if new 
    data arrives for the dataset.
  <li>Images showing error conditions are cached, but only for a few minutes (it's a difficult situation).
  <li>Every time a dataset is reloaded, all files in that dataset's cache are deleted.
    Because requests may be for the "last" index in a gridded dataset, files in the cache may become
    invalid when a dataset is reloaded.
    <br>&nbsp;
  </ul>

<li><strong><a class="selfLink" id="storedDatasetInformation" href="#storedDatasetInformation" rel="bookmark">Stored Dataset Information</a></strong> -
  <br>For all types of datasets, ERDDAP gathers lots of information when a dataset 
  is loaded and keeps that
  in memory. This allows ERDDAP to respond very quickly to searches, requests
  for lists of datasets,
  and requests for information about a dataset.

  <p>For a few types of datasets (notably EDDGridCopy, EDDTableCopy, 
  EDDGridFrom<i>Xxx</i>Files, and
  EDDTableFrom<i>Xxx</i>Files), ERDDAP stores on disk some information about the
  dataset that is reused 
  when the dataset is reloaded. This greatly speeds the reloading process.  
  <ul>
  <li>Some of the dataset information files are human-readable .json files and are stored in
    <i>bigParentDirectory</i>/dataset/<i>last2LettersOfDatasetID/datasetID</i> .
  <li>ERDDAP only deletes these files in unusual situations, e.g., if you add
    or delete a variable from the dataset's datasets.xml chunk.
  <li>Most changes to a dataset's datasets.xml chunk (e.g., changing a
    global attribute or a variable attribute) don't necessitate that you delete these files. 
    A regular dataset reload will handle these types of changes.
    You can tell ERDDAP to reload a dataset ASAP by setting a 
    <a rel="help" href="#flag">flag</a> for the dataset.
  <li>Similarly, the addition, deletion, or change of data files will be handled when 
    ERDDAP reloads a dataset. 
    But ERDDAP will notice this type of change soon and automatically 
    if the dataset is using the 
    <a rel="help"  
    href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#updateEveryNMillis"
    ><kbd>&lt;updateEveryNMillis&gt;</kbd></a>
    system.
  <li>It should only rarely be necessary for you to delete these files.
    The most common situation where you need to force ERDDAP to delete the stored
    information (because it is out-of-date/incorrect and won't be automatically 
    fixed by ERDDAP)
    is when you make changes
    to the dataset's datasets.xml chunk that affect how ERDDAP interprets 
    data in the source data files, for example, changing the time variable's format string.
  <li>To delete a dataset's stored information files from an ERDDAP that is running 
    (even if the dataset isn't currently loaded), set a 
    <a rel="help" href="#hardFlag">hardFlag</a> for that dataset.
    Remember that if a dataset is an aggregation of a large number of files,
    reloading the dataset may take considerable time.
  <li>To delete a dataset's stored information files when ERDDAP isn't running, run 
    <a rel="help"  
    href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#DasDds"
    >DasDds</a> for that dataset
    (which is easier than figuring in which directory the info is located and 
    deleting the files by hand).
    Remember that if a dataset is an aggregation of a large number of files,
    reloading the dataset may take considerable time.
    <br>&nbsp;
  </ul>

<li><strong><a class="selfLink" id="OutOfMemoryError" href="#OutOfMemoryError" rel="bookmark"
>OutOfMemoryError</a></strong> -- 
<br>When you set up ERDDAP, you specify the maximum amount of memory that Java
can use via the <a rel="bookmark" href="#memory">-Xmx setting</a>. 
If ERDDAP ever needs more memory than that,
it will throw a java.lang.OutOfMemoryError. ERDDAP does a lot of checking to 
enable it to handle that error gracefully 
(e.g., so a troublesome request will fail, but the system retains its integrity). 
But sometimes, the error damages system integrity and you have to restart ERDDAP. 
Hopefully, that is rare.

<p>The quick and easy solution to an OutOfMemoryError is to increase the 
<a rel="help" href="#memory">-Xmx setting</a>, 
but you shouldn't ever increase the -Xmx setting to more than 80% of the 
physical memory in the server (e.g., for an 10GB server, don't set -Xmx above 
8GB). Memory is relatively cheap, so it may be a good option to increase 
the memory in the server. But if you have maxed out the memory in the server
or for other reasons can't increase it, you need to deal more directly with the 
cause of the OutOfMemoryError.

<p>If you look in the <a rel="help" href="#log">log.txt</a> 
file to see what ERDDAP was doing when the error arose, 
you can usually get a good clue as to the cause of the OutOfMemoryError. 
There are lots of possible causes, including:  

<ul>
<li>A single huge data file can cause the OutOfMemoryError, notably, huge ASCII 
data files. 
If this is the problem, it should be obvious because ERDDAP will fail to load the dataset 
(for tabular datasets) or read data from that file (for gridded datasets). 
The solution, if feasible, is to split the file into multiple files. 
Ideally, you can split the file into logical chunks. 
For example, if the file has 20 month's worth of data, split it into 20 files, 
each with 1 month's worth of data. 
But there are advantages even if the main file is split up arbitrarily. 
This approach has multiple benefits: 
a) This will reduce the memory needed to read the data files to 1/20th, 
because only one file is read at a time. 
b) Often, ERDDAP can deal with requests much faster because it only has to look 
in one or a few files to find the data for a given request. 
c) If data collection is ongoing, then the existing 20 files can remain unchanged, 
and you only need to modify one, small, new file to add the next month's worth of data to the dataset.

<li>A single huge request can cause the OutOfMemoryError. 
In particular, some of the orderBy options have the entire response in memory 
for a second (e.g., to do a sort). If the response is huge, it can lead to the error.
There will always be some requests which are, in various ways, too big.
You can solve the problem by increasing the -Xmx setting. 
Or, you can encourage the user to make a series of smaller requests.

<li>It is unlikely that a large number of files would cause the file index that 
ERDDAP creates to be so large that that file would cause the error. 
If we assume that each file uses 300 bytes, then 1,000,000 files would only take up 300MB. 
But datasets with a huge number of data files cause other problems for ERDDAP,
notably, it takes a long time for ERDDAP to open all those data files
when responding to a user request for data. 
In this case, the solution may be to aggregate the files to that there are fewer data files.
For tabular datasets, it is often great if you save the data from the current dataset in
<a href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html#discrete-sampling-geometries"
    >CF Discrete Sampling Geometries (DSG)<img 
        src="../images/external.png" alt=" (external link)" 
        title="This link to an external website does not constitute an endorsement."></a> 
Contiguous Ragged Array data files (request .ncCF files from ERDDAP) and then make a new dataset. 
These files can be handled very efficiently with ERDDAP's
<a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#EDDTableFromNcCFFiles">EDDTableFromNcCFFiles</a>).
If they are logically organized (each with data for a chunk of space and time), 
ERDDAP can extract data from them very quickly.

<li>For tabular datasets that use the 
<a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#subsetVariables">&lt;subsetVariables&gt;</a> 
attribute, ERDDAP makes a table of unique combinations of the values of
those variables. 
For huge datasets or when &lt;subsetVariables&gt; is misconfigured,
this table can be large enough to cause OutOfMemoryErrors.
The solution is to remove variables from the list of &lt;subsetVariables&gt;
for which there are a large number of values, or remove variables 
as needed until the size of that table is reasonable.
The parts of ERDDAP that use the subsetVariables system don't work well
(e.g., web pages load very slowly) when there are more than 100,000 rows in that table.

<li>It's always possible that several simultaneous large requests 
(on a really busy ERDDAP) can combine to cause memory trouble. 
For example, 8 requests, each using 1GB each, would cause problems for an 
-Xmx=8GB setup. But it is rare that each request would be at the peak of its 
memory use simultaneously. 
And you would easily be able to see that your ERDDAP is really busy with big requests. 
But, it's possible.
It's hard to deal with this problem other than by increasing the -Xmx setting.

<li>There are other scenarios. 
If you look at the 
<a rel="help" href="#log">log.txt</a> 
file to see what ERDDAP was doing when the error arose, 
you can usually get a good clue as to the cause. 
In most cases, there is a way to minimize that problem (see above), 
but sometimes you just need more memory.
<br>&nbsp;
</ul>


<li><strong><a class="selfLink" id="requestsFailed" href="#requestsFailed" rel="bookmark">Unusual Activity: >25% of requests failed</a></strong> -- 
<br>You will probably get an email from ERDDAP periodically with the subject 
"Unusual Activity: >25% of requests failed". It is worth figuring out what is going wrong.
The only way to figure out what is going wrong is to read the 
[bigParentDirectory]/logs/<a rel="help" href="#log">log.txt</a> file and search for "error". 
For each error message, look just above it to find the line where the original request is logged.
The line starts with "{{{{#" and includes the user's IP number and the actual request.

<p>Use the user's IP number (for example, with 
<a rel="help" href="https://whatismyipaddress.com/ip-lookup"
                   >https://whatismyipaddress.com/ip-lookup<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>)
to try to figure who or what the user is.
Sometimes that will tell you pretty accurately who the user is (e.g., it's a search engine's web crawler).
Most of the time it just gives you a clue 
(e.g., it's an amazonaws computer, it's from some university, 
it's someone in Washington State (no offense intended; I like Washington)).

<p>By looking at the actual request, the IP number, and the error message 
(all from <a rel="help" href="#log">log.txt</a>) for
a series of errors, you can usually figure out basically what is going wrong.
In my experience, there are three common causes of lots of failed requests:

<p>1) A search engine is naively trying the URLs listed in ERDDAP web pages and 
ISO 19115 documents. For example, there are many places which list the base OPeNDAP URL, for example,
https://coastwatch.pfeg.noaa.gov/erddap/griddap/jplMURSST, to which the user is 
supposed to add a file type (e.g., .das, .dds, .html). 
But the search engine doesn't know this. And the request to the base URL fails. 
A related situation is when the search engine generates bizarre requests or 
tries to fill out forms in order to get to "hidden" web pages. 
But the search engines often do a bad job of this, leading to failures. 
The solution is: create a <a rel="help" href="#robots">robots.txt</a> file.

<p>2) Some user is running a script that is repeatedly asking for something that isn't there. 
Maybe it is a dataset that used to exist, but is gone now (temporarily or permanently).
Scripts often don't expect this and so don't deal with it intelligently. 
So the script just keeps making requests and the requests keep failing.  
If you can guess who the user is (from the IP number above), contact them 
and tell them the dataset is no longer available and ask them to change their script.

<p>3) Something is really wrong with some dataset. Usually, ERDDAP will 
make the troubled dataset inactive. Sometimes it doesn't, so all the requests
to it just lead to errors. If so, fix the problem with the dataset or (if you can't)
set the dataset to 
<a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#active">active="false"</a>.
Of course, this may lead to problem #2.

<p>Sometimes the errors aren't so bad, notably, if ERDDAP can detect the error
and respond very quickly (&lt;=1ms). So you may decide to take no action.

<p>If all else fails, there is a universal solution: 
add the user's IP number to the <a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#requestBlacklist">&lt;requestBlacklist&gt;</a>.
This isn't as bad or as drastic an option as it might seem. 
The user will then get an error message saying s/he has been blacklisted and 
telling them your (the ERDDAP administrator's) email address.  
Sometimes the user will contact you and you can resolve the problem. 
Sometimes the user doesn't contact you and you will see the exact same behavior 
coming from a different IP number the next day. 
Blacklist the new IP number and hope that they will eventually get the message.
(Or this is your Groundhog Day, from which you will never escape. Sorry.)

<li><strong><a class="selfLink" id="robots" href="#robots" rel="bookmark">robots.txt</a></strong> -- 
  The search engine companies use web crawlers (e.g., GoogleBot) to examine all of
  the pages on the web to add the content to the search engines.
  For ERDDAP, that is basically good.  ERDDAP has lots of links between pages, so the crawlers
  will find all of the web pages and add them to the search engines. 
  Then, users of the search engines will be able to find datasets on your ERDDAP.

  <p>Unfortunately, some web crawlers (e.g., GoogleBot) are now filling out and submitting
  forms in order to find additional content.  For web commerce sites, this is great. 
  But this is terrible for ERDDAP because it just leads to an <strong>infinite</strong> number of
  undesirable and pointless attempts to crawl the actual data. 
  This can lead to more requests for data than from all other users combined.
  And it fills the search engine with goofy, pointless subsets of the actual data.

  <p>To tell the web crawlers to stop filling out forms and just generally not 
    looking at web pages they don't need to look at, you need to create a text file called 
  <a rel="help" href="https://en.wikipedia.org/wiki/Robots_exclusion_standard">robots.txt<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> 
  in the root directory of your website's document hierarchy so that it can be viewed by 
  anyone as, e.g., http://<i>www.your.domain</i>/robots.txt .
  <br>If you are creating a new robots.txt file, this is a good start:
    <pre>
User-Agent: *
Disallow: /erddap/files/ 
Disallow: /files/ 
Disallow: /images/ 
Disallow: /*?
Disallow: /*?*
Disallow: /*.asc*
Disallow: /*.csv*
Disallow: /*.dods*
Disallow: /*.esriAscii*
Disallow: /*.esriCsv*
Disallow: /*.geoJson*
Disallow: /*.htmlTable*
Disallow: /*.json*
Disallow: /*.mat*
Disallow: /*.nc*
Disallow: /*.odvTxt*
Disallow: /*.tsv*
Disallow: /*.xhtml*
Disallow: /*.geotif*
Disallow: /*.itx*
Disallow: /*.kml*
Disallow: /*.pdf*
Disallow: /*.png*
Disallow: /*.large*
Disallow: /*.small*
Disallow: /*.transparentPng*
Sitemap: http://<strong><i>your.institutions.url</i></strong>/erddap/sitemap.xml</pre>
  (But replace <i>your.institutions.url</i> with your ERDDAP's base URL.
  <br>It may take a few days for the search engines to notice and for the changes to take effect.
  <br>&nbsp;

<li><strong><a class="selfLink" id="sitemap" href="#sitemap" rel="bookmark">sitemap.xml</a></strong> -- 
  As the
  <a rel="help" href="https://www.sitemaps.org/">https://www.sitemaps.org<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> website says:
  <blockquote>Sitemaps are an easy way for webmasters to inform search engines about pages on their 
  sites that are available for crawling. In its simplest form, a Sitemap is an XML file that lists
  URLs for a site along with additional metadata about each URL (when it was last updated, how
  often it usually changes, and how important it is, relative to other URLs in the site) so that
  search engines can more intelligently crawl the site.

  <p>Web crawlers usually discover pages from links within the site and from other sites. Sitemaps
  supplement this data to allow crawlers that support Sitemaps to pick up all URLs in the Sitemap
  and learn about those URLs using the associated metadata. Using the Sitemap protocol does not
  guarantee that web pages are included in search engines, but provides hints for web crawlers
  to do a better job of crawling your site.
  </blockquote>
  Actually, since ERDDAP is RESTful, search engine spiders can easily crawl your ERDDAP.
  But they tend to do it more often (daily!) than necessary (monthly?).
  <ul>
  <li>Given that each search engine may be crawling your entire ERDDAP every day,
    this can lead to a lot of unnecessary requests.
  <li>So ERDDAP generates a sitemap.xml file for your ERDDAP which tells search engines 
    that your ERDDAP only needs to be crawled every month.
  <li>You should add a reference to ERDDAP's sitemap.xml to your 
     <a rel="help" href="https://en.wikipedia.org/wiki/Robots_exclusion_standard">robots.txt<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> file:
     <br><kbd>Sitemap: http://<strong>www.yoursite.org</strong>/erddap/sitemap.xml</kbd>
  <li>If that doesn't seem to be getting the message to the crawlers, you can tell the various search 
    engines about the sitemap.xml file by visiting these URLs (but change <strong>YourInstitution</strong> 
    to your institution's acronym or abbreviation and <strong>www.yoursite.org</strong> to your ERDDAP's URL):
    <ul> <!-- from http://rapid-dev.net/tag/ping-bing-sitemap/ -->
    <li>https://www.bing.com/webmaster/ping.aspx?siteMap=http://<strong>www.yoursite.org</strong>/erddap/sitemap.xml
    <li>https://www.google.com/ping?sitemap=http://<strong>www.yoursite.org</strong>/erddap/sitemap.xml    
    </ul>
    (I think) you just need to ping each search engine once, for all time. 
    The search engines will then detect changes to sitemap.xml periodically.
  </ul>
<br>&nbsp;

<li><strong><a class="selfLink" id="pushPull" href="#pushPull" rel="bookmark">Data Dissemination / Data Distribution Networks: Push and Pull Technology</a></strong> 
  <ul>
  <li>Normally, ERDDAP acts as an intermediary: it takes a request from a user; 
    gets data from a remote data source; reformats the data; and sends it to the user.
  <li><a rel="help" href="https://en.wikipedia.org/wiki/Pull_technology">Pull Technology<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>: 
    ERDDAP also has the ability to actively get all of the available data  
    from a remote data source and 
    <a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#EDDGridCopy">store 
    a local copy of the data</a>.
  <li><a rel="help" href="https://en.wikipedia.org/wiki/Push_technology">Push Technology<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>: 
    By using ERDDAP's 
    <a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/information.html#subscriptions">subscription services</a>, 
    other data servers can be notified as soon 
    as new data is available so that they can request the data (by pulling the data).
  <li>ERDDAP's 
<a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#EDDGridFromErddap">EDDGridFromErddap</a> and
<a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#EDDTableFromErddap">EDDTableFromErddap</a> use ERDDAP's subscription services and 
    <a rel="help" href="#flag">flag system</a> so that it will be notified immediately when new data is available. 
  <li>You can combine these to great effect: if you wrap an EDDGridCopy around an EDDGridFromErddap 
    dataset (or wrap an EDDTableCopy around an EDDTableFromErddap dataset),
    ERDDAP will automatically create and maintain a local copy of another ERDDAP's dataset.
  <li>Because the subscription services work as soon as new data is available,
    push technology disseminates data very quickly (within seconds).
  </ul>

  <p>This architecture puts each ERDDAP administrator in charge of determining where the data 
  for his/her ERDDAP comes from.
  <ul>
  <li>Other ERDDAP administrators can do the same.  There is no need for coordination between 
    administrators.
  <li>If many ERDDAP administrators link to each other's ERDDAPs, a data distribution network is formed.
  <li>Data will be quickly, efficiently, and automatically disseminated from data sources 
    (ERDDAPs and other servers) to data redistribution sites (ERDDAPs) anywhere in the network.
  <li>A given ERDDAP can be both a source of data for some datasets and a redistribution site for other
    datasets.
  <li>The resulting network is roughly similar to data distribution networks set up with programs like 
    <a rel="help" href="https://www.unidata.ucar.edu/projects/index.html#idd">Unidata's IDD/IDM<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>, but less rigidly structured.
    <br>&nbsp;
  </ul>


<li><strong><a class="selfLink" id="security" href="#security" rel="bookmark">Security, Authentication, and Authorization</a></strong> -
By default, ERDDAP 
runs as an entirely public server (using http and/or https)  
with no login  
(<a rel="help" href="https://en.wikipedia.org/wiki/Authentication">authentication<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>) 
system and no restrictions to data access 
(<a rel="help" href="https://en.wikipedia.org/wiki/Authorization">authorization<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>). 

<p>If you want to restrict access to some or all datasets to some users, you can use ERDDAP's
built-in security system. When the security system is in use:
<ul>
<li>ERDDAP uses 
    <a rel="help" href="https://en.wikipedia.org/wiki/Role-based_access_control">role-based access control<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>.
  <ul>
  <li>The ERDDAP administrator defines users with the
    <a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#user"><kbd>&lt;user&gt;</kbd></a>
    tag in datasets.xml.
    Each user has a username, a password (if <kbd>authentication=custom</kbd>), 
    and one or more roles. 
  <li>The ERDDAP administrator defines which roles have access to a given dataset via the
    <a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#accessibleTo"><kbd>&lt;accessibleTo&gt;</kbd></a>
    tag in datasets.xml for any dataset that shouldn't have public access.
  </ul>
<li>The user's log in status (and a link to log in/out) will be shown at the top
  of every web page.
  (But a logged in user will appear to ERDDAP to be not logged in if he uses an http URL.)
<li>If the &lt;baseUrl&gt; that you specify in your setup.xml is an <strong>http</strong> URL,
  users who are not logged in may use ERDDAP's <strong>http</strong> URLs.
  If &lt;baseHttpsUrl&gt; is also specified, users who are not logged in 
  can also use https URLs.
<li><a class="selfLink" id="httpsOnly" href="#httpsOnly" rel="bookmark">HTTPS Only</a> -- 
  If the &lt;baseUrl&gt; that you specify
  in your setup.xml is an <strong>https</strong> URL,
  users who are not logged are encouraged (not forced) to use ERDDAP's 
  <strong>https</strong> URLs --
  all of the links on ERDDAP web pages will refer to https URLs.

  <p>If you want to force users to use https URL, add a <kbd>Redirect permanent</kbd>
  line inside the <kbd>&lt;VirtualHost *:80&gt;</kbd> section in 
  your Apache's config file (usually httpd.conf), e.g.,
<pre>
&lt;VirtualHost *:80&gt;
  [...]
  ServerName example.com
  Redirect permanent / https://example.com/
&lt;/VirtualHost&gt;
</pre>

  If you want, there is an additional method to force the use of https:
  <a rel="bookmark" href="https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security"
    >HTTP Strict Transport Security (HSTS)<img 
    src="../images/external.png" alt=" (external link)" 
    title="This is a link to an external website."/></a>. To use it:
  <ol>
  <li> Enable the Apache Headers Module: a2enmod headers
  <li> Add the additional header to the HTTPS VirtualHost directive. 
    Max-age is measured in seconds and can be set to some long value.
<pre>
&lt;VirtualHost *:443&gt;
  # Guarantee HTTPS for 1 Year including Sub Domains 
  Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"
</pre>
  </ol>
Please note that this header is only valid on a HTTPS VirtualHost.

  <p>A reason not to force users to use https URLs is: 
  the underlying SSL/TLS link takes time to establish and
  then takes time to encrypt and decrypt all information transmitted between
  the user and the server. But some institutions require https only.

<li>Users who are logged in MUST use ERDDAP's <strong>https</strong> URLs.
  If they use http URLs, they appear to ERDDAP to be not logged in.
  This ensures the privacy of the communications and 
  helps prevent 
    <a rel="help" href="https://en.wikipedia.org/wiki/Session_hijacking"
    >session hijacking and sidejacking<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>.    
<li>Anyone who isn't logged in can access and use the public datasets.
  By default, private datasets don't appear in lists of datasets if a user isn't logged in.
  If the administrator has set setup.xml's <kbd>&lt;listPrivateDatasets&gt;</kbd> to true, 
  they will appear.
  Attempts to request data from private datasets (if the user knows the URL) will be redirected
  to the login page.
<li>Anyone who is logged in will be able to see and request data from any public dataset
  and any private dataset to which their role allows them access.
  By default, private datasets to which a user doesn't have access don't appear in lists of datasets.
  If the administrator has set setup.xml's <kbd>&lt;listPrivateDatasets&gt;</kbd> to true, 
  they will appear.
  Attempts to request data from private datasets to which the user doesn't have access will be 
  redirected to the login page.
<li>The RSS information for fully private datasets is only available to users
  (and RSS readers) who are logged in and authorized to use that dataset.
  This makes RSS not very useful for fully private datasets.
  <p>If a dataset is private but its 
  <a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#graphsAccessibleTo"><kbd>&lt;graphsAccessibleTo&gt;</kbd></a>
  is set to 
  <kbd>public</kbd>, the dataset's RSS is accessible to anyone.
<li>Email subscriptions can only be set up when a user has access to a dataset.
  If a user subscribes to a private dataset, the subscription 
  continues to function after the user has logged out.
</ul>

<p><a class="selfLink" id="setupSecurity" href="#setupSecurity" rel="bookmark">To set up the security/authentication/authorization system:</a>
<ul>
<li>Do the standard ERDDAP <a rel="help" href="#initialSetup">initial setup</a>.
<li>In <a rel="help" href="#setup.xml">setup.xml</a>, 
  <ul>
  <li>Add/change the <kbd>&lt;authenticate&gt;</kbd> value from nothing to 
    <kbd>custom</kbd> (don't use this), <kbd>email</kbd> (don't use this), <kbd>google</kbd> (recommended),
    <kbd>orcid</kbd> (recommended), or <kbd>oauth2</kbd> (which is google+orcid, recommended).
    See the comments about these options below.
  <li>Add/change the <kbd>&lt;baseHttpsUrl&gt;</kbd> value. 
  <li>Insert/uncomment <kbd>&amp;loginInfo;</kbd> in <kbd>&lt;startBodyHtml&gt;</kbd> to display 
    the user's log in/out info 
    at the top of each web page.
  </ul>
<li>For testing purposes on your personal computer, 
  <a rel="help" href="https://tomcat.apache.org/tomcat-8.0-doc/ssl-howto.html"
    >follow these instructions to configure tomcat to support SSL<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
      (the basis for https connections) by creating a keystore with a 
   <a rel="help" href="https://en.wikipedia.org/wiki/Self-signed_certificate"
     >self-signed certificate<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
    and by modifying <i>tomcat</i>/conf/server.xml to uncomment the connector for port 8443.
    On Windows, you may need to move .keystore from "c:\Users\<i>you</i>\.keystore" to 
    "c:\Users\Default User\.keystore"  or "c:\.keystore" 
    (see <i>tomcat</i>/logs/catalina.<i>today</i>.log if the application doesn't 
    load or users can't see the log in page).
    You can see when the .keystore certificate will expire by examining the 
    certificate when you log in.  
  <p>For a publicly accessible server, instead of using a self-signed certificate, 
    it is strongly recommended that you buy and install a certificate signed by a 
     <a rel="help" href="https://en.wikipedia.org/wiki/Certificate_authority">certificate authority<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>, 
     because it gives your clients more assurance that they are indeed connecting to your
    ERDDAP, not a man-in-the-middle's version of your ERDDAP.
    Many vendors sell digital certificates. (Search for web.) They are not expensive. 
<li>On Linux computers, if Tomcat is running in Apache, modify the 
  /etc/httpd/conf.d/ssl.conf
  file to allow HTTPS traffic to/from ERDDAP without requiring the :8443 port number
  in the URL:
  <ol>
  <li>Modify the existing &lt;VirtualHost&gt; tag (if there is one),
    or add one at the end of the file so that it at least has these lines:
<pre>
&lt;VirtualHost _default_:443&gt;
   SSLEngine on
   SSLProxyEngine On
   ProxyPass /erddap http://localhost:8443/erddap
   ProxyPassReverse /erddap http://localhost:8443/erddap
&lt;/VirtualHost&gt;
</pre>
  <li>Then restart Apache: <kbd>/usr/sbin/apachectl -k graceful</kbd> (but sometimes it is in a different directory).
  </ol>

<li>In <i>tomcat</i>/conf/server.xml, uncomment the port=8443 &lt;Connector&gt; tag:
<pre>
&lt;Connector port="8443" 
    protocol="org.apache.coyote.http11.Http11NioProtocol"
    maxThreads="150" SSLEnabled="true"&gt;
  &lt;SSLHostConfig&gt;
    &lt;Certificate certificateKeystoreFile="conf/localhost-rsa.jks" 
      type="RSA" /&gt;
  &lt;/SSLHostConfig&gt;
&lt;/Connector&gt;
</pre>
and change the location of the certificateKeystoreFile.

<li><a class="selfLink" id="authorization" href="#authorization" rel="bookmark">In datasets.xml, create a</a>
  <a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#user"><kbd>&lt;user&gt;</kbd></a>
  tag for each user with username, password (if <kbd>authorization=custom</kbd>), 
    and roles information.
  This is the authorization part of ERDDAP's security system.
      <br>&nbsp;
<li>In datasets.xml, add an
  <a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#accessibleTo"
  ><kbd>&lt;accessibleTo&gt;</kbd></a>
  tag to each dataset that shouldn't have public access.
  <kbd>&lt;accessibleTo&gt;</kbd> lets you specify which roles have access to that dataset.
      <br>&nbsp;
<li>Restart Tomcat.
  Trouble? Check the Tomcat logs.
      <br>&nbsp;
<li>CHECK YOUR WORK! Any mistake could lead to a security flaw.
      <br>&nbsp;
<li>Check that the login page uses https (not http).
  Attempts to login via http should be automatically redirected to 
  https and port 8443 (although the port number may be hidden via an Apache proxy).
  You may need to work with your network administrator to allow external web 
  requests to access port 8443 on your server.
      <br>&nbsp;
<li>You can change the <kbd>&lt;user&gt;</kbd> and <kbd>&lt;accessibleTo&gt;</kbd> 
  tags at any time.
  The changes will be applied at the next regular reload of any dataset,
  or ASAP if you use a <a rel="help" href="#flag">flag</a>. 
</ul>

<p><a class="selfLink" id="authentication" href="#authentication" rel="bookmark"><strong>Authentication (logging in)</strong></a>
  <br>If you don't want to allow users to log in, don't specify a value for <kbd>&lt;authentication&gt;</kbd> in setup.xml.
<br>If you do want to allow users to log in, you must specify a value for 
  <kbd>&lt;authentication&gt;</kbd>. Currently, ERDDAP supports 
  <br><a rel="help" href="#authenticationCustom"><kbd>custom</kbd></a> (don't use this),
  <br><a rel="help" href="#authenticationEmail"><kbd>email</kbd></a> (don't use this), 
  <br><a rel="help" href="#authenticationGoogle"><kbd>google</kbd></a> (recommended), 
  <br><a rel="help" href="#authenticationOrcid"><kbd>orcid</kbd></a> (recommended), and
  <br><a rel="help" href="#authenticationOauth2"><kbd>oauth2</kbd></a> (recommended) for the authentication method.
<br>If you want to enable logging in, 
we strongly recommend the <kbd>google, orcid,</kbd> or <kbd>oauth2</kbd> options because they 
free you from storing and handling user's passwords (needed for <kbd>custom</kbd>)
and are more secure than the <kbd>email</kbd> option.
Remember that users often use the same password at different sites.
So they may be using the same password for your ERDDAP as they do at their bank.
That makes their password very valuable -- much more valuable to the user than 
just the data they are requesting.
So you need to do as much as you can to keep the passwords private.
That is a big responsibility.
The <kbd>email, google, orcid,</kbd> and <kbd>oauth2</kbd> options take care of passwords, 
so you don't have to gather, store, or work with them. 
So you are freed from that responsibility.

<p>All <kbd>&lt;authentication&gt;</kbd> options use a 
    <a rel="help" href="https://en.wikipedia.org/wiki/HTTP_cookie">cookie<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> 
  on the user's computer, so the user's browser must be 
  set to allow cookies.  If a user is making ERDDAP requests from a computer
  program (not a browser), cookies and authentication are hard to work with. 
  That's a common problem with all authentication systems. Sorry.


<p>The details of the <kbd>&lt;authentication&gt;</kbd> options are:
<ul>
<li><a class="selfLink" id="authenticationCustom" href="#authenticationCustom" rel="bookmark"><kbd><strong>custom</strong></kbd></a>
  <br><kbd>custom</kbd> is ERDDAP's custom system for letting users log in by 
  entering their User Name and Password in a form on a web page.
  If a user tries and fails to log in 3 times within 10 minutes, 
  the user is blocked from trying to log in for 10 minutes. 
  This prevents hackers from simply trying millions
  of passwords until they find the right one.

  <p>This is somewhat secure because the User Name and Password are transmitted via https 
  (not http),
  but <kbd>authentication=google, orcid,</kbd> or <kbd>oauth2</kbd> are better because they free you from
  having to handle passwords.
  The <kbd>custom</kbd> approach requires you to collect a user's Name and 
  a hash digest of their Password 
  (use your phone! email isn't secure!) and store them in datasets.xml in  
    <a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#user"><kbd>&lt;user&gt;</kbd></a> tags.

  <p>With the <kbd>custom</kbd> option, no one can log in until you 
  (the ERDDAP administrator) create a <kbd>&lt;user&gt;</kbd> tag for the user,
  specifying the user's name as the username, 
  the hash digest of their password as the password, and their roles.

  <p>Not Recommended
  <br>Because of the awkwardness of generating and transmitting the hash digest
  of the user's password and because of the risks associated with 
  ERDDAP holding the hash digests of the passwords, 
  this option is not recommended.

  <p>To increase the security of this option:
  <ul>
  <li>You MUST make sure that other users on the server (i.e., Linux users, not ERDDAP users) 
    can't read files in the Tomcat directory (especially the datasets.xml file!)
    or ERDDAP's bigParentDirectory. 
    <br>On Linux, as user=tomcat, use: 
    <br><kbd>chmod -R g-rwx <i>bigParentDirectory</i></kbd>
    <br><kbd>chmod -R o-rwx <i>bigParentDirectory</i></kbd>
    <br><kbd>chmod -R g-rwx <i>tomcatDirectory</i></kbd>
    <br><kbd>chmod -R o-rwx <i>tomcatDirectory</i></kbd>
      <br>&nbsp;
  <li>Use <kbd>UEPSHA256</kbd> for <kbd>&lt;passwordEncoding&gt;</kbd>
    in setup.xml.
      <br>&nbsp;
  <li>Use an as-secure-as-possible method to pass the hash digest
    of the user's password from the user to the ERDDAP administrator (phone?).
    <br>&nbsp;
  </ul>

<li><a class="selfLink" id="authenticationEmail" href="#authenticationEmail" rel="bookmark"><kbd><strong>email</strong></kbd></a>
  <br>The <kbd>email</kbd> authentication option uses a user's email account 
  to authenticate the user (by sending them an email with a special link
  that they have to access in order to log in).
  Unlike other emails that ERDDAP sends, ERDDAP does not write these 
  invitation emails to the email log file because they contain confidential 
  information.
  <br>In theory, this is not very secure, because emails aren't always encrypted,
  so a bad guy with the ability to intercept emails could abuse this system
  by using a valid user's email address and intercepting the invitation email.
  <br>In practice, if you set up ERDDAP to use a Google email account to send emails,
  and if you set it up to use one of the TLS options for the connection, 
  and if the user has a Google email account, this is somewhat secure because
  the emails are encrypted all the way from ERDDAP to the user.

  <p>To increase the security of this option:
  <ul>
  <li>Make sure that other users on the server (i.e., Linux users, not ERDDAP users) 
    can't read files in the Tomcat directory or ERDDAP's bigParentDirectory. 
    <br>On Linux, as user=tomcat, use: 
    <br><kbd>chmod -R g-rwx <i>bigParentDirectory</i></kbd>
    <br><kbd>chmod -R o-rwx <i>bigParentDirectory</i></kbd>
    <br><kbd>chmod -R g-rwx <i>tomcatDirectory</i></kbd>
    <br><kbd>chmod -R o-rwx <i>tomcatDirectory</i></kbd>
      <br>&nbsp;
  <li>Set things up to get end-to-end security for the emails
    sent from ERDDAP to the users.
    For example, you could make a Google-centric system by 
    only creating &lt;user&gt; tags for Google-managed email addresses
    and by setting up your ERDDAP to use a Google email server 
    via a secure/TLS connection: in your setup.xml, use e.g., <kbd>
    <br>&lt;emailSmtpHost&gt;smtp.gmail.com&lt;/emailSmtpHost&gt;
    <br>&lt;emailSmtpPort&gt;587&lt;/emailSmtpPort&gt;
    <br>&lt;emailProperties&gt;mail.smtp.starttls.enable|true&lt;/emailProperties&gt;</kbd>
  </ul>

  <p>Not Recommended
  <br>The <kbd>email</kbd> authentication option isn't recommended. 
  Please use the <kbd>google, orcid,</kbd> or <kbd>oauth2</kbd> option instead.

  <p>As with the <kbd>google, orcid, and oauth2</kbd> options, 
  <kbd>email</kbd> is very convenient for ERDDAP administrators -- 
  you don't ever have to deal with passwords or their hash digests.
  All you need to create is a 
  <a rel="help" 
  href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#user"
  ><kbd>&lt;user&gt;</kbd></a>
  tag for a user in datasets.xml is the user's email address,
  which ERDDAP uses as the user's name.
  (The <kbd>password</kbd> attribute isn't used when authentication=email, google, orcid, or oauth2.)

  <p>With the <kbd>email</kbd> option, only users that have a <kbd>&lt;user&gt;</kbd> tag
  in datasets.xml can try to log in to ERDDAP by providing their
  email address and clicking on the link in the email that ERDDAP sends them.

  <p>ERDDAP treats email addresses as case-insensitive. It does this by
  converting email addresses you enter (in &lt;user&gt; tags)
  or users enter (on the login form) to their all lowercase version.

  <p>To set up authentication=email:
  <ol>
  <li>In your setup.xml, change the &lt;baseHttpsUrl&gt; tag's value.
    <br>For experimenting/working on your personal computer, use 
    <br><kbd>https://localhost:8443</kbd>
    <br>For your public ERDDAP, use
    <br><kbd>https://<i>your.domain.org</i>:8443</kbd> 
    <br>or without the :8443 if you are using an Apache 
    <a rel="help" href="#ProxyPass">proxypass</a> so that the port number isn't needed.
      <br>&nbsp;

  <li>In your setup.xml, change the &lt;authentication&gt; tag's value to <kbd>email</kbd>:
    <br><kbd>&lt;authentication&gt;email&lt;/authentication&gt;</kbd>
      <br>&nbsp;

  <li>In your setup.xml, make sure the email system is setup via all of the
    <kbd>&lt;email...&gt;</kbd> tags, so that ERDDAP can send out emails.
    If possible, set this up to use a secure connection (SSL / TLS) to the email server.
      <br>&nbsp;

  <li>In your datasets.xml, create 
    <a rel="help" 
      href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#user"
      ><kbd>&lt;user&gt;</kbd></a>    
    tags for each user who will have access to private datasets.
    <br>Use the user's email address as the <kbd>username</kbd> in the tag.
    <br>Don't specify the <kbd>password</kbd> attribute in the <kbd>user</kbd> tag. 
      <br>&nbsp;

  <li>Restart ERDDAP so that the changes to setup.xml and datasets.xml take effect.
    <br>&nbsp;
  </ol>

  
<li><a class="selfLink" id="authenticationGoogle" href="#authenticationGoogle" rel="bookmark"><kbd><strong>google</strong></kbd></a>, 
    <a class="selfLink" id="authenticationOrcid"  href="#authenticationOrcid"  rel="bookmark"><kbd><strong>orcid</strong></kbd></a>, and 
    <a class="selfLink" id="authenticationOauth2" href="#authenticationOauth2" rel="bookmark"><kbd><strong>oauth2</strong></kbd></a>&nbsp; (recommended)
  <br>All three of these options are the recommended ERDDAP authentication options.
  They are all the most secure options. 
  The other options have significantly weaker security.
    <br>&nbsp;

  <ul>
  <li>The <kbd>google</kbd> authentication option uses 
    <a rel="help" href="https://developers.google.com/identity/sign-in/web/"
    >Google Sign-In<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>,
    which is an implementation of the 
    <a rel="help" href="https://oauth.net/2/"
    >OAuth 2.0 authentication protocol<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>.
    ERDDAP users sign into their Google email account, 
    including Google-managed accounts such as @noaa.gov accounts.
    This allows ERDDAP to verify the user's identity (name and email address) 
    and access their profile image, 
    but does not give ERDDAP access to their emails, their Google Drive, 
    or any other private information.
    <br>&nbsp;

  <li>The <kbd>orcid</kbd> authentication option uses 
    <a rel="help" href="https://members.orcid.org/api/integrate/orcid-sign-in"
    >Orcid authentication<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>,
    which is an implementation of the 
    <a rel="help" href="https://oauth.net/2/"
    >OAuth 2.0 authentication protocol<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>.
    ERDDAP users sign into their 
    <a rel="help" href="https://members.orcid.org/api/integrate/orcid-sign-in"
    >Orcid account<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>,
    which is commonly used by researchers to identify themselves.
    This allows ERDDAP to verify the user's Orcid identity and get their Orcid account number,   
    but does not give ERDDAP access to their other Orcid account information.
    <br>&nbsp;

  <li>The <kbd>oauth2</kbd> option lets users sign in with either their Google account 
    or their Orcid account.  
  </ul>

  <p>The <kbd>google, orcid,</kbd> and <kbd>oauth2</kbd> options are the successors
  to the <kbd>openid</kbd> option,
  which was discontinued after ERDDAP version 1.68, 
  and which was based on a version of openID that is now out-of-date.
  Please switch to the <kbd>google, orcid,</kbd> or <kbd>oauth2</kbd> option.

  <p>These options are very convenient for ERDDAP administrators -- 
  you don't ever have to deal with passwords or their hash digests.
  All you need to create is a 
  <a rel="help" 
  href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#user"
  ><kbd>&lt;user&gt;</kbd></a>
  tag for a user in datasets.xml which specifies the user's Google email address
  or Orcid account number as the username attribute.
  (The <kbd>password</kbd> attribute isn't used when 
  <kbd>authentication=email, google, orcid</kbd> or <kbd>oauth2</kbd>.)

  <p>With these options, anyone can log in to ERDDAP by 
  signing into their Google email account or Orcid account, 
  but no one will have the right to access private datasets
  until you (the ERDDAP administrator) create a <kbd>&lt;user&gt;</kbd> tag,  
  specifying their Google email address or Orcid account number
  as the username, and specifying their roles.

  <p>ERDDAP treats email addresses as case-insensitive. It does this by
  converting email addresses you enter (in &lt;user&gt; tags)
  or users enter (on the login form) to their all lowercase version.

  <p>To set up <kbd>google, orcid,</kbd> or <kbd>oauth2</kbd> authentication:
  <ul>
  <li>In your setup.xml, change the &lt;baseHttpsUrl&gt; tag's value.
    <br>For experimenting/working on your personal computer, use 
    <br><kbd>https://localhost:8443</kbd>
    <br>For your public ERDDAP, use
    <br><kbd>https://<i>your.domain.org</i>:8443</kbd> 
    <br>or, better, without the :8443 if you are using an Apache 
      <a rel="help" href="#ProxyPass">proxypass</a> so that the port number isn't needed.
    <br>&nbsp;

  <li>In your setup.xml, change the &lt;authentication&gt; tag's value to 
    <kbd>google, orcid,</kbd> or <kbd>oauth2</kbd>, for example:
    <br><kbd>&lt;authentication&gt;oauth2&lt;/authentication&gt;</kbd>
    <br>&nbsp;
 
  <li><a class="selfLink" id="authenticationGoogleDetails" href="#authenticationGoogleDetails" rel="bookmark">For the google and oauth2 options:</a>  
    <br>Follow the instructions below to set up Google authentication for your ERDDAP. 
    <br>&nbsp;
    <ol>
    <li>If you don't have a Google email account, 
      <a rel="help" href="https://www.google.com/intl/en_us/mail/help/about.html"
      >create one<img 
        src="../images/external.png" alt=" (external link)" 
        title="This link to an external website does not constitute an endorsement."></a>
      <br>&nbsp;

    <li>Follow 
     <a rel="help" href="https://developers.google.com/identity/sign-in/web/devconsole-project"
     >these instructions<img 
        src="../images/external.png" alt=" (external link)" 
        title="This link to an external website does not constitute an endorsement."></a>
      to create a Google Developers Console project and get a client ID.

      <p>When the Google form asks for <kbd>authorized JavaScript origins</kbd>, 
      enter the value from <kbd>&lt;baseHttpsUrl&gt;</kbd> 
      from your personal computer's ERDDAP setup.xml, e.g., 
      <br><kbd>https://localhost:8443</kbd>
      <br>On a second line, add the <kbd>&lt;baseHttpsUrl&gt;</kbd> 
        from your public ERDDAP setup.xml, e.g., 
      <br><kbd>https://<i>your.domain.org</i>:8443</kbd> 

      <p>Don't specify any <kbd>Authorized redirect URIs</kbd>.

      <p>When you see your Client ID for this project, 
      copy and paste it into your setup.xml
      (usually just below <kbd>&lt;authentication&gt;</kbd> to be orderly, 
      but placement doesn't actually matter), 
      in the <kbd>&lt;googleClientID&gt;</kbd> tag, e.g.,
      <br><kbd>&lt;googleClientID&gt;<i>yourClientID</i>&lt;/googleClientID&gt;</kbd>
      <br>The client ID will be a string of about 75 characters, 
        probably starting with several digits and ending with 
        <kbd>.apps.googleusercontent.com</kbd> .
      <br>&nbsp;

    <li>In your datasets.xml, create a
      <a rel="help" 
      href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#user"
      ><kbd>&lt;user&gt;</kbd></a>    
      tag for each user who will have access to private datasets.
      For the <kbd>username</kbd> attribute in the tag:
      <ul>
      <li>For users who will sign in with google, use the user's Google email address.
      <li>For users who will sign in with orcid, use the user's Orcid account number (with dashes).
      </ul>
      Don't specify the <kbd>password</kbd> attribute for the <kbd>user</kbd> tag. 
      <br>&nbsp;

    <li>Restart ERDDAP so that the changes to setup.xml and datasets.xml take effect.
      <br>&nbsp;
    </ol>

  <li><a class="selfLink" id="authenticationOrcidDetails" href="#authenticationOrcidDetails" rel="bookmark">For the orcid and oauth2 options:</a>  
     <br>Follow the instructions below to set up Orcid authentication for your ERDDAP. 
     <br>(For details, see  
     <a rel="help" href="https://members.orcid.org/api/integrate/orcid-sign-in"
     >Orcid's authentication API documentation<img 
        src="../images/external.png" alt=" (external link)" 
        title="This link to an external website does not constitute an endorsement."></a>.)
    <br>&nbsp;
    <ol>
    <li>If you don't have an Orcid account, 
      <a rel="help" href="https://orcid.org/signin"
      >create one<img 
        src="../images/external.png" alt=" (external link)" 
        title="This link to an external website does not constitute an endorsement."></a>
      <br>&nbsp;
    <li>Log into Orcid 
        <a rel="help" href="https://orcid.org/signin">https://orcid.org/signin<img 
        src="../images/external.png" alt=" (external link)" 
        title="This link to an external website does not constitute an endorsement."></a>
        using your personal Orcid account.
      <br>&nbsp;
    <li>Click on "Developer Tools" (under "For Researchers" at the top).
      <br>&nbsp;
    <li>Click on "Register for the free ORCID public API". Enter this information:
         <br>Name: ERDDAP at [your organization] 
         <br>Website: [your ERDDAP's domain]
         <br>Description: ERDDAP is a scientific data server. Users need to authenticate with Google or Orcid to access non-public datasets. 
         <br>Redirect URIs: [your ERDDAP's domain]/erddap/loginOrcid.html 
      <br>&nbsp;
    <li>Click on the Save icon (it looks like a 3.5" disk!).
      <br>You can then see your ORCID APP Client ID and ORCID Client Secret.
      <br>&nbsp;
    <li>Copy and paste the ORCID APP Client ID (which will start with "APP-")
         into setup.xml in the &lt;orcidClientID&gt; tag, e.g.,
         <pre>&lt;orcidClientID&gt;APP-<i>ALPHANUMERICCHARACTERS</i>&lt;/orcidClientID&gt;</pre>
    <li>Copy and paste the ORCID Client Secret (lower case alpha-numeric characters
         with dashes) into setup.xml in the &lt;orcidClientSecret&gt; tag, e.g.,
         <pre>&lt;orcidClientSecret&gt;<i>alpha-numeric-characters-with-dashes</i>&lt;/orcidClientSecret&gt;</pre>

    <li>In your datasets.xml, create a
      <a rel="help" 
      href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#user"
      ><kbd>&lt;user&gt;</kbd></a>    
      tag for each user who will have access to private datasets.
      For the <kbd>username</kbd> attribute in the tag:
      <ul>
      <li>For users who will sign in with google, use the user's Google email address.
      <li>For users who will sign in with orcid, use the user's Orcid account number (with dashes).
      </ul>
      Don't specify the <kbd>password</kbd> attribute for the <kbd>user</kbd> tag. 
      <br>&nbsp;

    <li>Restart ERDDAP so that the changes to setup.xml and datasets.xml take effect.
      <br>&nbsp;
    </ol>

  </ul>
</ul>

<a class="selfLink" id="logInEitherWay" href="#logInEitherWay" rel="bookmark">Log In Either Way --</a>  
<br>If you use the <kbd>google, orcid,</kbd> or <kbd>oauth2</kbd> authentication options,
and Google Sign-In or Orcid's Authentication API suddenly 
ceases to work (for whatever reason) or ceases to work as ERDDAP expects,
users won't be able to log in to your ERDDAP. 
As a temporary (or permanent) solution, you can ask users to sign up with the other system
(get a Google email account, or get an Orcid account). To do this:
<ol>
<li>Change the <kbd>&lt;authentication&gt;</kbd> tag so that it allows the 
 other authentication system. 
 The <kbd>oauth2</kbd> option allows users to log in with either system.
<li>Duplicate each of the <kbd>&lt;user&gt;</kbd> tags and 
 change the <kbd>username</kbd> attribute from the 
 Google email address to the corresponding Orcid account number
 (or vice-versa), but keep the <kbd>roles</kbd> attribute the same. 
</ol>

<p>ERDDAP no longer supports the <kbd>openid</kbd> authentication option,
which was based on a version of openID that is now out-of-date.
Please use the <kbd>google, orcid,</kbd> or <kbd>oauth2</kbd> options instead. 

<p><a class="selfLink" id="authenticationBasic" href="#authenticationBasic" rel="bookmark"
>ERDDAP doesn't support BASIC authentication because:</a>  
<ul>
<li>BASIC seems geared toward predefined web pages needing secure access or
  blanket on/off access 
  to the whole site, but ERDDAP allows (restricted access) datasets to be added 
  on-the-fly.
<li>BASIC authentication doesn't offer a way for users to log out!  
<li>BASIC authentication is known to be not secure.  
</ul>


<p><a class="selfLink" id="secureDataSources" href="#secureDataSources" rel="bookmark"
><strong>Secure Data Sources</strong></a>  
<br>If a data set is to have restricted access to ERDDAP users, 
the data source (from where ERDDAP gets the data) should not be publicly accessible.
So how can ERDDAP get the data for restricted access datasets? Some options are:
<ul>
<li>ERDDAP can serve data from local files (for example, via EDDTableFromFiles or EDDGridFromFiles).  
  <br>&nbsp;
<li>ERDDAP can be in a 
     <a rel="help" href="https://en.wikipedia.org/wiki/Demilitarized_zone_(computing)">DMZ<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
     and the data source (e.g., an OPeNDAP server or a database) can be 
   behind a <a rel="help" href="https://en.wikipedia.org/wiki/Firewall">firewall<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>,
     where it is accessible to ERDDAP but not to the public.
  <br>&nbsp;
<li>The data source can be on a public website, but require a login to get the data.
  The two types of dataset that ERDDAP can log on to access is 
    <a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#EDDTableFromDatabase"
      >EDDTableFromDatabase</a> and
    <a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#EDDTableFromCassandra"
      >EDDTableFromCassandra</a>.
  These datasets support (and should always use) user names 
  (create an ERDDAP user who only has read-only privileges),
  passwords, SSL connections, and other security measures.

  <p>But in general, currently, ERDDAP can't deal with these data sources because it has no
  provisions for logging on to the data source.
  This is the reason why access to 
    <a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#EDDGridFromErddap"
      >EDDGridFromErddap and EDDTableFromErddap</a> datasets
  can't be restricted.
  Currently, the local ERDDAP has no way to login and access the metadata information 
  from the remote ERDDAP.
  And putting the "remote" ERDDAP behind your firewall and removing that dataset's 
  accessibleTo restrictions doesn't solve the problem:
  since user requests for EDDXxxFromErddap data need to be redirected to the 
  remote ERDDAP, the remote ERDDAP must be accessible.

</ul>

<p><a class="selfLink" id="defensesAgainstHackers" href="#defensesAgainstHackers" rel="bookmark"
><strong>Defenses Against Hackers</strong></a>
<br>There are bad guy hackers who 
try to exploit security weaknesses in server software like ERDDAP. 
ERDDAP follows the common security advice to have several layers of defenses:

<ul>
<li>Restricted Privileges -- One of the most important defenses is to 
run Tomcat via a user called tomcat that doesn't have a password (so no one
can log in as that user) and has limited file system privileges (e.g.,
read-only access to the data).
See ERDDAP's instructions for <a rel="help" href="#tomcat">setting up tomcat</a>.

<li>Heavy Use -
In general, ERDDAP is built for heavy use, including by scripts which make 
tens of thousands of requests, one after another. 
It is hard for ERDDAP to simultaneously open itself up to heavy legitimate use and
shield itself from abuse.
It is sometimes hard to differentiate heavy legitimate use, excessive legitimate use,
and illegitimate use (and sometimes it is really easy).
Among other defenses, ERDDAP consciously does not allow a single request to 
use an inordinate fraction of the system's resources (unless the system is otherwise
not active). 

<li>Identify Troublesome Users -
If ERDDAP is slowing down or freezing 
(perhaps because a naive user or a bot is running multiple
scripts to submit multiple requests simultaneously 
or perhaps because of a bad guy's
<a rel="help" href="https://en.wikipedia.org/wiki/Denial-of-service_attack">Denial-of-service</a>
attack), you can look at the 
<a rel="help" href="#dailyReport">Daily Report email</a>
(and more frequent identical information in the 
<a rel="help" href="#dailyReport">ERDDAP log file</a>)
which displays the number of requests made by the most active users 
(see "Requester's IP Address (Allowed)").
ERDDAP also sends emails to the administrator whenever there is
<a rel="help" href="#requestsFailed">"Unusual activity: >25% of requests failed"</a>.
You can then look in the ERDDAP log file to see the nature of their requests.
If you feel that someone is making too many requests, bizarre
requests (you wouldn't believe what I've seen, well, maybe you would), 
or attack-type requests, 
you can add their IP address to the blacklist.

<li>Blacklist -- 
You can add the IP address of troublesome users, bots, and 
<a rel="help" href="https://en.wikipedia.org/wiki/Denial-of-service_attack">Denial-of-service</a>
attackers to the ERDDAP
<a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#requestBlacklist"
>blacklist</a>, so that future requests from them will be immediately rejected.
This setting is in datasets.xml so that you can quickly add an IP address to the list
and then <a rel="help" href="#flag">flag</a>
a dataset so that ERDDAP immediately notices and applies the change.
The error message sent to blacklisted users encourages them to contact the ERDDAP administrator
if they feel they have been mistakenly put on the blacklist.
(In our experience, several users have been unaware that they were running
multiple scripts simultaneously, or that their scripts were making nonsense requests.)

<li>Dataset Security -
Some types of datasets (notably, EDDTableFromDatabase) present additional security risks
(e.g., SQL injection)
and have their own security measures. See the information for those types 
of datasets in 
<a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html"
>Working with the datasets.xml File</a>,
notably 
<a rel="help"
href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#databaseSecurity"
>EDDTableFromDatabase security</a>.

<li>Security Audit -- 
I (Bob) tried repeatedly since 2010 to get NOAA IT security to do a security 
audit of ERDDAP. They have repeatedly refused. At one point, they said they
only do that for software developed in the DC area.
Fortunately, in 2012, a group in USGS started to use ERDDAP. 
In early 2013, they hired the security firm Acunetix to do a security scan of ERDDAP.
They found some problems.
I fixed some of them and gave reasons for why the other issues were false alerts. 
They redid the scan. If you would like to see the report and my responses 
(which USGS accepted), please email <kbd>bob dot simons at noaa dot gov</kbd>.

</ul>

<p><strong>Questions? Suggestions?</strong> 
<br>If you have any questions about ERDDAP's security system
or have any questions, doubts, concerns, or suggestions about how it is set up, 
please email <kbd>bob dot simons at noaa dot gov</kbd>.
</ul>

<!-- ******* -->
<h2><a class="selfLink" id="dontNeedToKnow" href="#dontNeedToKnow" rel="bookmark">Things You Don't Need To Know</a></h2>
These are details that you don't need to know until a need arises.
<ul>
<li><strong><a class="selfLink" id="secondErddap" href="#secondErddap" rel="bookmark">Setting Up a Second ERDDAP for Testing/Development</a></strong>  
  <br>If you want to do this, there are two approaches:
  <ul>
  <li> (Best) Install Tomcat and ERDDAP on a computer other than the computer that has your public ERDDAP.
    If you use your personal computer: 
    <ol>
    <li>Do the installation one step at a time. Get Tomcat up and running first.
      <br>When Tomcat is running, the Tomcat Manager should be at 
      <br><a rel="help" href="http://127.0.0.1:8080/manager/html/">http://127.0.0.1:8080/manager/html/</a>
    <li>Install ERDDAP.
    <li>Don't use ProxyPass to eliminate the port number from the ERDDAP URL.
    <li>In <a rel="help" href="#setup.xml">setup.xml</a>, set <kbd>baseUrl</kbd> 
      to <kbd>http://127.0.0.1:8080</kbd> 
    <li>After you start up this ERDDAP, you should be able to see it at 
      <br><a rel="help" href="http://127.0.0.1:8080/erddap">http://127.0.0.1:8080/erddap</a> 
    </ol>
  <li> <a class="selfLink" id="secondTomcat" href="#secondTomcat" rel="bookmark">(Second Best) Install another Tomcat on the same computer as your public ERDDAP.</a>
    <ol>
    <li>Do the installation one step at a time. Get Tomcat up and running first.
      <br>Change all of the port numbers associated with the second Tomcat (e.g., change 8080 to 8081)
      (see the <a rel="help" href="https://tomcat.apache.org/tomcat-8.0-doc/RUNNING.txt"
      >Multiple Tomcat Instances section<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
      halfway through that document).    
    <li>Install ERDDAP in the new Tomcat.
    <li>Don't use ProxyPass to eliminate the port number from the ERDDAP URL.
    <li>In <a rel="help" href="#setup.xml">setup.xml</a>, set <kbd>baseUrl</kbd> 
      to <kbd>http://www.<i>yourDomainName</i>:8081</kbd> 
    <li>After you start up this ERDDAP, you should be able to see it at 
      <br><kbd>http://www.<i>yourDomainName</i>:8081/erddap</kbd>
      <br>&nbsp;
    </ol>
  </ul>


<li><strong><a class="selfLink" id="SSD" href="#SSD" rel="bookmark"
>Solid State Drives (SSD's) are great!</a></strong>  
  <br>The quickest, easiest, and cheapest way to speed up ERDDAP's
    access to tabular data is to put the data files on a Solid State Drive (SSD).
    Most tabular datasets are relatively small, so a 1 or 2 TB SSD is probably
    sufficient to hold all of the data files for all of your tabular datasets.
    SSD's eventually wear out if you write data to a cell, delete it, 
    and write new data to that cell too many times.
    So if you just use your SSD to write the data once and read it many times,
    even a consumer-grade SSD should last a very long time, probably much longer
    than any Hard Disk Drive (HDD).
    Consumer-grade SSD's are now cheap (in 2018, ~$200 for 1 TB or ~$400 for 2 TB)
    and prices are still falling fast.
    When ERDDAP accesses a data file, an SSD offers both 
    <br>shorter latency (~0.1ms, versus ~3ms for an HDD, versus ~10(?)ms for a RAID, versus ~55ms for Amazon S3)
    <br>and higher throughput (~500 MB/S, versus ~75 MB/s for an HDD, versus ~500 MB/s for a RAID).
    <br>So you can get a big performance boost (up to 10X versus a HDD) for $200!
    Compared to most other possible changes to your system 
    (a new server for $10,000? a new RAID for $35,000? a new network switch for $5000? etc.),
    this is by far the best Return On Investment (ROI).
    If your server isn't loaded with memory, additional memory for your server 
    is also a great and relatively inexpensive way to speed up all aspects of ERDDAP.
    <br>[SSD's would be great for gridded data, too, but most gridded datasets are 
    much larger, making the SSD very expensive.]
    <br>&nbsp;

<li><strong><a class="selfLink" id="heavyLoads" href="#heavyLoads" rel="bookmark">Heavy Loads / Constraints</a></strong> -- 
  With heavy use, a standalone ERDDAP may be constrained by various problems. 
  For more information, see the 
    <a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/grids.html#heavyLoads">list of 
    constraints and solutions</a>.
  <br>&nbsp;
  
<li><a class="selfLink" id="grids" href="#grids" rel="bookmark"><strong>Grids, Clusters, and Federations</strong></a> -- 
  Under very heavy use, a single standalone ERDDAP will run into 
  one or more constraints and even the suggested solutions will be insufficient.  
  For such situations, ERDDAP has features that make it easy to construct scalable grids 
  (also called clusters or federations) of ERDDAPs  which allow the system to handle very heavy use
  (e.g., for a large data center). For more information, see  
    <a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/grids.html">grids, clusters, 
      and federations of ERDDAPs</a>.
  <br>&nbsp;

<li><a class="selfLink" id="cloudComputing" href="#cloudComputing" rel="bookmark"><strong>Cloud Computing</strong></a> -- 
  Several companies are starting to offer 
  <a rel="help" 
  href="https://en.wikipedia.org/wiki/Cloud_computing">cloud computing services<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> 
  (e.g., <a rel="help" href="https://aws.amazon.com/">Amazon Web Services<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>).
  <a rel="help" href="https://en.wikipedia.org/wiki/Web_hosting_service">Web hosting companies<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> 
     have offered simpler services since the mid-1990's, but the "cloud" services 
     have greatly expanded the flexibility of the systems and the range of
     services offered. 
  You can use these services to set up a single ERDDAP 
  or a grid/cluster of ERDDAPs to handle very heavy use.
  For more information, see  
  <a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/grids.html#cloudComputing">cloud 
    computing with ERDDAP</a>.
  <br>&nbsp;

<li><strong><a class="selfLink" id="amazon" href="#amazon" rel="bookmark">Amazon Web Services (AWS) EC2 Installation Overview</a></strong> -- 
  <a rel="help" href="https://aws.amazon.com/">Amazon Web Services (AWS)<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
  is a 
  <a rel="help" 
  href="https://en.wikipedia.org/wiki/Cloud_computing">cloud computing service<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
  that offers a wide range of computer infrastructure that you can rent by the hour.
  You can install ERDDAP on an 
  <a rel="help" href="https://aws.amazon.com/ec2/">Elastic Compute Cloud (EC2)<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
  instance (their name for a computer that you can rent by the hour).
  AWS has an excellent 
  <a rel="help" 
  href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/concepts.html">AWS User Guide<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
  and you can use Google to find answers to specific questions you might have.
  Brace yourself -- 
  it is a fair amount of work to get started. But once you get one server up and running, 
  you can easily rent as many additional resources (servers, databases, SSD-space, etc.)
  as you need, at a reasonable price.
  [This isn't a recommendation or endorsement of Amazon Web Services. 
  There are other cloud providers.]

  <p>An overview of things you need to do to get ERDDAP running on AWS is:
  <ul>
  <li>In general, you will do all the things described in the 
    <a rel="help" 
  href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/concepts.html">AWS User Guide<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>.
  <li>Set up an AWS account.
  <li>Set up an AWS user within that account with administrator privileges.
    Log in as this user to do all the following steps.  
  <li>Elastic Block Storage (EBS) is the AWS equivalent of a hard drive attached to 
    your server. 
    Some EBS space will be allocated when you first create an EC2 instance.
    It is persistent storage -- the information isn't lost when you stop
    your EC2 instance. And if you change instance types, your EBS space
    automatically gets attached to the new instance.
  <li>Create an Elastic IP address so that your EC2 instance has a stable,
    public URL (as opposed to just a private URL that changes every time you 
    restart your instance).
  <li>Create and start up an EC2 instance (computer). 
    There are a wide range of 
    <a rel="help" href="https://aws.amazon.com/ec2/instance-types/">instance types<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>, 
    each at a different price.
    An m4.large or m4.xlarge instance is powerful and is probably suitable 
    for most uses, but choose whatever meets your needs.   
    You will probably want to use Amazon's Linux as the operating system.
  <li>If your desktop/laptop computer is a Windows computer, you can use
    <a rel="help" 
    href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/putty.html">PuTTY<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>,
    a free SSH client for Windows, to get access to your EC2 instance's command line. 
    Or, you may have some other SSH program that you prefer.
  <li>When you log into your EC2 instance, you will be logged in as the 
    administrative user with the user name "ec2-user".
    ec2-user has sudo privileges.
    So, when you need to do something as the root user, use: <kbd>sudo <i>someCommand</i></kbd>
  <li>If your desktop/laptop computer is a Windows computer, you can use
    <a rel="help"
    href="https://stackoverflow.com/questions/16744863/connect-to-amazon-ec2-file-directory-using-filezilla-and-sftp">FileZilla<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>, 
    a free SFTP program, to transfer files
    to/from your EC2 instance. Or, you may have some other SFTP program that you prefer.
  <li><a rel="help"
  href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/install-LAMP.html">Install Apache<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> 
    on your EC2 instance.
  <li>Follow the standard <a rel="help" href="#initialSetup">ERDDAP installation instructions</a>.
    <br>&nbsp;
  </ul>

<li><strong><a class="selfLink" id="waitThenTryAgain" href="#waitThenTryAgain" rel="bookmark">WaitThenTryAgain Exception</a></strong> -- 
  In unusual circumstances, a user may get an error message like
  <kbd>
  <br>WaitThenTryAgainException: 
  <br>There was a (temporary?) problem.  Wait a minute, then try again.  
    (In a browser, click the Reload button.)
  <br>Details: GridDataAccessor.increment: partialResults[0]="123542730" was expected 
    to be "123532800". </kbd>
  <br>The explanation is: 
  For each EDDGrid dataset, ERDDAP keeps the axis variable values in memory.
  They are used, for example, to convert requested axis values that use the "()" format into index numbers. 
  For example, if the axis values are "10, 15, 20, 25", a request for (20)
  will be interpreted as a request for index #2 (0-based indices).
  When ERDDAP gets a request for data and gets the data from the source, 
  it verifies that the axis values that it got from the source match the axis values in memory.
  Normally, they do.
  But sometimes the data source has changed in a significant way:
  for example, index values from the beginning of the axis variable may have
  been removed (e.g., "10, 15, 20, 25" may have become "20, 25, 30").
  If that happens, it is clear that ERDDAP's interpretation of the request (e.g., "(20)" is index #2)
  is now wrong. So ERDDAP throws an exception and marks the dataset as needing to be reloaded.
  ERDDAP will update the dataset soon (often in a few seconds, usually within a minute).
  Other, similar problems also throw the WaitThenTryAgain exception.

  <p>Starting with ERDDAP version 1.14, it became much less likely that a user would actually see this error.
  Now, when the underlying error occurs, ERDDAP automatically internally tries to reload the dataset 
  and resubmit the request to the reloaded dataset.
  Often this succeeds. When it does, the user will simply see that a given request took a little longer 
  than usual. If it fails, the user should (as the message says) wait a minute, then try again.

<li><strong><a class="selfLink" id="filesNotBeingDeleted" href="#filesNotBeingDeleted" rel="bookmark">Files Not Being Deleted</a></strong>
  <br>For a few ERDDAP installations, there has been a problem with some temporary files 
  being created by ERDDAP staying open (mistakenly) and thus not being deleted.
  In a few cases, many of these files have accumulated and taken up a significant
  amount of disk space. 
  <p>Hopefully, these problems are fixed (as of ERDDAP v2.00). If you see this problem,
  please email the directory+names of the offending files to bob.simons at noaa.gov.
  You have a few options for dealing with the problem:
  <ul>
  <li>If the files aren't big and aren't causing you to run out of disk space, you can ignore the problem. 
  <li>The simplest solution is to shut down tomcat/erddap (after hours so fewer users are affected).
    During the shutdown, if the operating system doesn't delete the files, delete them by hand. Then restart ERDDAP.
    <br>&nbsp;
  </ul>

<li><strong><a class="selfLink" id="jsonld" href="#jsonld" rel="bookmark">Semantic Markup of Datasets with json-ld (JSON Linked Data)</a></strong>
  <br>ERDDAP now uses 
    <a rel="help" href="https://json-ld.org">json-ld (JSON Linked Data)<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> 
    to make your data catalog and datasets part of the 
    <a rel="help" href="https://en.wikipedia.org/wiki/Semantic_Web">semantic web<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>,
    which is Tim Berners-Lee's idea to make web content more machine readable and
    machine "understandable".
    Search engines  
    (<a rel="help" href="https://developers.google.com/search/docs/data-types/datasets" 
     >Google in particular<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>)
    and other semantic tools can use this structured markup 
    to facilitate discovery and indexing. 
    The json-ld structured markup appears as invisible-to-humans &lt;script&gt; code on the 
    http://.../erddap/info/index.html web page (which is a semantic web 
    <a rel="help" href="https://schema.org/DataCatalog">DataCatalog<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>) 
    and on each http://.../erddap/info/<i>datasetID</i>/index.html web page
    (which is a semantic web 
    <a rel="help" href="https://schema.org/Dataset">Dataset<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>).
    (Special thanks to Adam Leadbetter and Rob Fuller of the Marine Institute in Ireland
    for doing the hard parts of the work to make this part of ERDDAP.)
    <br>&nbsp;

  <!-- INACTIVE JAVASCRIPT APPROACH:
  <p>Markup is implemented javascript code which is executed on the erddap
   server, giving you the flexibility to design as you best see fit.
   To see the json-ld markup, view the source on the 
   <a href="../info/index.html">info/index.html</a> page and on the 
   info/index.html page for each dataset. 
  <p>You can check your implementation by submitting the index 
  pages to  
  <a rel="help" href="https://search.google.com/structured-data/testing-tool"
  >Google's structured data testing tool<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>.
  Finally when done you can submit your info/index.html pages to the search
  engines in the usual way.
  -->

<li><strong><a class="selfLink" id="updateUrls" href="#updateUrls" rel="bookmark"
  >Out-Of-Date URLs</a></strong>
  <br>Slowly but surely, the URLs that data providers have written into data files
  are becoming out-of-date (for example, http becomes https, websites are rearranged,
  and organizations like NODC/NGDC/NCDC are reorganized into NCEI). 
  The resulting broken links are an ever-present problem faced by all websites.
  To deal with this,
  ERDDAP now has a system to automatically update out-of-date URLs.
  If GenerateDatasetsXml sees an out-of-date URL, 
  it adds the up-to-date URL to &lt;addAttributes&gt;.
  Also, when a dataset loads, if ERDDAP sees an out-of-date URL,
  it silently changes it to the up-to-date URL.
  The changes are controlled by a series of search-for/replace-with
  pairs defined in &lt;updateUrls&gt; in messages.xml.
  You can make changes there.
  If you have suggestions for changes,  
  or if you think this should be turned into a service (like the Converters),
  please email bob.simons at noaa.gov.
  <br>&nbsp;

<li><strong><a class="selfLink" id="CORS" href="#CORS" rel="bookmark">CORS</a></strong>
(<a rel="help" href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing"
  >Cross-Origin Resource Sharing<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>) 
"is a mechanism that allows restricted resources (e.g. fonts [or ERDDAP data]) 
on a web page to be requested from another domain outside the domain from 
which the first resource was served"
(Arun Ranganathan).
Basically, CORS is a message that can be put in the HTTP header of a response,
saying essentially, "it is okay with this site if certain other sites 
(specific ones, or all) grab resources 
(e.g., data) from this site and make it available on their site".
Thus, it is an alternative to 
<a rel="help" href="https://en.wikipedia.org/wiki/JSONP"
  >JSONP<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>.

<p>The developers of ERDDAP do not claim to be security experts. 
We are not entirely clear about the security issues related to CORS.
We don't want to make any statement endorsing an action that decreases security.
So we'll just stay neutral and leave it up to each ERDDAP admin to decide if the 
benefits or enabling a CORS header are worth the risks.  
As always, if your ERDDAP has any private datasets, 
it's a good idea to be extra careful about security.

<p>If you want to enable CORS for your ERDDAP, there are 
<a rel="help" href="https://enable-cors.org/index.html"
  >readily available instructions<img 
  src="../images/external.png" alt=" (external link)" 
  title="This link to an external website does not constitute an endorsement."></a>
describing how website administrators can enable a CORS header 
via their lower level server software (e.g., Apache or nginx). 
<!--That said, we may make it easier for ERDDAP admins to enable a CORS HTTP header
via a setting in setup.xml in a future version of ERDDAP.-->


<li><strong><a class="selfLink" id="palettes" href="#palettes" rel="bookmark">Palettes</a></strong>
are used by ERDDAP to convert a range of data values into a range of colors
when making graphs and maps. 

  <p>Each palette is defined in a .cpt-style palette file as used by 
  <a rel="help" href="https://gmt.soest.hawaii.edu/">GMT<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>.  
  All ERDDAP .cpt files are valid GMT .cpt files, but the opposite is not true.
  For use in ERDDAP, .cpt files have:
  <ul>
  <li>Optional comments lines at the start of the file, starting with "#".
  <li>A main section with a description of the segments of the palette, one segment per line.
    Each segment description line has 8 values:
    <br>startValue, startRed, startGreen, startBlue, endValue, endRed, endGreen, endBlue.
    <br>There may be any number of segments.
    ERDDAP uses linear interpolation between the startRed/Green/Blue and endRed/Green/Blue
    of each segment.
    <p>We recommend that each segment specify a start and end color which are different,
    and that the start color of each segment be the same as the end color of the
    previous segment, so that the palette describes a continuous blend of colors. 
    ERDDAP has a system for creating on-the-fly a palette of discrete colors 
    from a palette with a continuous blend of colors.
    An ERDDAP user can specify if they want the palette to be Continuous (the original) 
    or Discrete (derived from the original).
    But there are legitimate reasons for not following these recommendations for some palettes.
  <li>The startValue and endValues must be integers.
      <br>The first segment must have startValue=0 and endValue=1.
      <br>The second segment must have  startValue=1 and endValue=2.
      <br>Etc.
  <li>The red, green, and blue values must be integers from 0 (none) ... 255 (full on).
  <li>The end of the file must have 3 lines with:
    <ol>
    <li>A background rgb color for data values less than the colorbar minimum, e.g.: B 128 128 128
      <br>It is often the startRed, startGreen, and startBlue of the first segment.
    <li>A foreground rgb color for data values more than the colorbar maximum, e.g.: F 128   0   0
      <br>It is often the endRed, endGreen, and endBlue of the last segment.
    <li>An rgb color for NaN data values, e.g., N  128  128  128
      <br>It is often middle gray (128 128 128).
    </ol>
  <li>The values on each line must be separated by tabs, with no extraneous spaces.
  </ul>
  <p>A sample .cpt file is BlueWhiteRed.cpt:
<pre>
# This is BlueWhiteRed.cpt.
0  0    0    128  1  0    0    255
1  0    0    255  2  0    255  255
2  0    255  255  3  255  255  255
3  255  255  255  4  255  255  0
4  255  255  0    5  255  0    0
5  255  0    0    6  128  0    0
B  0    0    128
F  128  0    0
N  128  128  128
</pre>
  See the existing .cpt files for other examples. 
  If there is trouble with a .cpt file, ERDDAP will probably throw an error when the .cpt file is parsed 
  (which is better than misusing the information).

  <p>You can add additional palettes to ERDDAP. 
  You can make them yourself or find them on the web (for example, at 
  <a rel="help" href="http://soliton.vm.bytemark.co.uk/pub/cpt-city/">cpt-city<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>)
  although you'll probably have to edit their format slightly to conform to 
  ERDDAP's .cpt requirements.
  To get ERDDAP to use a new .cpt file, store the file in 
  <i>tomcat</i>/webapps/erddap/WEB-INF/cptfiles
  (you'll need to do that for each new version of ERDDAP)
  and either:
  <ul>
  <li>If you use the default messages.xml file: add the filename to the &lt;palettes&gt; tag in
    <br><i>tomcat</i>/webapps/erddap/WEB-INF/classes/gov/noaa/pfel/erddap/util/messages.xml.
    <br>If you do this, you need to do it every time you upgrade ERDDAP.
  <li>If you use a custom messages.xml file: add the filename to the &lt;palettes&gt; tag 
    in your custom messages.xml file: 
    <i>tomcat</i>/content/erddap/messages.xml .
    If you do this, you only need to do it once (but there is other work to maintain a custom messages.xml file).   
  </ul>  
  Then restart ERDDAP so ERDDAP notices the changes.
  An advantage of this approach is that you can specify the order of the palettes in the list 
  presented to users.
  If you add a collection, we encourage you to add a prefix with the authors initials (e.g., "KT_") 
  to the name of each palette to identify the collection and so that there can be multiple
  palettes which would otherwise have the same name. 

  <p>Please don't remove or change any of the standard palettes. 
  They are a standard feature of all ERDDAP installations.
  If you think a palette or collection of palettes should be included in the 
  standard ERDDAP distribution because it/they would be of general use, 
  please email them to bob.simons at noaa.gov.
  <br>&nbsp;

<li><strong><a class="selfLink" id="colorbars" href="#colorbars" rel="bookmark">How does ERDDAP generate the colors in a colorbar?</a></strong>
  <ol>
  <li>The user selects one of the predefined <a rel="help" href="#palettes">palettes</a> or uses the default,
    e.g., Rainbow.  Palettes are stored/defined in GMT-style .cpt Color Palette Table files.  
    Each of ERDDAP's predefined palettes has a simple integer range, 
    e.g., 0 to 1 (if there is just one section in the palette), 
    or 0 to 4 (if there are four sections in the palette).
    Each segment in the file covers n to n+1, starting at n=0.
  <li>ERDDAP generates a new .cpt file on-the-fly, by scaling the predefined palette's range
    (e.g., 0 to 4) to the range of the palette needed by the
    user (e.g., 0.1 to 50) and then generating a section in the 
    new palette for each section of the new palette 
    (e.g., a log scale with ticks at 0.1, 0.5, 1, 5, 10, 50 will have 5 sections).
    The color for the end point of each section is generated by finding the relevant section of the
    palette in the .cpt file, then linearly interpolating the R, G, and B values.
    (That's the same as how GMT generates colors from its Color Palette Table files.)
    This system allows ERDDAP to start with generic palettes 
    (e.g., Rainbow with 8 segments, in total spanning 0 to 8)
    and create custom palettes on-the-fly
    (e.g., a custom Rainbow, which maps 0.1 to 50 mg/L to the rainbow colors).
  <li>ERDDAP then uses that new .cpt file to generate the color for each different colored pixel 
    in the color bar
    (and later for each data point when plotting data on a graph or map),
    again by finding the relevant section of the
    palette in the .cpt file, then linearly interpolating the R, G, and B values.    
  </ol>
  This process may seem unnecessarily complicated. But it solves problems
  related to log scales that are hard to solve other ways.

  <p>So how can you mimic what ERDDAP is doing?  That isn't easy.
  Basically you need to duplicate the process that ERDDAP is using.
  If you are a Java programmer, you can use the same Java class that ERDDAP uses to do all of this: 
  <br><i>tomcat</i>/webapps/erddap/WEB-INF/classes/gov/noaa/pfel/coastwatch/sgt/CompoundColorMap.java.


<li><strong><a class="selfLink" id="dataDistribution" href="#dataDistribution" rel="bookmark">Guidelines for Data Distribution Systems</a></strong> 
  -- More general opinions about the design and evaluation 
  of data distribution systems can be found  
  <a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/images/erddapTalk/erdData.html">here</a>.
  <br>&nbsp;

<li><strong><a class="selfLink" id="ArchiveADataset" href="#ArchiveADataset" rel="bookmark">ArchiveADataset</a></strong>  
  -- Included in your ERDDAP installation is a command line tool called ArchiveADataset
  which can help you make an archive (a .zip or .tar.gz file) with part or all of a dataset
  stored in a series of netcdf-3 .nc data files in a file format that is suitable for 
  submission to NOAA's NCEI archive (.nc for gridded datasets or 
  <a rel="help"
href="https://coastwatch.pfeg.noaa.gov/erddap/tabledap/documentation.html#ncCFMA">.ncCFMA</a>    
  for tabular datasets, as specified by the 
  <a rel="help"
href="https://www.nodc.noaa.gov/data/formats/netcdf/v2.0/">NCEI NetCDF Templates v2.0<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>).

  <p>ArchiveADataset can make two different archive formats:
  <ul>

  <li>The "original" format follows these 
    <a rel="help"
href="https://www.ncdc.noaa.gov/atrac/guidelines.html">NCEI Archiving Guidelines<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>,
    this guide for 
    <a rel="help"
href="https://sites.google.com/a/noaa.gov/ncei-ioos-archive/cookbook?pli=1">Archiving
Your Data at NCEI<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>,
     and the related
    <a rel="help"
href="https://sites.google.com/a/noaa.gov/ncei-ioos-archive/cookbook/data-integrity">Practices
for Ensuring Data Integrity<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>.

  <li>The "BagIt" format makes 
    <a rel="help"
href="https://en.wikipedia.org/wiki/BagIt">BagIt files<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>,
    a standardized archive format promoted by the U.S. Library of Congress,
    as specified by the 
    <a rel="help"
href="https://tools.ietf.org/html/draft-kunze-bagit-14">BagIt v0.97 specification<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>.
    NOAA's NCEI may standardize on BagIt files for submissions to the archive.

  </ul>
  Not surprisingly, the 
  <a rel="help" 
  href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#globalAttributes"
  >global and variable metadata</a> 
  that ERDDAP encourages/requires is almost exactly the same in-file 
  CF and ACDD metadata that NCEI encourages/requires,
  so all of your datasets should be ready for submission to NCEI via
  <a rel="bookmark" href="https://www.nodc.noaa.gov/s2n/">Send2NCEI<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
  or 
  <a rel="bookmark" href="https://www.ncdc.noaa.gov/atrac/index.html">ATRAC<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
    (NCEI's Advanced Tracking and Resource tool for Archive Collections).
  
  <p>If you (the ERDDAP administrator) use ArchiveADataset to submit data to NCEI,
  then you (not NCEI) will determine when to submit a chunk of data to NCEI 
  and what that chunk will be, because you will know when there is new
  data and how to specify that chunk (and NCEI won't). Thus, ArchiveADataset
  is a tool for you to use to create a package to submit to NCEI.
  
  <p>ArchiveADataset may be useful in other situations,
  for example, for ERDDAP administrators who need to convert a subset of a dataset
  (on a private ERDDAP) from its native file format into a set of 
  <a rel="help"
href="https://coastwatch.pfeg.noaa.gov/erddap/tabledap/documentation.html#ncCFMA">.ncCF files</a>,
  so that a public ERDDAP can 
  serve the data from the .ncCF files instead of the original files.

  <p>Once you have set up ERDDAP and run it (at least one time), 
  you can find and use ArchiveADataset in the 
  <i>tomcat</i>/webapps/erddap/WEB-INF directory. 
  There is a shell script (ArchiveADataset.sh) for Linux/Unix 
  and a batch file (ArchiveADataset.bat) for Windows. 
  When you run ArchiveADataset, it will ask you a series of questions. 
  For each question, type a response, then press Enter. 
  Or press ^C to exit a program at any time.

  <p>Or, you can put the answers to the questions, in order, on the command line.
  To do this, run the program once and type in and write down your answers.
  Then, you can create a single command line (with the answers as parameters) which 
  runs the program and answers all the questions.
  <br>Use the word <kbd>default</kbd> if you want to use the default value for a given parameter.
  <br>Use "" (two double quotes) as a placeholder for an empty string.
  <br>Specifying parameters on the command line can be very convenient, for example, 
  if you use ArchiveADataset once a month to 
  archive a month's worth of data. Once you have generated the command line 
  with parameters and saved that in your notes or in a shell script, 
  you just need to make small changes each month to make that month's archive.

  <p>The questions that ArchiveADataset asks allow you to:
  <ul>
  <li>Specify <kbd>original</kbd> or <kbd>Bagit</kbd> file packaging.
    For NCEI, use <kbd>Bagit</kbd>.
  <li>Specify <kbd>zip</kbd> or <kbd>tar.gz</kbd> compression for the package.
    For NCEI, use <kbd>tar.gz</kbd>.
  <li>Specify a contact email address for this archive
    (it will be written in the READ_ME.txt file in the archive).
  <li>Specify the datasetID of the dataset you want to archive.
  <li>Specify which data variables you want to archive (usually all).
  <li>Specify which subset of the dataset you want to archive.
    You need to format the subset in the same way you would format 
    a subset for a data request,
    so it will be different for gridded 
    than for tabular datasets.
    <ul>
    <li>For gridded datasets, you can specify a range of values of the leftmost dimension,
      usually that is a range of time. ArchiveADataset will make a separate
      request and generate a separate data file for each value in the range of values. 
      Since gridded datasets are usually large, you will almost always have to specify 
      a small subset relative to the size of the entire dataset.
      <br>For example, <kbd>[(2015-12-01):(2015-12-31)][][][]</kbd> 
    <li>For tabular datasets, you can specify any collection of constraints, but
      it is often a range of time.
      Since tabular datasets are usually small, it is often possible to specify 
      no constraints, so that the entire dataset is archived.
      <br>For example, <kbd>&amp;time&gt;=2015-12-01&amp;time&lt;2016-01-01</kbd>
    </ul>
  <li>For tabular datasets: specify a comma separated list of 0 or more variables 
    that will determine 
    how the archived data is further subsetted into different data files.
    For datasets that have
    <br><a rel="help" 
    href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#cdm_data_type"
    ><kbd>cdm_data_type</kbd></a><kbd>=TimeSeries|TimeSeriesProfile|Trajectory|TrajectoryProfile</kbd>
    <br>you should almost always specify the variable that has the 
    <kbd>cf_role=timeseries_id</kbd> (e.g., stationID) 
    or <kbd>cf_role=trajectory_id</kbd> attribute.
    ArchiveADataset will make a separate request and generate a separate
    data file for each combination of the values of these variables,
    e.g., for each stationID.
    <br>For all other tabular datasets, you will probably not specify any variables
    for this purpose. 
    <br>Warning: If the subset of the dataset you are archiving is very large (&gt;2GB) 
    and there is no suitable variable for this purpose,
    then ArchiveADataset is not usable with this dataset. This should be rare.
  <li>Specify the file format for the data files that will be created.
    <br>For gridded datasets, for NCEI, use <kbd>.nc</kbd> .
    <br>For tabular datasets, for NCEI, use 
      <a rel="help"
      href="https://coastwatch.pfeg.noaa.gov/erddap/tabledap/documentation.html#ncCFMA"
      ><kbd>.ncCFMA</kbd></a> if it is an option; otherwise use <kbd>.nc</kbd>.    
  <li>Specify the type of file digest 
    to be created for each data file and 
    for the entire archive package: <kbd>MD5, SHA-1,</kbd> or <kbd>SHA-256</kbd>.  
    The file digest provides a way for the client (e.g., NCEI) 
    to test whether the data file has become corrupted. 
    Traditionally, these were 
    <a rel="bookmark" href="https://en.wikipedia.org/wiki/MD5">.md5 files<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>,
    but now there are better options.
    For NCEI, use <kbd>SHA-256</kbd> .
  </ul>

  <p>After you answer all of the questions, ArchiveADataset will:
  <ol>
  <li>Make a series of requests to the dataset and stage the resulting data files in
      <i>bigParentDirectory</i>/ArchiveADataset/<i>datasetID_timestamp</i>/. 
    <br>For gridded datasets, there will be a file for each value of the leftmost dimension
      (e.g., time). The name of the file will be that value (e.g., the time value).
    <br>For tabular datasets, there will be a file for each value of the
      ... variable(s). The name of the file will be that value.
      If there is more than one variable, the left variables will be used
      to make subdirectory names, and the rightmost variable will be used
      to make the filenames.
    <br>Each data file must be &lt;2GB (the maximum allowed by .nc version 3 files).
  <li>Make a file related to each data file with the digest of the data file.
    For example, if the data file is 46088.nc and the digest type is .sha256, 
    then the digest file will have the name 46088.nc.sha256 .
  <li>Make a READ_ME.txt file with information about the archive,
    including a list of all the settings you specified to generate this archive.
  <li>Make 3 files in <i>bigParentDirectory</i>/ArchiveADataset/ :
    <ul>
    <li>A .zip or .tar.gz archive file named <i>datasetID_timestamp</i>.zip (or .tar.gz)
      containing all of the staged data files and digest files.
      This file may be any size, limited only by disk space.
    <li>A digest file for the archive file, for example,
      <i>datasetID_timestamp</i>.zip.sha256.txt
    <li>For the "original" type of archive, a text file named
      <i>datasetID_timestamp</i>.zip.listOfFiles.txt (or .tar.gz)
      which lists all of the files in the .zip (or .tar.gz) file.
    </ul>
    If you are preparing the archive for NCEI, these are the files that you will send to 
    NCEI, perhaps via 
    <a rel="bookmark" href="https://www.nodc.noaa.gov/s2n/">Send2NCEI<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
    or 
    <a rel="bookmark" href="https://www.ncdc.noaa.gov/atrac/index.html">ATRAC<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
    (NCEI's Advanced Tracking and Resource tool for Archive Collections).
  <li>Delete all of the staged files so that only the archive file (e.g., .zip), 
    the digest (e.g., .sha256.txt) of the archive, 
    and (optionally) the .listOfFiles.txt files remain.
  </ol>

  <p><a class="selfLink" id="ArchiveADatasetISO19115" href="#ArchiveADatasetISO19115" rel="bookmark">ISO 19115 .xml Metadata Files</a> -- 
  <br>The ArchiveADataset archive package does not include the 
  ISO 19115 .xml metadata file for the dataset. If you want/need to submit
  an ISO 19115 file for your dataset to NCEI, you can send them
  the ISO 19115 .xml metadata file that ERDDAP created for the dataset 
  (but NMFS people should get the ISO 19115 file for their datasets 
  from InPort if ERDDAP isn't already serving that file).
  
  <p>Problems? Suggestions? ArchiveADataset is new. If you have problems or suggestions,
    please email them to <kbd>bob dot simons at noaa dot gov</kbd> .
  <br>&nbsp;

</ul>

<!-- ******* -->
<h2><a class="selfLink" id="slideShows" href="#slideShows" rel="bookmark">Slide Shows</a></h2>

Here are some PowerPoint slide shows and documents that Bob Simons has created 
related to ERDDAP.
<p><strong>DISCLAIMER: The content and opinions expressed in these documents 
are Bob Simons' personal opinions and 
do not necessarily reflect any position of the 
Government or the National Oceanic and Atmospheric Administration.</strong>

<p>The Three Main Documents:
<ul>
<li><a rel="help" 
  href="https://coastwatch.pfeg.noaa.gov/erddap/images/erddapTalk/erddapTalk5.pptx"
  >The main introduction to ERDDAP (version 5)</a>.
  You can also 
  <a rel="help" 
  href="https://www.youtube.com/watch?v=H541G1XXZrU&amp;t=4"
  >watch this video of Bob giving this talk<img 
  src="../images/external.png" alt=" (external link)" 
  title="This is a link to an external website."/></a>.
<li><a rel="help" 
  href="https://coastwatch.pfeg.noaa.gov/erddap/download/grids.html"
  >ERDDAP: Heavy Loads, Grids, Clusters, Federations, and Cloud Computing</a>
<li><a rel="help" 
  href="https://coastwatch.pfeg.noaa.gov/erddap/images/erddapTalk/erdData.html"
  >Bob's Guidelines for Data Distribution Systems</a>
</ul>

<p>Other Presentations:
<ul>
<li><a rel="help" 
  href="https://coastwatch.pfeg.noaa.gov/erddap/images/erddapTalk/Erddapv2Features.pptx"
  >2019 IOOS DMAC: New Features in ERDDAP v2.0</a>

<li><a rel="help" 
  href="https://coastwatch.pfeg.noaa.gov/erddap/images/erddapTalk/SimonsErddapSubset2018.pptx"
  >2018 Summer ESIP: Subsetting In ERDDAP</a>

<li><a rel="help" 
  href="https://coastwatch.pfeg.noaa.gov/erddap/images/erddapTalk/SimonsErddapJson2018.pptx"
  >2018 Summer ESIP: JSON Support In ERDDAP</a>

<li><a rel="help" 
  href="https://coastwatch.pfeg.noaa.gov/erddap/images/erddapTalk/10P.04_Simons_DistributedWebServices2018.pptx"
  >2018 EDM: A Distributed System of Web Services (Faster, Easier, Less Expensive) (Or, why I was happy 4 years ago.)</a>

<li><a rel="help" 
  href="https://coastwatch.pfeg.noaa.gov/erddap/images/erddapTalk/7A4_Simons_ErddapSession2018.pptx"
  >2018 EDM: ERDDAP in 2018</a>

<li><a rel="help" 
  href="https://coastwatch.pfeg.noaa.gov/erddap/images/erddapTalk/4D4_Simons_ErddapMediaFiles2018.pptx"
  >2018 EDM: New Features in ERDDAP for Image, Audio, and Video Data</a>

<li><a rel="help" 
  href="https://coastwatch.pfeg.noaa.gov/erddap/images/erddapTalk/3D3_Simons_DataIntegration2018.pptx"
  >2018 EDM: UAF and ERDDAP Solutions for Data Integration</a>

<li><a rel="help" 
  href="https://coastwatch.pfeg.noaa.gov/erddap/images/erddapTalk/ErddapIntro.pptx"
  >2017 EDM: A Quick Introduction to ERDDAP</a>

<li><a rel="help" 
  href="https://coastwatch.pfeg.noaa.gov/erddap/images/erddapTalk/ErddapUserFeatures2017.pptx"
  >2017 EDM and 2017 IOOS: New or Little Known ERDDAP Features (for Users) </a>

<li><a rel="help" 
  href="https://coastwatch.pfeg.noaa.gov/erddap/images/erddapTalk/ErddapAdminFeatures2017.pptx"
  >2017 EDM and 2017 IOOS: New or Little Known ERDDAP Features (for Administrators) </a>

<li><a rel="help" 
  href="https://coastwatch.pfeg.noaa.gov/erddap/images/erddapTalk/eml_knb_erddap.pptx"
  >2017 EDM: EML, KNB, and ERDDAP</a>

<li><a rel="help" 
  href="https://coastwatch.pfeg.noaa.gov/erddap/images/erddapTalk/OldSchoolNewSchool.pptx"
  >2017 EDM: How does data get from the source to the end user? Old School versus New School</a>

<li><a rel="help" 
  href="https://coastwatch.pfeg.noaa.gov/erddap/images/erddapTalk/TheBigPicture.pptx"
  >2016 Summer ESIP: The Big Picture: PARR, OPeNDAP, ERDDAP, and Data Distribution</a>

<li><a rel="help" 
  href="https://coastwatch.pfeg.noaa.gov/erddap/images/erddapTalk/OneAndDone.pptx"
  >2016 EDM: One And Done</a>

<li><a rel="help" 
  href="https://coastwatch.pfeg.noaa.gov/erddap/images/erddapTalk/NextGeneration.pptx"
  >2016 Gov API: Next Generation Data Servers</a> 

<li><a rel="help"
  href="https://coastwatch.pfeg.noaa.gov/erddap/images/erddapTalk/TabularAggregation.pptx"
  >2015 Summer ESIP: Tabular Aggregation</a>

<li><a rel="help"
  href="https://coastwatch.pfeg.noaa.gov/erddap/images/erddapTalk/SimonsDosDontsTabular.pptx"
  >2014 EDM: Bob's Do's and Don't for Tabular Data</a>

<li><a rel="help"
  href="https://coastwatch.pfeg.noaa.gov/erddap/images/erddapTalk/TheIdealUserInterface.pptx"
  >2014 EDM: The Ideal User Interface</a>

<li><a rel="help"
  href="https://coastwatch.pfeg.noaa.gov/erddap/images/erddapTalk/TabularData.pptx"
  >2014 Summer ESIP: Tabular Data</a>

<li><a rel="help"
  href="https://coastwatch.pfeg.noaa.gov/erddap/images/erddapTalk/DoMoreWithLess.ppt"
  >2013 EDM: Do More With Less</a>

<li><a rel="help"
  href="https://coastwatch.pfeg.noaa.gov/erddap/images/erddapTalk/guidelines3.ppt"
  >2012 EDM: Guidelines for Data Distribution Systems</a>
</ul>

<p>Presentations By Other People:
<ul>
<li><a rel="help"
  href="https://www.youtube.com/watch?v=MF-WH01Qw0g"
  >Building Your Own Weather App Using NOAA Open Data and Jupyter Notebooks<img 
  style="vertical-align:middle" alt="YouTube" src="../images/youtube.png" ><img 
  src="../images/external.png" alt=" (external link)" 
  title="This is a link to an external website."/></a>
  <br>by Filipe Fernandes and Rich Signell at SciPy 2018, July 13, 2018. 

<li><a rel="help"
  href="https://www.youtube.com/watch?v=tj4M9hodTG0"
  >Using the OOI ERDDAP<img 
  style="vertical-align:middle" alt="YouTube" src="../images/youtube.png" ><img 
  src="../images/external.png" alt=" (external link)" 
  title="This is a link to an external website."/></a>
  <br>by Rich Signell, February 2018. 

<li><a rel="help"
  href="https://youtu.be/2-ydBByYB0M?t=160"
  >ESIP Tech Dive: "ERDDAP Lightning Talks"<img 
  style="vertical-align:middle" alt="YouTube" src="../images/youtube.png" ><img 
  src="../images/external.png" alt=" (external link)" 
  title="This is a link to an external website."/></a>
  <br>Eight 5-Minute Talks About Interesting Things People Are Doing With ERDDAP
  by Jenn Sevadjian, Jim Potemra, Conor Delaney, Kevin O'Brien, John Kerfoot, 
  Stephanie Petillo, Charles Carleton and Eli Hunter presented as an ESIP Tech Dive
  on August 31, 2017.

<li><a rel="help"
  href="https://www.youtube.com/watch?v=_BwMHRh7CS8"
  >Using ERDDAP to Access Tabular Data<img 
  style="vertical-align:middle" alt="YouTube" src="../images/youtube.png" ><img 
  src="../images/external.png" alt=" (external link)" 
  title="This is a link to an external website."/></a>
  <br>by Rich Signell, August 2015. 

<li><a rel="help"
  href="https://www.youtube.com/watch?v=TbOhElC_-qU"
  >Test Using ERDDAP for Blue Carbon Data<img 
  style="vertical-align:middle" alt="YouTube" src="../images/youtube.png" ><img 
  src="../images/external.png" alt=" (external link)" 
  title="This is a link to an external website."/></a>
  <br>by Rich Signell, August 2015. 

<li><a rel="help" href="https://www.youtube.com/watch?v=18xZoXu1USM"
  >Using Data From ERDDAP in NOAA's GNOME Software<img 
  style="vertical-align:middle" alt="YouTube" src="../images/youtube.png" ><img
    src="../images/external.png" alt=" (external link)" 
    title="This link to an external website does not constitute an endorsement."></a>. 
  <br>In this video, Rich Signell downloads ocean currents forecast data from ERDDAP to model a toxic
  spill in the ocean using  
  <a rel="bookmark" 
    href="https://response.restoration.noaa.gov/oil-and-chemical-spills/oil-spills/response-tools/gnome.html"
    >NOAA's GNOME software<img 
    src="../images/external.png" alt=" (external link)" 
    title="This link to an external website does not constitute an endorsement."></a> (in 5 minutes!).
  (One tiny error in the video: 
  when searching for datasets, don't use <kbd>AND</kbd> between search terms. It is implicit.)
  By Rich Signell, April 8, 2011.


</ul>

<br>&nbsp;

<!-- ******* -->
<h2><a class="selfLink" id="programmersGuide" href="#programmersGuide" rel="bookmark">Programmer's Guide</a></h2>
These are things that only a programmer who intends to work with ERDDAP's Java classes needs to know.
<ul>

<li><strong><a class="selfLink" id="sourceCode" href="#sourceCode" rel="bookmark">Source Code</a></strong> 
  <ul>
  <li>The source code for the current version of ERDDAP is always in the current erddap.war file.
    So when you install ERDDAP in tomcat, all of the source code is unpacked
    and installed on the server. If you just want to read the source code,
    this is the easiest option.
  <li>The source code for recent public versions and in-development versions 
    is also available via <a rel="help" href="https://github.com/BobSimons">GitHub<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>.
    Please read the <a rel="help" href="https://github.com/BobSimons/erddap/wiki">Wiki<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> 
    for that project. 
    If you want to modify the source code (and possibly have the changes incorporated
    into the standard ERDDAP distribution), this is the recommended approach.
  <li>ERDDAP and its subcomponents have very liberal, open-source <a rel="license" href="#license">licenses</a>,
    so you can use and modify the source code for any purpose, for-profit or not-for-profit.
    Note that ERDDAP and many subcomponents have licenses that require that you 
    acknowledge the source of the code that you are using. See
    <a rel="license" href="#credits">Credits</a>. Whether required or not, it is just
    good form to acknowledge all of these contributors.
    <br>&nbsp;
  </ul>

<li><strong><a class="selfLink" id="useTheCode" href="#useTheCode" rel="bookmark">Use the Code for Other Projects</a></strong> 
  While you are welcome to use parts of the ERDDAP code for other projects, 
  be warned that the code can and will change.   
  We don't promise to support other uses of our code. 
  Git and GitHub will be your main solutions for dealing with this -- 
  Git allows you to merge our changes into your changes. 

  <p><strong>For many situations where you might be tempted to use parts of ERDDAP in your project, 
  we think you will find it much easier to install and use ERDDAP as is,</strong>
  and then write other services which use ERDDAP's services.
  You can set up your own ERDDAP installation crudely in an hour or two.
  You can set up your own ERDDAP installation in a polished way in a few days 
  (depending on the number and complexity of your datasets).
  But hacking out parts of ERDDAP for your own project is likely to take weeks 
  (and months to catch subtleties) and you will lose the ability to 
  incorporate changes and bug fixes from subsequent ERDDAP releases.
  We (obviously) think there are many benefits to using ERDDAP as is and making 
  your ERDDAP installation publicly accessible.
  However, in some circumstances, you might not want to make your ERDDAP
  installation publicly accessible.
  Then, your service can access and use your private ERDDAP and your clients 
  needn't know about ERDDAP.

  <p><strong><a class="selfLink" id="halfWay" href="#halfWay" rel="bookmark">Halfway</a></strong> -- 
  Or, there is another approach which you may find useful 
  which is halfway between delving into ERDDAP's code and using ERDDAP as a 
  stand-alone web service:
  In the EDD class, there is a static method which lets you make an instance of a dataset 
  (based on the specification in datasets.xml): 
  <br><kbd>oneFromDatasetXml(String tDatasetID)</kbd>
  <br>It returns an instance of an EDDTable or EDDGrid dataset.
  Given that instance, you can call 
  <br><kbd>makeNewFileForDapQuery(String userDapQuery, String dir, 
  String fileName, String fileTypeName)</kbd>
  <br>to tell the instance to make a data file, of a specific fileType, with 
  the results from a user query.
  Thus, this is a simple way to use ERDDAP's methods to request data and get a
  file in response, just as a client would use the ERDDAP web application.
  But this approach works within your Java program and bypasses the need for an 
  application server like Tomcat.
  We use this approach for many of the unit tests of EDDTable and EDDGrid subclasses,
  so you can see examples of this in the source code for all of those classes.

<li><strong><a class="selfLink" id="developmentEnvironment" href="#developmentEnvironment" rel="bookmark">Development Environment</a></strong>
  <ul>
  <li>Directory Structure 
    <ul>
    <li>If you are installing ERDDAP in a Tomcat (whether or not you will
      actually use it that way), follow the instructions above.
    <li>If you aren't installing ERDDAP in a Tomcat, you still need to make a
      Tomcat-like directory structure,
      so that ERDDAP can find the setup files in <i>tomcat</i>/content/erddap .
      <ul>
      <li>Make a directory somewhere called "tomcat" (it can be something else,
        but this is easier to explain).
      <li>As indicated above, unzip erddapContent.zip into <i>tomcat</i>, creating <i>tomcat</i>/content/erddap .
        Follow the instructions above to modify 
        <a rel="help" href="#setup.xml">setup.xml</a> and datasets.xml.
        Depending on your situation, you may need to specify that directory by 
        adding something like
        <br><kbd>-DErddapContentDirectory="<i>/someDirectory/content/erddap/</i>"</kbd>  
        <br>to the Java command line for your program.
      <li>Make a <i>tomcat</i>/webapps/erddap directory.
      <li>.war files are just .zip files that follow a few additional conventions.
        So you can use an unzip program to unzip erddap.war into
        <i>tomcat</i>/webapps/erddap .
        That has all of ERDDAP's .java classes and many other files.
      </ul>
    </ul>
  <li>Our development environment is just a programmer's editor (we're not saying which one).
    (No, we don't use Eclipse, Ant, Maven, or ...; nor do we offer ERDDAP-related support for them.
    If we required you to use Ant and you preferred Maven (or vice versa), you wouldn't be very happy about it.)
  <li>We use a batch file which deletes all of the .class files in the source tree.
  <li>We currently use AdoptOpenJDK's javac jdk8u202-b08 <!-- javaVersion --> to compile gov.noaa.pfeg.coastwatch.TestAll  
     (it has links to a few classes that wouldn't be compiled otherwise) 
     and AdoptOpenJDK's java jdk8u202-b08 <!-- javaVersion --> to run the tests.  
     For security reasons, it is almost always best to use the latest versions of Java 8 and Tomcat 8. <!-- javaVersion -->
     <ul>
     <li>When we run javac or java, the current directory is <i>tomcat</i>/webapps/erddap/WEB-INF .
     <li><a class="selfLink" id="classpath" href="#classpath" rel="bookmark">Our javac and java classpath</a> (including some unnecessary items) is currently
       <!-- Bob: don't forget to update the classpath in the .bat/shell script files in WEB-INF. -->
       <br><kbd>
./classes;../../../lib/servlet-api.jar;lib/cassandra-driver-core.jar;lib/netty-all.jar;lib/guava.jar;lib/metrics-core.jar;lib/lz4.jar;lib/snappy-java.jar;lib/commons-compress.jar;lib/itext-1.3.1.jar;lib/lucene-core.jar;lib/mail.jar;lib/netcdfAll-latest.jar;lib/slf4j.jar;lib/postgresql.jdbc.jar;</kbd>
       <br>If you get error messages about classes not found
         when you compile or run ERDDAP or one of its tools, 
         compare your command line's classpath to the classpath above
         to figure out which .jars are missing from your classpath.
     <li>So your javac command line will be something like
       <br><kbd>javac -cp (classpath above) classes/gov/noaa/pfel/coastwatch/TestAll.java</kbd>
     <li>And your java command line will be something like
       <br><kbd>java -cp (classpath above) -Xmx1200M -Xms1200M classes/gov/noaa/pfel/coastwatch/TestAll</kbd>
       <br>Optional: you can add <kbd>-verbose:gc</kbd>. It tells Java to print garbage collection 
       statistics.
     <li>If TestAll compiles, everything ERDDAP needs has been compiled.
       Lots of classes are compiled that aren't needed for ERDDAP.
       If compiling TestAll succeeds but doesn't compile some class, that class isn't needed.
       (There are some unfinished/unused classes.)
     </ul>
  <li>We use some 3rd party source code instead of .jar files (notably for Dods)
     and have modified them slightly to avoid problems compiling with Java 8 (1.8). <!-- javaVersion -->
     We have often made other slight modifications (notably to Dods) for other reasons.
  <li>Most classes have test methods. We run lots of tests via TestAll. 
     Unfortunately, many of the tests are specific to our set up.  (Sorry.)
  <br>&nbsp;
  </ul>

<li><strong><a class="selfLink" id="importantClasses" href="#importantClasses" rel="bookmark">Important Classes</a></strong> -- If you want to look 
at the source code and try to figure out how ERDDAP works, please do. 
  <ul>
  <li>The code has JavaDoc comments, but the JavaDocs haven't been generated. Feel free to generate them.
  <li>The most important classes (including the ones mentioned below) are within gov/noaa/pfel/erddap.
  <li>The Erddap class has the highest level methods.  It extends HttpServlet.
  <li>Erddap passes requests to instances of subclasses of EDDGrid or EDDTable, 
    which represent individual datasets.
  <li>EDDGrid and EDDTable subclasses parse the request, get data from subclass-specific methods, 
    then format the data for the response.
  <li>EDDGrid subclasses push data into GridDataAccessor (the internal data container for gridded data).
  <li>EDDTable subclasses push data into TableWriter subclasses, which write data to a specific file 
    type on-the-fly.
  <br>&nbsp;
  </ul>

<li><strong><a class="selfLink" id="codeContributions" href="#codeContributions" rel="bookmark">Code Contributions</a></strong> -- 
  If you have written some code which would be a nice addition to ERDDAP, 
  please email <kbd>bob dot simons at noaa dot gov</kbd>. We'll work out the details.
  The two situations that are most likely are:
    <ol>
    <li>You want to write another subclass of EDDGrid or EDDTable to handle another data source type.
       If so, we recommend that you find the closest existing subclass and use that code as a starting   point.
    <li>You want to write another saveAs<i>FileType</i> method.
       If so, we recommend that you find the closest existing saveAs<i>FileType</i> method
         in EDDGrid or EDDTable 
       and use that code as a starting point.
    </ol>
  Both of these situations have the advantage that the code you write is self-contained.
  You won't need to know all the details of ERDDAP's internals.
  And it will be easy for us to incorporate your code in ERDDAP.
  Note that if you do submit code, the license will need compatible with the ERDDAP 
    <a rel="license" href="#license">license</a> (e.g., 
    <a rel="bookmark" href="https://www.apache.org/licenses/">Apache<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>,
    <a rel="bookmark" href="https://www.opensource.org/licenses/bsd-license.php">BSD<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>, or
    <a rel="bookmark" href="https://www.opensource.org/licenses/mit-license.php">MIT-X<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>).
  You can hold the copyright to your code. We'll list your contribution in the 
    <a rel="license" href="#credits">credits</a>.
  <br>&nbsp;

</ul>


<!-- ******* -->
<h2><a class="selfLink" id="changes" href="#changes" rel="bookmark">List of Changes</a></h2>

The  
<a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/changes.html">List of Changes</a>
for each ERDDAP release is now on a separate web page.


<!-- ******* -->
<h2><a class="selfLink" id="credits" href="#credits" rel="bookmark">Credits</a></h2>

ERDDAP is a product of the  
<a title="National Oceanic and Atmospheric Administration" rel="bookmark" href="https://www.noaa.gov">NOAA<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>  
<a title="National Marine Fisheries Service" rel="bookmark" href="https://www.fisheries.noaa.gov">NMFS<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>  
<a title="Southwest Fisheries Science Center" rel="bookmark"
      href="https://swfsc.noaa.gov">SWFSC</a> 
<a title="Environmental Research Division" rel="bookmark" href="https://swfsc.noaa.gov/textblock.aspx?Division=ERD&amp;id=1315&amp;ParentMenuId=200">ERD</a>.

<p>Bob Simons is the original and still the main author of ERDDAP 
(the designer and software developer who wrote the ERDDAP-specific code). 
The starting point was Roy Mendelssohn's suggestion
that Bob turn his ConvertTable (a small utility which converts tabular data
from one format to another and which was largely code from Bob's
pre-NOAA work that Bob re-licensed to be open source) into a web service.

<p>It was and is Roy Mendelssohn's ideas about distributed data systems,
his initial suggestion to Bob, and his ongoing support
(including hardware, network, and other software support,
and by freeing up Bob's time so he could spend more time on the ERDDAP code)
that has made this project possible and enabled its growth.

<p>The ERDDAP-specific code is licensed as copyrighted open source, with 
  <a rel="bookmark" href="https://www.noaa.gov">NOAA<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> 
  holding the copyright. See the <a rel="license" href="#license">ERDDAP license</a>.
<br>ERDDAP uses copyrighted open source, Apache, LGPL, MIT/X, Mozilla, and public domain libraries and data.
<br>ERDDAP does not require any GPL code or commercial programs.

<p>The bulk of the funding for work on ERDDAP has come from NOAA,
in that it pays Bob Simons' salary (he is a full time government employee with 
"hard"-money/full funding).
In the early days of ERDDAP, when he was a government contractor, 
funding came from the
<a rel="bookmark" href="https://coastwatch.noaa.gov/">NOAA CoastWatch<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> program, 
the <a rel="bookmark" href="https://ioos.noaa.gov/">NOAA IOOS<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
program, and the now defunct Pacific Ocean Shelf Tracking (POST) program.  

<p>Much credit goes to the many ERDDAP administrators and users who have made
suggestions and comments which have led to many improvements in ERDDAP. 
Many are mentioned by name in the 
<a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/download/changes.html">List of Changes</a>.
Thank you all (named and unnamed) very much.
Thus, ERDDAP is a great example of 
<a rel="bookmark" href="https://en.wikipedia.org/wiki/User_innovation">User-Driven Innovation<img 
        src="../images/external.png" alt=" (external link)" 
        title="This link to an external website does not constitute an endorsement."></a>,
where product innovation often comes from consumers (ERDDAP users), not just the producers (ERDDAP developers).


<p>Here is the list of software that ERDDAP uses. We are very grateful for all of these.
Thank you very much.
(If we have accidentally omitted a project, please let us know so we can give
credit where credit is due.)

<ul>
<li>ERDDAP is a 
    <a rel="help" href="https://www.oracle.com/technetwork/java/javaee/servlet/index.html">Java Servlet<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
    program. At ERD, it runs inside of a
    <a rel="help" href="https://tomcat.apache.org/">Tomcat<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> application server
    (license: <a rel="bookmark" href="https://www.apache.org/licenses/">Apache<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>), 
  with an 
    <a rel="help" href="https://httpd.apache.org/">Apache<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> web server
    (license: <a rel="bookmark" href="https://www.apache.org/licenses/">Apache<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>), 
    running on a computer using the 
    <a rel="help" href="https://www.redhat.com/">Red Hat Linux<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> operating 
  system (license: <a rel="bookmark" href="https://www.gnu.org/licenses/gpl-3.0.html">GPL<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>).
<li>The data sets are from various sources. See the metadata (in particular the "sourceUrl", "infoUrl", 
  "institution", and "license") for each dataset.  
  Many datasets have a restriction on their use that requires you to cite/credit the 
  data provider whenever you use the data.  It is always good form to cite/credit the 
  data provider. See
  <a rel="help" href="https://coastwatch.pfeg.noaa.gov/erddap/information.html#citeDataset"
  >How to Cite a Dataset in a Paper</a>.
<li> The com/cohort classes are from CoHort Software 
    (<a rel="help" href="http://www.cohort.com">http://www.cohort.com<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>)
    which makes these classes available with an MIT/X-like license (see classes/com/cohort/util/LICENSE.txt).
<li>Data from <a rel="help" href="https://www.opendap.org">OPeNDAP<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> 
    servers are read 
    with <a rel="bookmark" href="https://www.opendap.org/deprecated-software/java-dap">Java DAP 1.1.7<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
    (license: LGPL).
<li>NetCDF files (.nc) and GMT-style NetCDF files (.grd) are read and written with code in the
  <a rel="help" href="https://www.unidata.ucar.edu/software/thredds/current/netcdf-java/index.html"
  >NetCDF Java Library<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
    (license: <a rel="bookmark" href="https://www.unidata.ucar.edu/software/netcdf/copyright.html">MIT/X-like<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>)
    from <a rel="bookmark" href="https://www.unidata.ucar.edu/">Unidata<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>.
<li>The NetCDF Java Library reads GRIB files via the Unidata
    <a rel="help" href="https://www.unidata.ucar.edu/software/decoders/">GRIB decoder (grib-6.0.jar)<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
  (license: <a rel="bookmark" href="https://www.unidata.ucar.edu/software/netcdf/copyright.html">MIT/X-like<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>).
<li>The NetCDF Java Library reads BUFR files via the Unidata
    <a rel="help" href="https://www.unidata.ucar.edu/software/decoders/">BUFR decoder <img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
  (license: <a rel="bookmark" href="https://www.unidata.ucar.edu/software/netcdf/copyright.html">MIT/X-like<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>).
<li>The NetCDF Java Library and Cassandra need <a rel="help" href="https://www.slf4j.org/"
  >slf4j from the Simple Logging Facade for Java</a> project.
  Currently, ERDDAP uses the slf4j-simple-xxx.jar renamed as slf4j.jar to meet this need.
    (license: <a rel="bookmark" href="https://www.slf4j.org/license.html">MIT/X<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>).
<!--li>ERDDAP and the NetCDF Java Library use <a rel="help" href="http://www.joda.org/joda-time/">Joda<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> 
     for some calendar calculations.
     (license: <a rel="bookmark" 
     href="http://www.joda.org/joda-time/license.html">Apache 2.0<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>). -->
<li>ERDDAP and the NetCDF Java Library uses code from some .jar files from 
  <a rel="help" href="https://www.apache.org/">Apache projects<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>:
  <a rel="help" href="https://commons.apache.org/codec/">commons-codec<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>,
  <a rel="help" href="https://hc.apache.org/httpcomponents-client-ga/">commons-httpclient<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>, and
  <a rel="help" href="https://commons.apache.org/discovery/">commons-discovery<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
  (For all: license: <a rel="bookmark" href="https://www.apache.org/licenses/LICENSE-2.0">Apache<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>).
  These are included in the netcdfAll.jar.
<li>The NetCDF Java Library uses XML processing code from 
    <a rel="help" href="http://www.jdom.org/">JDOM<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
    (license: <a rel="bookmark" href="http://www.jdom.org/docs/faq.html#a0030">Apache<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>),
      which is included in the netcdfAll.jar.
<li> For working with Amazon AWS and S3, the NetCDF Java Library and ERDDAP use the
  <a rel="help" href="https://aws.amazon.com/sdk-for-java/">aws-java-sdk.jar<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> 
      (license: 
      <a rel="bookmark" href="https://www.apache.org/licenses/">Apache<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>),
      which is included in the netcdfAll.jar.
  <br>aws-java-sdk.jar requires commons-codec.jar, commons-logging.jar,
      fluent-hc.jar,
      httpclient.jar, httpclient-cache.jar, httpclient-win.jar, 
      httpcore.jar, and httpmime.jar, which are all from the    
      <a rel="help" href="https://hc.apache.org/downloads.cgi">Apache Project<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> 
      (license: 
      <a rel="bookmark" href="https://www.apache.org/licenses/">Apache<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>),
      which are included in the netcdfAll.jar.
  <br>aws-java-sdk.jar also requires the 
      <a rel="help" href="https://github.com/java-native-access/jna">Java Native Access 
      jna.jar and jna-platform.jar<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> 
      (license: 
      <a rel="bookmark" href="https://github.com/java-native-access/jna/blob/master/LICENSE">Apache 2.0<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>),
      which are included in the netcdfAll.jar.
  <br>aws-java-sdk.jar also requires the 
      <a rel="help" href="https://mvnrepository.com/artifact/com.fasterxml.jackson.core"
      >jackson-annotations.jar, jackson-core.jar, and jackson-databind.jar<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> from 
      <a rel="help" href="https://github.com/FasterXML">FasterXML<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> 
      (license: 
      <a rel="bookmark" href="https://github.com/FasterXML/jackson-core#overview"
      >Apache 2.0<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>),
      which are included in the netcdfAll.jar.

<li>ERDDAP uses 
    <a rel="help" href="https://www.json.org/index.html">json.org's Java-based JSON library<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> 
    to parse <a rel="help" href="https://www.json.org/">JSON<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> data
  (license: <a rel="bookmark" href="https://www.json.org/license.html">copyrighted open source<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>).
<li>ERDDAP use code from Apache
  <a rel="help" href="https://commons.apache.org/compress/">commons-compress<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
  (License: <a rel="bookmark" href="https://www.apache.org/licenses/LICENSE-2.0">Apache<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>).
<li>The graphs and maps are created on-the-fly with a modified version of NOAA's 
    <a rel="help" href="https://www.pmel.noaa.gov/epic/java/sgt/">SGT<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> version 3
  (a Java-based Scientific Graphics Toolkit written by Donald Denbo at
    <a rel="help" href="https://www.pmel.noaa.gov/">NOAA PMEL<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>)
  (license: <a rel="bookmark" href="https://www.pmel.noaa.gov/epic/java/license.html"
  >copyrighted open source<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>).
<li>Big, HTML tooltips on ERDDAP's HTML pages are created with Walter Zorn's wz_tooltip.js
    <!-- was http://wztip.info/index.php/Main_Page -->
  (license: LGPL).
<li>Sliders and the drag and drop feature of the Slide Sorter are created with Walter Zorn's
  wz_dragdrop.js <!-- was http://www.walterzorn.com/dragdrop/dragdrop_e.htm -->
    (license: LGPL).
<li>The .pdf files are created with
    <a rel="help" href="https://itextpdf.com/">iText<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> 
      (version 1.3.1, which used the 
    <!-- was http://www.lowagie.com/iText/download.html --> Mozilla license),
    a free Java-PDF library by Bruno Lowagie and Paulo Soares.
<li>The shoreline and lake data are from
    <a rel="help" href="https://www.ngdc.noaa.gov/mgg/shorelines/gshhs.html">GSHHS<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
    -- A Global Self-consistent, Hierarchical, 
    High-resolution Shoreline Database
    (license: <a rel="bookmark" href="https://www.soest.hawaii.edu/pwessel/gshhs/README.TXT">GPL<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>)
    and created by Paul Wessel and Walter Smith.
    <p>WE MAKE NO CLAIM ABOUT THE CORRECTNESS OF THE SHORELINE DATA THAT COMES WITH ERDDAP --
    DO NOT USE IT FOR NAVIGATIONAL PURPOSES.
<li>The political boundary and river data are from the 
    <a rel="help" href="https://gmt.soest.hawaii.edu/doc/5.4.5/pscoast.html">pscoast<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
    program in 
    <a rel="help" href="https://gmt.soest.hawaii.edu">GMT<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>,
    which uses data from the 
  <a rel="help" href="https://www.evl.uic.edu/pape/data/WDB/">CIA World Data Bank II<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
    (license: public domain).
    <p>WE MAKE NO CLAIM ABOUT THE CORRECTNESS OF THE POLITICAL BOUNDARY
    DATA THAT COMES WITH ERDDAP.
<li>The bathymetry/topography data used in the background of some maps is the  
  <a rel="help" href="https://www.ngdc.noaa.gov/mgg/global/global.html">ETOPO1 Global 1-Minute Gridded Elevation Data Set<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> 
      (Ice Surface, grid registered, binary, 
  2 byte int: etopo1_ice_g_i2.zip)
    (license:  
    <a rel="bookmark" href="https://www.ngdc.noaa.gov/ngdcinfo/privacy.html#copyright">public domain<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>), 
  which is distributed for free by 
    <a rel="bookmark" href="https://www.ngdc.noaa.gov">NOAA NGDC<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>.
    <p>WE MAKE NO CLAIM ABOUT THE CORRECTNESS OF THE BATHYMETRY/TOPOGRAPHY
    DATA THAT COMES WITH ERDDAP. DO NOT USE IT FOR NAVIGATIONAL PURPOSES.
<li>The color palettes which have the prefix "KT_" are a    
    <a rel="help" href="http://soliton.vm.bytemark.co.uk/pub/cpt-city/cmocean/index.html"
    >collection of .cpt palettes by Kristen Thyng<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
    (license: 
    <a rel="bookmark" href="http://soliton.vm.bytemark.co.uk/pub/cpt-city/cmocean/copying.html"
      >MIT/X<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>),
     but slightly reformatted by Jennifer Sevadjian of NOAA so that they conform
     to ERDDAP's .cpt requirements.
<li>Emails are sent using code in mail.jar from Oracle's   
    <a rel="help" href="https://www.oracle.com/technetwork/java/javamail/index.html">JavaMail API<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
    (license: 
    <a rel="bookmark" href="https://download.oracle.com/otn-pub/java/licenses/OTN_JavaEE_Legacy_Binary-Code-License_30Jan2012.txt"
      >Oracle Binary Code License Agreement for Java EE Technologies<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>).
<li>ERDDAP includes the 
     <a rel="help" href="https://jdbc.postgresql.org/download.html">PostGres JDBC42<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> driver
     (license: <a rel="bookmark" href="https://www.postgresql.org/about/licence/">BSD<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>).
    The driver is Copyright (c) 1997-2010, PostgreSQL Global Development Group. All rights reserved.
<li>ERDDAP includes  
     <a rel="help"
      href="https://cassandra.apache.org/">Cassandra's<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> 
     <a rel="help"
      href="https://mvnrepository.com/artifact/com.datastax.cassandra/cassandra-driver-core">cassandra-driver-core.jar<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> 
     (license: <a rel="bookmark" 
      href="https://github.com/datastax/java-driver/blob/2.1/LICENSE">Apache 2.0<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>).

    <br>Cassandra's cassandra-driver-core.jar requires (and so ERDDAP includes):
    <ul>
    <li><a rel="help" href="https://netty.io/downloads.html">netty-all.jar<img 
        src="../images/external.png" alt=" (external link)" 
        title="This link to an external website does not constitute an endorsement."></a>
      (license: <a rel="bookmark" href="https://netty.io/downloads.html">Apache 2.0<img 
        src="../images/external.png" alt=" (external link)" 
        title="This link to an external website does not constitute an endorsement."></a>).

    <li><a rel="help" href="https://code.google.com/p/guava-libraries/">guava.jar<img 
        src="../images/external.png" alt=" (external link)" 
        title="This link to an external website does not constitute an endorsement."></a>
      (license: <a rel="bookmark" href="https://code.google.com/p/guava-libraries/">Apache 2.0<img 
        src="../images/external.png" alt=" (external link)" 
        title="This link to an external website does not constitute an endorsement."></a>).

    <li><a rel="help"
      href="https://mvnrepository.com/artifact/com.codahale.metrics/metrics-core/3.0.2">metrics-core.jar<img 
        src="../images/external.png" alt=" (external link)" 
        title="This link to an external website does not constitute an endorsement."></a>
      (license: <a rel="bookmark" href="https://github.com/codahale/metrics/blob/master/LICENSE">MIT<img 
        src="../images/external.png" alt=" (external link)" 
        title="This link to an external website does not constitute an endorsement."></a>).

    <li><a rel="help" href="https://repo1.maven.org/maven2/net/jpountz/lz4/lz4/">lz4.jar<img 
        src="../images/external.png" alt=" (external link)" 
        title="This link to an external website does not constitute an endorsement."></a>
      (license: 
      <a rel="bookmark" href="https://github.com/jpountz/lz4-java/blob/master/LICENSE.txt">Apache 2.0<img 
        src="../images/external.png" alt=" (external link)" 
        title="This link to an external website does not constitute an endorsement."></a>).

    <li><a rel="help" href="https://xerial.org/snappy-java/">snappy-java.jar<img 
        src="../images/external.png" alt=" (external link)" 
        title="This link to an external website does not constitute an endorsement."></a>
      (license: 
      <a rel="bookmark" href="https://github.com/xerial/snappy-java/blob/develop/LICENSE">Apache 2.0<img 
        src="../images/external.png" alt=" (external link)" 
        title="This link to an external website does not constitute an endorsement."></a>).
    </ul>

<li><a href="https://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#EDDGridFromMergeIRFiles" rel="bookmark"
  >EDDGridFromMergeIRFiles.java</a> was written and contributed by
   Jonathan Lafite and Philippe Makowski of 
   <a rel="bookmark" href="http://rtech-engineering.com/?lang=en">R.Tech Engineering<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>
   (license: copyrighted open source). Thank you, Jonathan and Philippe!

<li><a href="https://coastwatch.pfeg.noaa.gov/erddap/tabledap/documentation.html#fileType" rel="bookmark"
  >.dataTable (TableWriterDataTable.java)</a> was written and contributed by Roland Schweitzer of NOAA
   (license: copyrighted open source). Thank you, Roland!

<li>The initial version of the 
  <a href="#jsonld" rel="bookmark">Semantic Markup of Datasets with json-ld (JSON Linked Data)</a>
  feature (and thus all of the hard work in designing the content) was 
  written and contributed (license: copyrighted open source)
  by Adam Leadbetter and Rob Fuller of the Marine Institute in Ireland.
  Thank you, Adam and Rob!

<li>The code for the 
  <a href="https://coastwatch.pfeg.noaa.gov/erddap/tabledap/documentation.html#orderByMean" rel="bookmark"
  >orderByMean filter</a> 
  in tabledap and the extensive changes to the code to
  support the 
  <a href="https://coastwatch.pfeg.noaa.gov/erddap/tabledap/documentation.html#orderByDivisorOptions" rel="bookmark"
  ><i>variableName/divisor:offset</i> notation</a>
  for all orderBy filters
  was written and contributed (license: copyrighted open source)
  by Rob Fuller and Adam Leadbetter of the Marine Institute in Ireland.
  Thank you, Rob and Adam!

<li>ERDDAP uses code from the 
    <a rel="help" href="https://coastwatch.pfeg.noaa.gov/coastwatch/CWBrowser.jsp">CoastWatch Browser</a> 
    project from the
    <a rel="bookmark" href="https://coastwatch.noaa.gov">NOAA CoastWatch</a>
    <a rel="bookmark" href="https://coastwatch.pfeg.noaa.gov/">West Coast Regional Node</a>
    (license:  
    <a rel="bookmark" href="https://coastwatch.pfeg.noaa.gov/coastwatch/CWBrowserInfo.html#Credits">copyrighted open source</a>).
  That project was initiated and managed by Dave Foley, a former Coordinator of the NOAA CoastWatch 
  West Coast Regional Node.  
  The CoastWatch Browser code was written by Bob Simons.
</ul>

<p>We are also very grateful for all of the software that we use when developing ERDDAP, 
including
    <a rel="help" href="https://www.google.com/chrome/browser/desktop/">Chrome<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>,
    <a rel="help" href="https://curl.haxx.se/">curl<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>, 
    <a rel="help" href="https://duckduckgo.com/?q=">DuckDuckGo<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>, 
    <a rel="help" href="https://www.editplus.com/">EditPlus<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>,
    <a rel="help" href="https://filezilla-project.org/">FileZilla<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>.
    <a rel="help" href="https://github.com/">GitHub<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>,
    <a rel="help" href="https://www.google.com/webhp">Google Search<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>, 
    <a rel="help" href="https://www.chiark.greenend.org.uk/~sgtatham/putty/download.html">PuTTY<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>, 
    <a rel="help" href="https://en.todoist.com/">todoist<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a>, 
    the Internet, the World Wide Web, and all the great, helpful websites.
Thank you very much.

<!-- ******* -->
<h2><a class="selfLink" id="license" href="#license" rel="bookmark">License</a></h2>
The ERDDAP-specific code is licensed as copyrighted open source, 
  with <a rel="bookmark" href="https://www.noaa.gov">NOAA<img 
      src="../images/external.png" alt=" (external link)" 
      title="This link to an external website does not constitute an endorsement."></a> holding the copyright.  
The license is:
<blockquote>
ERDDAP, Copyright 2019, NOAA.

<P>PERMISSION TO USE, COPY, MODIFY, AND DISTRIBUTE THIS SOFTWARE AND 
ITS DOCUMENTATION FOR ANY PURPOSE AND WITHOUT FEE IS HEREBY GRANTED,
PROVIDED THAT THE ABOVE COPYRIGHT NOTICE APPEAR IN ALL COPIES, THAT
BOTH THE COPYRIGHT NOTICE AND THIS PERMISSION NOTICE APPEAR IN
SUPPORTING DOCUMENTATION, AND THAT REDISTRIBUTIONS OF MODIFIED FORMS
OF THE SOURCE OR BINARY CODE CARRY PROMINENT NOTICES STATING THAT THE
ORIGINAL CODE WAS CHANGED AND THE DATE OF THE CHANGE.  THIS SOFTWARE
IS PROVIDED "AS IS" WITHOUT EXPRESS OR IMPLIED WARRANTY.
</blockquote>


<!-- ******* -->
<h2><a class="selfLink" id="contact" href="#contact" rel="bookmark">Contact</a></h2>
Questions, comments, suggestions?  Please send an email to 
  <kbd>bob dot simons at noaa dot gov</kbd>
and include the ERDDAP URL directly related to your question or comment.

<p><a class="selfLink" id="ERDDAPMailingList" href="#ERDDAPMailingList" rel="bookmark">Or,
you can join the ERDDAP Google Group / Mailing List</a> by visiting
<a class="N" rel="help"
href="https://groups.google.com/forum/#!forum/erddap">https://groups.google.com/forum/#!forum/erddap<img 
  src="../images/external.png" alt=" (external link)" 
  title="This link to an external website does not constitute an endorsement."></a> 
and clicking on "Apply for membership". 
Once you are a member, you can post your question there
or search to see if the question has already been asked and answered. 

<br>&nbsp;
<hr>
<p>ERDDAP, Version 2.00
<br><a rel="bookmark" href="https://coastwatch.pfeg.noaa.gov/erddap/legal.html">Disclaimers</a> | 
    <a rel="bookmark" href="https://coastwatch.pfeg.noaa.gov/erddap/legal.html#privacyPolicy">Privacy Policy</a>

</div>
</body>
</html>
