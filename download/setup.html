<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
  "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>ERDDAP - Set Up Your Own ERDDAP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="shortcut icon" href="http://coastwatch.pfeg.noaa.gov/erddap/images/favicon.ico">
<link href="../images/erddap.css" rel="stylesheet" type="text/css">
</head>

<body> 
<table bgcolor="#128CB5" border="0" cellpadding="2" cellspacing="0" width="100%"> 
  <tr> 
    <td align="center" style="width:100px;"> &nbsp;
      <img src="http://coastwatch.pfeg.noaa.gov/erddap/images/noaab.png" alt="NOAA" align="middle"> &nbsp;     
      </td> 
    <td align="left">
      <font color="#FFFFFF">
      <font size="+2"><b>ERDDAP</b></font>
      <br>Easier access to scientific data</font>
      </td> 
    <td align="right"><font size="-1"> 
      <br>Brought to you by 
      <a title="National Oceanic and Atmospheric Administration" rel="bookmark" href="http://www.noaa.gov">NOAA</a>  
      <a title="National Marine Fisheries Service"               rel="bookmark" href="http://www.nmfs.noaa.gov">NMFS</a>  
      <a title="Southwest Fisheries Science Center"              rel="bookmark" href="http://swfsc.noaa.gov">SWFSC</a>  
      <a title="Environmental Research Division" rel="bookmark" href="http://swfsc.noaa.gov/textblock.aspx?Division=ERD&amp;id=1315&amp;ParentMenuId=200">ERD</a>  
      &nbsp; &nbsp;
      </font></td> 
  </tr> 
</table>

<table style="width:640px; border-style:outset; border-width:0px; padding:0px; " 
  cellspacing="0"> 
<tr>
<td>

&nbsp;
<form action="">
<input type="button" value="Back" onClick="history.go(-1);return true;">
</form>

<center>
<big><big><big><b>Set Up Your Own ERDDAP</b></big></big></big>
<br>&nbsp;<br>Why? |
<a rel="help" href="#initialSetup">Initial Setup</a> | 
<a rel="help" href="#update">Update</a> | 
<a rel="help" href="#needToKnow">Need To Know</a> | 
<a rel="help" href="#dontNeedToKnow">Don't Need To Know</a> | 
<br>
<a rel="help" href="#slideShows">Slide Shows</a> | 
<a rel="help" href="#programmersGuide">Programmer's Guide</a> | 
<a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/changes.html">List of Changes</a> | 
<a rel="copyright" href="#credits">Credits</a> | 
<a rel="copyright" href="#license">License</a> |
<a rel="help" href="#contact">Contact</a>
<p>And see the related document 
<a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html"><b>Working with the datasets.xml File</b></a>
</center>

<p>ERDDAP is a free and open source, all-Java (servlet), web application that
runs in a web application server 
(for example, Tomcat). This web page is mostly for people ("ERDDAP administrators")
who want to set up their own ERDDAP installation at their own web site.

<h2>Why use ERDDAP to distribute your data?</h2>
Because the small effort to setup ERDDAP brings many benefits.
<ul>
<li>If you already have a web service for distributing your data, 
  <br>you can set up ERDDAP to access your data via the existing service.
  <br>Or, you can set up ERDDAP to access your data directly from local files.
<li>For each dataset, you only have to write a small chunk of XML to tell ERDDAP how to access the dataset.
<li>Once you have ERDDAP serving your data, end users can:
  <ul>
  <li>Request the data in various ways (DAP, WMS, and more in the future).
  <li>Get the data response in various file formats.  (That's probably the biggest reason!)
  <li>Make graphs and maps.  (Everyone likes pretty pictures.)
  </ul>
</ul>
You can <a rel="help" href="#customize">customize</a> your ERDDAP's appearance 
so ERDDAP reflects your organization and fits in with the rest of your web site.

<h2><a name="organizations">ERDDAP</a> has been installed by over 50 organizations worldwide,</h2>
including:
<ul>
<li><a rel="bookmark" href="http://rs-data1-mel.csiro.au/erddap/index.html">CSIRO and IMOS</a> (Australia's Commonwealth Scientific and Industrial Research Organisation and the Integrated Marine Observing System)
  <!-- 2015-06-28 email Jonathan Hodge  -->
<li><a rel="bookmark" href="https://bluehub.jrc.ec.europa.eu/erddap/index.html">IPSC JRC EC</a>  (Maritime Affairs Unit, Institute for the Protection and Security of the Citizen,
Joint Research Centre of the European Commission)
  <!-- 2014-11-19 and 2015-03-18 Conor Delaney  -->
<li>IRD (Institut de Recherche pour le Développement, France)
  <br>CNRS (Centre National de la Recherche Scientifique, France)
  <br>UPMC (Université Pierre et Marie CURIE, Paris, France)
  <br>UCAD (Université Cheikh Anta Diop de Dakar, Sénégal)
  <br>UGB (Université Gaston Berger - Saint-Louis du Sénégal)
  <br>UFHB (Université Félix HOUPHOUËT-BOIGNY, Abidjan, Côte d'Ivoire)
  <br>IPSL (Institut Pierre Simon Laplace des sciences de l'environnement, Paris, France)
  <br>LMI ECLAIRS (Laboratoire Mixte International «Etude du Climat en Afrique de l’Ouest et de ses Interactions avec l’Environnement Régional, et appui aux services climatiques») 
  <!-- 2015-03-17 Thierry Valero -->
<li><a rel="bookmark" href="http://erddap.marine.ie/erddap/index.html">The Marine Institute</a>  (Ireland)
  <!-- 2015-03-19 Damian Smyth -->
<li>Marine Instruments S.A. (Spain)
  <!-- 2015-03-25 Iago Tejeda Pérez -->
<li><a rel="bookmark" href="http://cwcgom.aoml.noaa.gov/erddap/index.html">NOAA CW CGOM</a>  (CoastWatch Caribbean/Gulf of Mexico Node)
  <!-- assumed public, Joaquin Trinanes -->
<li><a rel="bookmark" href="http://coastwatch.pfeg.noaa.gov/erddap/index.html">NOAA CW WC</a>  (CoastWatch West Coast Node) which is co-located with and works with 
  <!-- 2015-03-17 Bob Simons-->
<br><a rel="bookmark" href="http://coastwatch.pfeg.noaa.gov/erddap/index.html">NOAA ERD</a>  (Environmental Research Division of SWFSC of NMFS)
  <!-- 2015-03-17 Bob Simons (since this is a public IOOS server) -->
<li><a rel="bookmark" href="http://erddap.axiomalaska.com/erddap/index.html">NOAA IOOS CeNCOOS</a> (Central and Northern California Ocean Observing System) 
  <!-- 2015-03-18 Jennifer Patterson -->
<li><a rel="bookmark" href="http://www.neracoos.org/erddap/index.html">NOAA IOOS NERACOOS</a> (Northeastern Regional Association of Coastal and Ocean Observing Systems) 
  <!-- 2015-03-18 Eric Bridger -->
<li><a rel="bookmark" href="http://data.ioos.us/gliders/erddap/index.html">NOAA IOOS NGDAC</a> (National Glider Data Assembly Center) 
  <!-- 2015-03-17 Luke Campbell -->
<li><a rel="bookmark" href="http://oos.soest.hawaii.edu/erddap/index.html">NOAA IOOS PacIOOS</a> (Pacific Islands Ocean Observing System) at the University of Hawaii (UH) 
  <!-- 2015-03-16 John Maurer, 2015-03-17 James Potemra -->
<li><a rel="bookmark" href="http://129.252.139.124/erddap/index.html">NOAA IOOS SECOORA</a> (Southeast Coastal Ocean Observing Regional Association) 
  <!-- 2015-03-27 Jeremy Cothran -->
<li><a rel="bookmark" href="http://ecowatch.ncddc.noaa.gov/erddap/index.html">NOAA NCEI</a> (National Centers for Environmental Information) / NCDDC 
  <!-- 2015-03-17 (was NCDDC) Glenn Rutledge, Charles Carleton -->
<li>NOAA NGDC STP (National Geophysical Data Center, Solar - Terrestrial Physics)
  <!-- 2015-03-23 Dominic Fuller-Rowell -->
<li><a rel="bookmark" href="http://osmc.noaa.gov/erddap/index.html">NOAA OSMC</a> (Observing System Monitoring Center) 
  <!-- 2015-03-23 Kevin O'Brien -->
<li><a rel="bookmark" href="http://upwell.pfeg.noaa.gov/erddap/index.html">NOAA UAF</a> (Unified Access Framework)
  <!-- 2015-03-17 Bob Simons-->
<li><a rel="bookmark" href="http://dap.onc.uvic.ca/erddap/index.html">ONC</a> (Ocean Networks Canada) 
  <!-- 2015-03-17 Reyna Jenkyns -->
<li><a rel="bookmark" href="http://meteo.rtech.fr/erddap/index.html">R.Tech Engineering</a>, France 
  <!-- 2015-03-20 Philippe Makowski -->
<li>Spyglass Technologies 
  <!-- 2015-08-24 Paul Janecek -->
<li>Stanford University, Hopkins Marine Station 
  <!-- 2015-03-24 James Ganong -->
<li><a rel="bookmark" href="http://bmlsc.ucdavis.edu:8080/erddap/index.html">UC Davis BML</a> (University of California at Davis, Bodega Marine Laboratory) 
  <!-- 2015-03-17 Marcel Losekoot -->
<li>USGS Coastal and Marine Geology Program 
  <!-- 2015-03-18 Ellyn Montgomery -->
<li>UW APL (University of Washington, Applied Physics Laboratory) 
  <!-- 2015-04-02 Mike Harrington -->
</ul>
This is just a list of some of the organizations where ERDDAP has been installed 
by some individual or some group. 
It does not imply that the individual, the group, or the organization recommends
or endorses ERDDAP.

<p><b>ERDDAP is recommended within NOAA</b> 
<br><a rel="bookmark" 
href="https://geo-ide.noaa.gov/wiki/index.php?title=Data_Access_Technical_Recommendations#Software_implementations">NOAA's Data Access Procedural Directive<img 
  src="../images/external.png" align="bottom" alt=" (external link)" 
  title="This is a link to an external web site."/></a> 
includes ERDDAP in its list of recommended data servers for use by groups within NOAA. 

<h2>Is the installation procedure hard? Can I do it?</h2>
The initial installation takes some time, but it isn't very hard. You can do it.
If you get stuck, email me at <tt>bob dot simons at noaa dot gov</tt> .  I will help you.
<br>Or, you can join the <a rel="help"
href="#ERDDAPMailingList">ERDDAP Google Group / Mailing List</a> 
and post your question there.


<!-- ******* -->
<h2><a name="initialSetup">How</a> To Do the Initial Setup of ERDDAP on Your Server</h2>
ERDDAP can run on any server that supports Java and Tomcat (and perhaps other application servers).  
ERDDAP has been tested on Linux (including on Amazon's AWS), Mac, and Windows computers.   
<ul>
<li><b>Amazon</b> - If you are installing
ERDDAP on an Amazon Web Services EC2 instance, see this 
<a rel="help" href="#amazon">Amazon Web Services Overview</a> (below)
first.
<li><b>Docker</b> - Axiom now offers 
<a rel="bookmark" href="https://hub.docker.com/u/axiom/">ERDDAP in a Docker container<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>.
    <br>If you don't already use Docker, we don't recommend this. 
    <br>If you chose to install ERDDAP via Docker, we don't offer any support
      for the installation process.
    <br>We haven't worked with Docker yet. If you work with this, please send us your comments.

<li><b>Linux and Macs</b> - ERDDAP works great on Linux and Mac computers. 
<li><b>Windows</b> - Windows is fine for testing ERDDAP and for personal use, 
but we don't recommend using it for public ERDDAPs. 
Running ERDDAP on Windows may have problems: 
notably, ERDDAP may be unable to delete 
and/or rename files quickly. This is probably due to antivirus software (e.g., from MacAfee
and Norton) which is checking the files for viruses. If you run into this problem (which
can be seen by error messages in the log.txt file like "Unable to delete ..."), changing the
antivirus software's settings may partially alleviate the problem. Or consider using a Linux
or Mac server instead.
</ul>

<p><b>The standard ERDDAP installation instructions are:</b>
<ol>
<li><a name="java">Set up Java.</a>  
    <br>Type "java -version" from your server's command line to make sure you have 
    <a rel="bookmark" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Java<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
    (JRE or JDK) version 1.8 or higher installed  <!-- javaVersion -->
    (Java 1.7 is no longer supported because it reached its 
    <a rel="help" href="http://www.oracle.com/technetwork/java/eol-135779.html">end of life<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
    and so is no longer supported by Oracle). 
    For security reasons, it is almost always best to use the latest version of Java.
    ERDDAP works with 32 bit or 64 bit Java. 64 bit is preferred for 64-bit operating systems. 
    On Linux, we recommend that you download and install Java even if your computer came with Java
    installed. This lets you be in control of which Java you have and where it is (usr/local?).
    To install Java on Linux, see these
    <a rel="help" href="http://www.java.com/en/download/help/linux_install.xml">instructions<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>.
    <br>&nbsp;

<li><a name="tomcat">Set</a> up <a rel="help" href="http://tomcat.apache.org/">Tomcat<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>.    
    <br>For security reasons, it is almost always best to use the latest version of Tomcat.
    Below, the Tomcat directory will be referred to as <i>tomcat</i>.
    Warning! If you already have a Tomcat running some other web application (especially THREDDS), 
    we recommend that you install ERDDAP in <a rel="help" href="#secondTomcat">a&nbsp;second&nbsp;Tomcat</a>,
       because ERDDAP may need different settings 
    and shouldn't have to contend with other applications for memory.
    <br>&nbsp;
    <ul>

    <li>Follow the instructions at 
      <a rel="help" href="http://tomcat.apache.org/">http://tomcat.apache.org/<img 
        src="../images/external.png" align="bottom" alt=" (external link)" 
        title="This link to an external web site does not constitute an endorsement."/></a> 
      to set up Tomcat on your server.
      <br>On Linux, we recommend installing it in /usr/local.
      <br>On a Mac, it is probably already installed in /Library/Tomcat.
      <br>On Windows, select the "32-bit/64-bit Windows Service Installer".
        It will be installed in c:/Program Files.
      <br>&nbsp;
     
    <li>Security recommendation: you can remove some possible avenues for attackers by following 
      <a rel="help" href="http://www.j2eeprogrammer.com/2011/11/disabling-certain-http-methods-in.html"
      >these&nbsp;instructions<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> (especially the article's second recommendation) 
      to disable certain HTTP methods 
      (TRACE, PUT, OPTIONS, DELETE) in Tomcat.
      (<a rel="help" href="https://www.owasp.org/index.php/Testing_for_HTTP_Methods_and_XST_%28OWASP-CM-008%29"
      >background&nbsp;information<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>)
      <br>&nbsp;

    <li>On Linux and Macs, it is best to set up Tomcat (the program) as belonging to 
      user "tomcat" (a separate user with limited permissions and which <a rel="help" 
      href="http://unix.stackexchange.com/questions/56765/creating-an-user-without-a-password">has no password</a>.
      Thus, only the super user can switch to acting as user tomcat.
      This makes it impossible for hackers to log in to your server as user tomcat.
      And in any case, you should make it so that the tomcat user has very limited 
      permissions on the server's file system 
      (read+write+execute privileges for the apache-tomcat directory tree and 
      &lt;bigParentDirectory&gt; 
      and read-only privileges for directories with data that ERDDAP needs access to). 
      <ul>
      <li>You can create the tomcat user account (which has no password) by using the command
        <br><tt>sudo useradd tomcat -s /bin/bash -p '*'</tt>
      <li>You can switch to working as user tomcat by using the command
        <br><tt>sudo su - tomcat</tt>
        <br>(It will ask you for the superuser password for permission to do this.)
      <li>You can stop working as user tomcat by using the command
        <br><tt>exit</tt>
      <li>Do most of the rest of the Tomcat and ERDDAP setup instructions as user "tomcat".
        Later, run the startup.sh and shutdown.sh scripts as user "tomcat" so that Tomcat has 
        permission to write to its log files.
      <li>After unpacking Tomcat, from the parent of the apache-tomcat directory:
        <ul>
        <li>Change ownership of the apache-tomcat directory tree to the tomcat user.
          <br><tt>chown -R tomcat apache-tomcat-<i>8.0.23</i></tt>  <!-- tomcatVersion -->
          <br>(but substitute the actual name of your tomcat directory). 
        <li>Change the "group" to be tomcat, your username, 
          or the name of a small group that includes tomcat and 
          all the administrators of Tomcat/ERDDAP, e.g., 
          <br><tt>chgrp -R <i>yourUserName</i> apache-tomcat-<i>8.0.23</i></tt>  <!-- tomcatVersion -->
        <li>Change permissions so that tomcat and the group have 
          read, write, execute privileges, e.g,. 
          <br><tt>chmod -R ug+rwx apache-tomcat-<i>8.0.23</i></tt>  <!-- tomcatVersion -->
        <li>Remove "other" user's permissions to read, write, or execute:
          <br><tt>chmod -R o-rwx apache-tomcat-<i>8.0.23</i></tt>  <!-- tomcatVersion -->
          <br>This is important, because it prevents other users from
            reading possibly sensitive information in ERDDAP setup files.
        </ul>
      <br>&nbsp;
      </ul>

    <li><a name="LinuxMemory">Set</a> <a name="WindowsMemory">Tomcat's</a>
      <a name="MacMemory">Environmental</a> Variables
      <br>Create a file <i>tomcat</i>/bin/setenv.sh (or \'s and .bat in Windows)
      (or in Red Hat Enterprise Linux (RHEL), edit ~tomcat/conf/tomcat8.conf) <!-- tomcatVersion -->
      to set Tomcat's environmental variables.
      This file will be used by <i>tomcat</i>/bin/startup.sh and shutdown.sh 
      (or \'s and .bat in Windows).
      The file should contain:<tt>
      <br>export JAVA_HOME=/usr/local/jdk1.8.0_77/jre  <!-- javaVersion -->
      <br>export JAVA_OPTS='-server -Djava.awt.headless=true -Xmx1500M -Xms1500M'
      <br>export TOMCAT_HOME=/usr/local/apache-tomcat-<i>8.0.23</i>         <!-- tomcatVersion -->
      <br>export CATALINA_HOME=/usr/local/apache-tomcat-<i>8.0.23</i></tt>  <!-- tomcatVersion -->
      <br>(but substitute the directory names from your computer).        
      <br>(If you previously set JRE_HOME, you can remove that.)
      <br>In Windows, use <tt>set</tt> instead of <tt>export</tt> and \'s instead of /'s.
      <br>On Macs, you probably don't need to set JAVA_HOME.
      <br>The -Xmx and -Xms memory settings are important because ERDDAP works better with more 
      memory. Always set -Xms to the same value as -Xmx.
      <ul>
        <li>For 32 bit Operating Systems and 32 bit Java:
        <br>The more physical memory in the server the better: 4+ GB is really good, 2 GB is okay, 
        less is not recommended.  With 32 bit Java, even with abundant physical memory, 
        Tomcat and Java won't run if you try to set -Xmx much above 1500M (1200M on some computers).
        If your server has less than 2GB of memory, reduce the -Xmx value (in 'M'egaBytes) 
        to 1/2 of the computer's physical memory.

        <li>For 64 bit Operating Systems and 64 bit Java:
        <br>64 bit Java will only work on a 64 bit operating system.
        To enable 64 bit Java, add -d64 to the list of JAVA_OPTS in startup.sh and shutdown.sh, for example, 
        <br><tt>export JAVA_OPTS='-server -Djava.awt.headless=true -Xmx8000M -Xms8000M -d64'</tt>
        <br>With 64 bit Java, Tomcat and Java can use very high -Xmx and -Xms settings.
        The more physical memory in the server the better. As a simplistic suggestion: 
        we recommend you set -Xmx and -Xms to (in 'M'egaBytes) to 1/2 (or less) of the computer's
        physical memory.
        You can see if Tomcat, Java, and ERDDAP are indeed running in 64 bit mode by searching for 
        " bit," in ERDDAP's Daily Report email or in the 
        <i>bigParentDirectory</i>/logs/log.txt file (<i>bigParentDirectory</i> is specified in 
          <a rel="help" href="#setup.xml">setup.xml</a>). 
        <br>&nbsp;
      </ul>

      <!--p>Optional: You can add <tt>-verbose:gc</tt> to the JAVA_OPTS (or to the list of Java Options
      <br>in the Window's Tomcat Manager icon in the systemtry). It tells Java to send   
  <a rel="help" href="http://download.oracle.com/javase/technologies/hotspot/gc/gc_tuning_6.html">Java garbage collection</a>
      information to <i>tomcat</i>/logs/catalina.out (or some other Tomcat log file) 
      which is useful if your ERDDAP has memory problems. -->

    <li><a name="permissions">On</a> Linux and Macs, change the permissions of all 
      *.sh files in <i>tomcat</i>/bin/ to be executable by the owner, e.g., with
      <br><tt>chmod +x *.sh</tt>
      <br>&nbsp;

    <li><a name="fonts">Fonts</a> for images: We strongly prefer the free Vera Sans fonts 
      to the standard Linux/Java fonts.  Installing these fonts isn't required.  

    <p>If you don't install these fonts, you need to change the fontFamily setting in 
      setup.xml to <tt>&lt;fontFamily&gt;SansSerif&lt;/fontFamily&gt;</tt> .

    <p>To install the fonts, please download 
        <a rel="bookmark"  href="http://coastwatch.pfeg.noaa.gov/erddap/download/BitstreamVeraSans.zip">BitstreamVeraSans.zip</a> 
        (344,753 bytes, MD5=E16AF0C9838FD2443434F6E0E9FD0A0D) 
        and unzip the font files to a temporary directory.
      <ul>
      <li>On Linux (as the root user) and Windows XP (as the administrator), 
         copy the font files into <i>JAVA_HOME</i>/lib/fonts 
         so Java can find the fonts.
         Remember: if/when you later upgrade to a newer version of Java, you need to reinstall
         these fonts.
      <li>On Macs, for each font file, double click on it and then click <tt>Install Font</tt>.
      <li>On Windows Vista and 7, in Windows Explorer, select all of the font files. 
          Right click.  Click on <tt>Install</tt>.
        <br>&nbsp;
      </ul>

    <li><a name="testTomcat">Test</a> your Tomcat installation.
      <ul>
      <li>Linux:
        <br>As user "tomcat", run <tt><i>tomcat</i>/bin/startup.sh</tt>
        <br>View your URL + ":8080/" in your browser (e.g., 
           <a href="http://coastwatch.pfeg.noaa.gov:8080/">http://coastwatch.pfeg.noaa.gov:8080/</a>).
        <br>You should see the Tomcat "Congratulations" page. 
        <br>If there is trouble, see the Tomcat log file <i>tomcat</i>/logs/catalina.out.
      <li>Mac (run tomcat as the system administrator user):
        <br>Run <tt><i>tomcat</i>/bin/startup.sh</tt>
        <br>View your URL + ":8080/" in your browser (e.g., 
           <a href="http://coastwatch.pfeg.noaa.gov:8080/">http://coastwatch.pfeg.noaa.gov:8080/</a>).
        <br>You should see the Tomcat "Congratulations" page. 
        <br>If there is trouble, see the Tomcat log file <i>tomcat</i>/logs/catalina.out.
      <li>Windows localhost: 
        <br>Right click on the Tomcat icon in the system tray, and choose "Start service".
        <br>View <a href="http://127.0.0.1:8080/">http://127.0.0.1:8080/</a> in your browser.
        <br>You should see the Tomcat "Congratulations" page. 
        <br>If there is trouble, see the Tomcat log file <i>tomcat</i>/logs/catalina.out.
        <br>&nbsp;
      </ul>

    <li>Troubles with the Tomcat installation? 
      <ul>
      <li>See the Tomcat log file <i>tomcat</i>/logs/catalina.out.  
        Tomcat problems are almost always indicated there.
      <li>See the <a rel="help" href="http://tomcat.apache.org/">Tomcat<img 
          src="../images/external.png" align="bottom" alt=" (external link)" 
          title="This link to an external web site does not constitute an endorsement."/></a> 
        web site or search the web for help,
        but please let us know the problems you had and the solutions you found.
      <li>Email me at <tt>bob dot simons at noaa dot gov</tt> .  I will try to help you.
      <li>Or, you can join the <a rel="help"
        href="#ERDDAPMailingList">ERDDAP Google Group / Mailing List</a> 
        and post your question there.
        <br>&nbsp;
      </ul>
    </ul>

<li><a name="erddapContent">Set up the <i>tomcat</i>/content/erddap configuration files.</a> 
  <!-- 
    <br>A New Version is Coming Tomorrow (2015-03-12)! 
    <br>So, no version is available for downloading today. 
      Please check back here tomorrow. Sorry for the inconvenience,
      but the new version is worth the wait. -->
  <br>On Linux, Mac, and Windows, download
     <!-- Use: c:\content\bat\md5.bat erddapContent1.70.zip -->
    <a rel="bookmark"
    href="http://coastwatch.pfeg.noaa.gov/erddap/download/erddapContent.zip">erddapContent.zip</a>
    (version 1.70, size=26,759 bytes, MD5=97084B0ABE38D4DE88408918AD301AD9, dated 2016-04-15)

    and unzip it into <i>tomcat</i>, creating <i>tomcat</i>/content/erddap .

  <p>For Red Hat Enterprise Linux (RHEL), unzip it into ~tomcat
    and set the system property 
    <tt>erddapContentDirectory=~tomcat/content/erddap</tt>
    in ~tomcat/conf/tomcat8.conf <!-- tomcatVersion --> so ERDDAP can find the directory.
    
  <p>[Some previous versions are also available:  
    <br><a rel="bookmark"
    href="http://coastwatch.pfeg.noaa.gov/erddap/download/erddapContent1.58.zip">1.58</a>
    (size=25,000 bytes, MD5=620A54B6A52D7C95C0D1635A9FF39DC6, dated 2015-02-25)
    <br><a rel="bookmark"  href="http://coastwatch.pfeg.noaa.gov/erddap/download/erddapContent1.60.zip">1.60</a>
    (size=25,035 bytes, MD5=10332FC959B72F17E6A00AD432A38578, dated 2015-03-12)
    <br><a rel="bookmark"
    href="http://coastwatch.pfeg.noaa.gov/erddap/download/erddapContent1.62.zip">1.62</a>
    (size=25,035 bytes, MD5=4B17A93CE52087C53AF6AEA905391418, dated 2015-06-08)
    <br><a rel="bookmark"
    href="http://coastwatch.pfeg.noaa.gov/erddap/download/erddapContent1.64.zip">1.64</a>
    (size=24,996 bytes, MD5=8E375D13D388E0D290110E196117E3DC, dated 2015-08-19)
    <br><a rel="bookmark"
    href="http://coastwatch.pfeg.noaa.gov/erddap/download/erddapContent1.66.zip">1.66</a>
    (size=25,887 bytes, MD5=70B46B5E96DD17F4DCEAC27CC95BDFBB, dated 2016-01-19)
    <br><a rel="bookmark"
    href="http://coastwatch.pfeg.noaa.gov/erddap/download/erddapContent1.68.zip">1.68</a>
    (size=25,896 bytes, MD5=8E375D13D388E0D290110E196117E3DC, dated 2016-02-08)
    ]

  <p>Then,
  <ul>
  <li><a name="setup.xml">Read</a> the comments in <i>tomcat</i>/content/erddap/<b>setup.xml</b>
      and make the requested changes.
    setup.xml is the file with all of the settings which specify how your ERDDAP behaves.
    <br>For the initial setup, you MUST at least change these settings:
      <tt>&lt;bigParentDirectory&gt;, &lt;emailEverythingTo&gt;, &lt;baseUrl&gt;,
      &lt;baseHttpsUrl&gt;, &lt;email.*&gt;, &lt;admin.*&gt;</tt> 
      (and <tt>&lt;fontFamily&gt;</tt> if you are using Bitstream Vera Sans fonts).

    <p>When you create the bigParentDirectory, from the parent directory of
      bigParentDirectory:
      <ul>
      <li>Make user=tomcat the owner of the bigParentDirectory, e.g.,
        <br><tt>chown -R tomcat <i>bigParentDirectory</i></tt>
      <li>Change the "group" to be tomcat, your username, 
        or the name of a small group that includes tomcat and 
        all the administrators of Tomcat/ERDDAP, e.g., 
        <br><tt>chgrp -R <i>yourUserName</i> <i>bigParentDirectory</i></tt>
      <li>Change permissions so that tomcat and the group have 
        read, write, execute privileges, e.g,. 
        <br><tt>chmod -R ug+rwx <i>bigParentDirectory</i></tt>
      <li>Remove "other" user's permissions to read, write, or execute:
        <br><tt>chmod -R o-rwx <i>bigParentDirectory</i></tt>
          reading possibly sensitive information in ERDDAP log files
          and files with information about private datasets.
      </ul>

  <li><a name="datasets.xml">Read</a> the comments in 
      <a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html"><b>Working with the datasets.xml File</b></a>, then modify the XML in 
    <i>tomcat</i>/content/erddap/<b>datasets.xml</b> to specify all of the datasets 
      you want your ERDDAP to serve.
  <li>(Unlikely) Now or (slightly more likely) in the future, 
    if you want to modify erddap's CSS file,
    make a copy of <i>tomcat</i>/content/erddap/images/erddapStart.css called erddap.css 
    and then make changes to it.    
    Changes to erddap.css only take affect when ERDDAP is restarted 
    and often also require the user to clear the browser's cached files.
  </ul>
  After you edit the .xml files, it is a good idea to verify that the result is well-formed XML
  by pasting the XML text into an XML checker like
    <a rel="help" href="http://www.xml.com/pub/a/tools/ruwf/check.html">RUWF<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>.

  <p>In the unusual situation where you aren't allowed to modify the Tomcat directory,
  you can put the ERDDAP content directory somewhere else (e.g., /usr/local/erddap). 
  To let ERDDAP know where it is,
  set the system property erddapContentDirectory=/usr/local/erddap/content/erddap/
  (or wherever it is).
  If you aren't allowed to set this property in startup.sh, perhaps you can set it in Tomcat's context.xml.

<li><a name="erddap.war">Install</a> the erddap.war file.
  <!-- 
    <br>A New Version is Coming Tomorrow (2015-03-12)! 
    <br>So, no version is available for downloading today. 
      Please check back here tomorrow. Sorry for the inconvenience,
      but the new version is worth the wait. -->
  <br>On Linux, Mac, and Windows, download 
    <!-- use: c:\content\bat\md5.bat erddap1.70.war  
         ver, size, md5 duplicated below -->
    <a rel="bookmark"
    href="http://coastwatch.pfeg.noaa.gov/erddap/download/erddap.war">erddap.war</a> 
    (version 1.70, size=556,163,762 bytes, MD5=3320ADB87E9F3AB31EBF89260C64AF19, dated 2016-04-15)

    into <i>tomcat</i>/webapps .  
  The .war file is big because it contains high resolution coastline, boundary, 
  and elevation data needed to create maps.

  <p>[Some previous versions are also available. 
     If you download one of these, rename it erddap.war.
    <br><a rel="bookmark"
    href="http://coastwatch.pfeg.noaa.gov/erddap/download/erddap1.58.war">1.58</a> 
    (size=490,902,857 bytes, MD5=B4D1BBDA2FADD88FDCA29461C2578D3D, dated 2015-02-25)
    <br><a rel="bookmark"
    href="http://coastwatch.pfeg.noaa.gov/erddap/download/erddap1.60.war">1.60</a> 
    (size=490,919,033 bytes, MD5=99319916DA726030C25E0045A65B0971, dated 2015-03-12)
    <br><a rel="bookmark"
    href="http://coastwatch.pfeg.noaa.gov/erddap/download/erddap1.62.war">1.62</a> 
    (size=491,038,285 bytes, MD5=1FDF3F349EC7D87A4A88AD14A7B5F41A, dated 2015-06-09)
    <br><a rel="bookmark"
    href="http://coastwatch.pfeg.noaa.gov/erddap/download/erddap1.64.war">1.64</a> 
    (size=511,898,199 bytes, MD5=0E11741BF06EE5388C022F3632EE1915, dated 2015-08-19)
    <br><a rel="bookmark"
    href="http://coastwatch.pfeg.noaa.gov/erddap/download/erddap1.66.war">1.66</a> 
    (size=512,007,729 bytes, MD5=71CB248B05F0340BE6CF4CF71F3BD8E6, dated 2016-01-19)
    <br><a rel="bookmark"
    href="http://coastwatch.pfeg.noaa.gov/erddap/download/erddap1.68.war">1.68</a> 
    (size=511,995,047 bytes, MD5=0E919CBDAD014B724DE89F40C8CA9379, dated 2016-02-08)
    ]

<li><a name="ProxyPass">Use</a> ProxyPass so users don't have to put the port number, e.g., :8080, in the URL.
  <br>On Linux computers, if Tomcat is running in Apache, please modify the
  <br>/etc/httpd/conf/httpd.conf
  file to allow HTTP traffic to/from ERDDAP without requiring the port number, e.g., :8080, in the URL:
  <ol>
  <li>Modify the existing &lt;VirtualHost&gt; tag (if there is one),
    or add one at the end of the file:
<pre>
&lt;VirtualHost *:80&gt;
   ServerName <i>YourDomain.org</i>
   ProxyRequests Off
   ProxyPreserveHost On
   ProxyPass /erddap http://localhost:8080/erddap
   ProxyPassReverse /erddap http://localhost:8080/erddap
&lt;/VirtualHost&gt;
</pre>
  <li>Then restart Apache: <tt>/usr/sbin/apachectl restart</tt> (but sometimes it is in a different directory).

    <br>&nbsp;
  </ol>

<li>Start Tomcat.
  <br>(I don't recommend using the Tomcat Web Application Manager. If you don't fully shutdown and startup Tomcat, sooner or later you will have PermGen memory issues.)
  <ul>
  <li>If Tomcat is already running, use <i>tomcat</i>/bin/shutdown.sh (or \'s and .bat in Windows) 
    to shut down Tomcat.
    <br>On Linux, you may want to use <tt>ps -ef | grep tomcat</tt> to see if/when the
    process has been stopped.  (It may take a minute or two.)
  <li>Use <i>tomcat</i>/bin/startup.sh (or \'s and .bat in Windows) to start Tomcat.
    <br>&nbsp;
  </ul>

<li>Is ERDDAP running?
  <br>Use a browser to try to view http://<i>www.YourServer.org</i>/erddap/ 
  <br>ERDDAP starts up without any datasets loaded. 
  Datasets are loaded in a background thread and so become available one-by-one.

  <p><a name="LookInLogFiles">Trouble? Look in the log files.</a>
  <br>If ERDDAP won't run or some datasets won't load, look for error messages in 
  <br><a rel="help" href="#tomcatLogs">Tomcat's log file</a> (<i>tomcat</i>/logs/catalina.out) and
  <br><a rel="help" href="#log">ERDDAP's log file</a> (<i>bigParentDirectory</i>/logs/log.txt).

  <p><a name="OldVersionOfJava">Trouble: Old Version of Java</a>
  <br>If you are using a version of Java that is too old for ERDDAP,
  ERDDAP won't run and you will see an error message in Tomcat's log file like
  <br><tt>Exception in thread "main" java.lang.UnsupportedClassVersionError: 
  <br><i>some/class/name</i>: Unsupported major.minor version <i>someNumber</i></tt>
  <br>The solution is to update to the most recent version of Java
  and make sure that Tomcat is using it.

  <p><a name="SlowStartup">Trouble: Slow Startup First Time</a>
  <br>Tomcat has to do a lot of work the first time an application like 
  ERDDAP is started.
  On some servers, the first attempt to view ERDDAP stalls (30 seconds?) until 
  this work is finished.
  On other servers, the first attempt will fail immediately. But if you wait 
  30 seconds and try again,
  it will succeed if ERDDAP was installed correctly.
  <br>There is no fix for this, but it usually only occurs the first time after 
  you install a new version of ERDDAP.

<li>In the future, to shut down (and restart) ERDDAP, see 
  <br><a rel="help" href="#shutdown">How to Shut Down and Restart Tomcat and ERDDAP</a>.
  <br>&nbsp;

<li>Troubles installing Tomcat or ERDDAP?
  <br>Email me at <tt>bob dot simons at noaa dot gov</tt> .  I will help you.
    <br>Or, you can join the <a rel="help"
        href="#ERDDAPMailingList">ERDDAP Google Group / Mailing List</a> 
        and post your question there.
  <br>&nbsp;

<li>Email <a name="updateNotification">Notification</a> of New Versions of ERDDAP
  <br>If you want to receive an email whenever a new version of ERDDAP 
  is available, send an email to <tt>bob dot simons at noaa dot gov</tt> 
  requesting to be added to the ERDDAP Announcements mailing list.
  This list averages roughly one email every three months.
  <br>&nbsp;

<li><a name="customize">Customize</a> your ERDDAP to highlight your organization (not ERD).
  <ul>
  <li>To change the banner that appears at the top of all ERDDAP .html pages,
    change the HTML content specified in the setup.xml file in the &lt;startBodyHtml&gt; tag.
    For example, you could:
    <ul>
    <li>Use a different image (i.e., your organization's logo).
    <li>Change the background color.
    <li>Change "ERDDAP" to "<i>YourOrganization</i>'s ERDDAP" 
    <li>Change "Easier access to scientific data" to "Easier access to <i>YourOrganization</i>'s data".
    <li>Change the "Brought to you by" links to be links to your organization and funding sources.
    </ul>
  <li>To change the information on the left side of the home page, e.g., to 
    information about your project, change the HTML content specified in the setup.xml 
    file in the &lt;theShortDescriptionHtml&gt; tag.
  <li>To change the icon that appears on browser tabs, put your organization's favicon.ico in 
    <i>tomcat</i>/content/erddap/images/ .
    See <a rel="help"
    href="http://en.wikipedia.org/wiki/Favicon">http://en.wikipedia.org/wiki/Favicon<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>.
  </ul>

</ol>

<!-- ******* -->
<h2><a name="update">How</a> To Do an Update of an Existing ERDDAP on Your Server</h2>
<ol>
<li>Make the changes listed in 
  <a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/changes.html">Changes</a> 
  in the section entitled "Things ERDDAP Administrators Need to Know and Do"
  for all of the ERDDAP versions since the version you were using.
  <br>&nbsp;

<li>Download 
    <a rel="bookmark"
    href="http://coastwatch.pfeg.noaa.gov/erddap/download/erddap.war">erddap.war</a> 
    (version 1.70, size=556,163,762 bytes, MD5=3320ADB87E9F3AB31EBF89260C64AF19, dated 2016-04-15)
    into a temporary directory.
  <br>&nbsp;

<li><a name="messages.xml">messages.xml</a>
  <ul>
  <li>Common: If you are upgrading from ERDDAP version 1.46 (or above)
    and you just use the standard messages, 
    the new standard messages.xml will be installed automatically 
    (amongst the .class files via erddap.war).
    <br>&nbsp;
  <li>Rare: If you are upgrading from ERDDAP version 1.44 (or below), 
    <br>you MUST delete the old messages.xml file:
    <br><i>tomcat</i>/content/erddap/messages.xml .
    <br>The new standard messages.xml will be installed automatically 
    (amongst the .class files via erddap.war).
    <br>&nbsp;
  <li>Rare: If you always make changes to the standard messages, 
    <br>you need to make those changes to the new messages.xml file (which is
    <br>WEB-INF/classes/gov/noaa/pfel/erddap/util/messages.xml after erddap.war is decompressed by Tomcat).
    <br>&nbsp;
  <li>Rare: If you maintain a custom messages.xml file 
    <br>in <i>tomcat</i>/content/erddap/,
    you need to figure out (via diff) what changes have been made to the default messages.xml 
    (which are in the new erddap.war as
    <br>WEB-INF/classes/gov/noaa/pfel/erddap/util/messages.xml)
    and modify your custom messages.xml file accordingly.
    <br>&nbsp;
  </ul>

<li>Install the new ERDDAP in Tomcat:
  <ol>
  <li>(Don't use Tomcat Manager. Sooner or later there will be PermGen memory issues. 
    It is better to actually shutdown and startup Tomcat.)
  <li>From a command line, use <tt><i>tomcat</i>/bin/shutdown.sh</tt> 
    (or \'s and .bat in Windows).
    <br>On Linux, you may want to use <tt>ps -ef | grep tomcat</tt> to see if/when 
    the process has been stopped.  (It may take a minute or two.)
  <li>In <tt><i>tomcat</i>/webapps</tt>, use <tt>rm -r erddap</tt>
  <li>In <tt><i>tomcat</i>/webapps</tt>, use <tt>rm erddap.war</tt>
  <li>Copy the new erddap.war file from the temporary directory to <tt><i>tomcat</i>/webapps</tt> .
  <li>Use <tt><i>tomcat</i>/bin/startup.sh</tt> (or \'s and .bat in Windows) 
    to restart Tomcat and ERDDAP.
  <li>View ERDDAP in your browser to check that the restart succeeded.
      (Sometimes, you need to try to load ERDDAP in your browser a few times before it succeeds.)
     <br>&nbsp;
  </ol>

<li>Troubles updating ERDDAP?
  <br>Email me at <tt>bob dot simons at noaa dot gov</tt> .  I will help you.
    <br>Or, you can join the <a rel="help"
        href="#ERDDAPMailingList">ERDDAP Google Group / Mailing List</a> 
        and post your question there.

</ol>

<!-- ******* -->
<h2><a name="needToKnow">Things You Need To Know</a></h2>
<ul>

<li><b><a name="useCtrlF">Use</a> Ctrl-F To Find Things On This Web Page</b> 
<br>All of the information about administering ERDDAP 
(other than 
<a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html"
>working with datasets.xml</a>)
is on this one, very long, .html web page,
not several .html pages as some people prefer.
The advantage of one .html web page is that you can use Ctrl-F (Command-F on a Mac) 
in your web browser to search for text (for example, <tt>flag</tt>) within this web page.
<p>Alternatively, at the top of this document, there is a 
<a rel="help" href="#">list of main topics</a> (a Table of Contents).

<li><b><a name="respondingSlowly">If ERDDAP Is Responding</a> Slowly</b> 
    <br>you may be able to figure out if the slowness is reasonable 
    and temporary (e.g., because of lots of requests from scripts or WMS users),
    or if ERDDAP is having trouble and you need to 
    <a rel="help" href="#restart">shut down and restart Tomcat and ERDDAP</a>.

  <p>If ERDDAP is responding slowly, here are some things you can do to determine the cause:

  <ul>
  <li>Look for clues (e.g., error messages) in 
    <br><a rel="help" href="#log">ERDDAP's log file</a> (<i>bigParentDirectory</i>/logs/log.txt) and
    <br><a rel="help" href="#tomcatLogs">Tomcat's log file</a> (<i>tomcat</i>/logs/catalina.out). 
    <br>&nbsp;

  <li>If just one dataset is responding slowly (perhaps only for certain types of requests),
    the problem may be:
    <ul>
    <li>ERDDAP's access to the dataset's source data may be temporarily or permanently slow.
      Try to check the source's speed independent of ERDDAP. 
      If it is slow, perhaps you can improve it.
    <li>The dataset may be not optimally configured. You may be able to make changes to the dataset's
      datasets.xml chunk to help ERDDAP handle the dataset better.
      For example, the configuration of the 
<a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#subsetVariables"><tt>&lt;subsetVariables&gt;</tt></a> tag has a huge influence on how ERDDAP handles EDDTable datasets.
      Similarly, many factors influence the 
<a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#databaseSpeed">speed 
        of an EDDTableFromDatabase</a> dataset.
      If you want help speeding up a specific dataset, 
      email a description of the problem and the dataset's chunk of datasets.xml to
      <tt>bob dot simons at noaa dot gov</tt>.  
    <br>Or, you can join the <a rel="help"
        href="#ERDDAPMailingList">ERDDAP Google Group / Mailing List</a> 
        and post your question there.
      <br>&nbsp;
    </ul>

  <li>If everything in ERDDAP is <b>always</b> slow,
    the problem may be:
    <ul>
    <li>The computer that is runnning ERDDAP may not have enough memory or processing power.
        It is good to run ERDDAP on a modern, multi-core server.
        For heavy use, the server should have a 64-bit operating system and 8 GB or more of memory.
    <li>The computer that is runnning ERDDAP may be also running other applications that
        are consuming lots of system resources. If so, can you get a dedicated server
        for ERDDAP? For example (this is not an endorsement), you can get 
        a quad-core Mac Mini Server with 8 GB of memory for ~$1100.
      <br>&nbsp;
    </ul>

  <li>If everything in ERDDAP is <b>temporarily</b> slow, view your ERDDAP's 
    <br><a rel="help" href="#statusPage">/erddap/status.html page</a> in your browser.
    <ul>
    <li>Does the ERDDAP status page fail to load?
        <br>Is so, <a rel="help" href="#restart">restart ERDDAP</a>.
    <li>Did the ERDDAP status page load slowly (e.g., &gt;5 seconds)?
        <br>That is a sign that everything in ERDDAP is running slowly, 
        but it isn't necessarily trouble.
    <li>For "Response Failed Time (since last major LoadDatasets)", is n= a large number?
        <br>That indicates there have been lots of failed requests recently.
        That may be trouble or the start of trouble.
        The <tt>median</tt> time for the failures is often large (e.g., 210000 ms), 
        <br>which means that there were (are?) lots of active threads. 
        <br>which were tying up lots of resources (like memory, open files, open sockets, ...),
        <br>which is not good.
    <li>For "Response Succeeded Time (since last major LoadDatasets)", is n= a large number?
        <br>That indicates there have been lots of successful requests recently.
        This isn't trouble. It just means your ERDDAP is getting heavy use.
    <li>Is the "Number of non-Tomcat-waiting threads" double a typical value?
        <br>This is often serious trouble that will cause ERDDAP to slow down and eventually 
        freeze. 
        If this persists for hours, you may want to proactively
        <a rel="help" href="#restart">restart ERDDAP</a>.
    <li>At the bottom of the "Memory Use Summary" list, is the last "Memory: currently using" value very high?
        <br>That may just indicate high usage, or it may be a sign of trouble.
        <br>&nbsp;
    </ul>

  <li>Is your internet connection currently slow?
    <br>Search the internet for "internet speed test" and use one of the free online tests,
    such as 
    <a rel="help" href="http://www.speakeasy.net/speedtest/">http://www.speakeasy.net/speedtest//<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>.
    If your internet connection is slow, it slows down ERDDAP.
    Sometimes, you can solve this by stopping unnecessary internet use 
    (e.g., people watching streaming videos or on video conference calls).
    <br>&nbsp;

  <li>Use the "Server Status" link in your Tomcat Manager
    to check on the status of all of the response threads.  
    <br>&nbsp;

  </ul>

<li><b><a name="shutdown">How</a> 
       <a name="restart">to</a> 
       <a name="frozen">Shut</a> Down and Restart Tomcat and ERDDAP</b> 

  <br>You don't need to shut down and restart Tomcat and ERDDAP
  if ERDDAP is temporarily slow, or slow for some known reason 
  (like lots of requests from scripts or WMS users).

  <p>You do need to shut down and restart Tomcat and ERDDAP 
  if you need to apply changes to the setup.xml file,
  or if ERDDAP freezes, hangs, or locks up.

  <p>To shutdown and restart Tomcat and ERDDAP:
  &nbsp;
  <ul> 
  <li>If you use Linux or a Mac:
    <ol>
    <li>Use <tt>cd <i>tomcat</i>/bin</tt>
    <li>Use <tt>ps -u <i>tomcatUser</i> | grep java</tt> to find the java/tomcat processID
      (hopefully, just one process will be listed),
      which we'll call <tt><i>javaProcessID</i></tt> below.
    <li>If ERDDAP is frozen/hung/locked up, use <tt>kill -3 <i>javaProcessID</i></tt> 
      to tell Java (which is running Tomcat)
      to do a thread dump to the Tomcat log file 
      <br><i>tomcat</i>/logs/catalina.out.  
      After you reboot, you can diagnose the problem by finding the thread dump information 
      (and any other useful information above it) in <i>tomcat</i>/logs/catalina.out and
      also by reading relevant parts of the <a rel="help" href="#log">ERDDAP log archive</a>.
      If you want, you can email that information to <tt>bob dot simons at noaa dot gov</tt> 
      so I can see what went wrong.
      <br>Or, you can join the <a rel="help"
        href="#ERDDAPMailingList">ERDDAP Google Group / Mailing List</a> 
        and post your question there.
    <li>Use <tt>./shutdown.sh</tt>
    <li>Use <tt>ps -u <i>tomcatUser</i> | grep java</tt> repeatedly until the java/tomcat process isn't listed.

      <br>Sometimes, the java/tomcat process will take up to two minutes to shut down.  
      The reason is: ERDDAP sends a message to its background threads
      to tell them to stop, but sometimes it takes these threads up to two minutes
      to get to a good stopping place.

    <li>If you don't want to wait for java/tomcat to stop by itself, 
      you can use 
      <br><tt>kill -9 <i>javaProcessID</i></tt> 
      <br>to force the java/tomcat process to stop immediately.
      If possible, use this only as a last resort.
      The -9 switch is powerful, but it may cause various problems.

    <li>To restart ERDDAP, use <tt>./startup.sh</tt>

    <li>View ERDDAP in your browser to check that the restart succeeded.
      (Sometimes, you need to wait 30 seconds and try to load ERDDAP again 
      in your browser for it to succeed.)
      <br>&nbsp;
    </ol>

  <li>If you use Windows:
    <ol>
    <li>Use <tt>cd <i>tomcat</i>/bin</tt>
    <li>Use <tt>shutdown</tt>
    <li>You may want/need to use the Windows Task Manager (accessible via Ctrl Alt Del) 
      to ensure that the Java/Tomcat/ERDDAP process/application has fully stopped.
      <br>Sometimes, the process/application will take up to two minutes to shut down.  
      The reason is: ERDDAP sends a message to its background threads
      to tell them to stop, but sometimes it takes these threads up to two minutes
      to get to a good stopping place.
    <li>To restart ERDDAP, use <tt>startup</tt>
    <li>View ERDDAP in your browser to check that the restart succeeded.
      (Sometimes, you need to wait 30 seconds and try to load ERDDAP again 
      in your browser for it to succeed.)
      <br>&nbsp;
    </ol>

  </ul>

<li><b><a name="frequentCrashes">Frequent Crashes</a></b> - 
  If ERDDAP freezes/stops twice or more in one day, you probably have an troublesome user
  running several scripts at once and/or someone making a large number of invalid requests. 
  If this happens, you should probably blacklist that user. 
  When a blacklisted user makes a request, the error message in the response encourages 
  them to email you to work out the problems. Then, you can encourage them
  to run just one script at a time and to fix the problems in their script
  (e.g., requesting data from a remote dataset that can't respond before timing out).
  See <a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#requestBlacklist"
      >&lt;requestBlacklist&gt; in your datasets.xml file</a>.
    <br>&nbsp;

<li><b><a name="monitor">Monitor ERDDAP</a></b> - 
  My experience is that ERDDAP can run for months without needing a 
  <a rel="help" href="#restart">restart</a>. 
  But sometimes, if there is heavy use (e.g., scripts or WMS users) and especially if 
  many of the requests are failing in odd ways, 
  then ERDDAP freezes (and needs to be restarted) every few days or even every day.
  I suspect that the problem is related to the program stopping lower 
  level processing threads that froze or otherwise failed in an odd way.
  Java only offers one way for a program to stop these threads and 
  that method is not good (and deprecated) because it is highly likely that it causes 
  memory and other resource leaks. Those leaks accumulate. 
  After 1000's of leaks, 
  <a rel="help" href="#respondingSlowly">ERDDAP becomes very slow</a> 
  or freezes.  
  Unfortunately, I haven't found which resource leak is causing the problem. 
  But if you look at your ERDDAP's <a rel="help" href="#statusPage">/erddap/status.html page</a>,
  when the number on the line 
  <br><tt>Number of non-Tomcat-waiting threads in this JVM</tt>
  <br>increases significantly (e.g., doubles) and permanently (more than an hour or two),
  that is usually a sign that trouble is here or is coming soon.

  <p>If you find that you frequently need to restart ERDDAP, you might try using  
  <a rel="help" href="http://mmonit.com/monit/">Monit<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
  to monitor your ERDDAP and restart it if needed.
  Or, you could make a cron job to restart ERDDAP (proactively) periodically.
  It may be a little challenging to write a script to automate monitoring and restarting ERDDAP.
  Some tips that might help:
  <ul>
  <li>You can simplify testing if the Tomcat process is still running 
    by using the -c switch with grep:
    <br><tt>ps -u <i>tomcatUser</i> | grep -c java</tt>
    <br>That will reduce the output to "1" if the tomcat process is still alive,
    or "0" if the process has stopped.
    <br>&nbsp;
  <li>If you are good with gawk, you can extract the processID from the results of 
     <br><tt>ps -u <i>tomcatUser</i> | grep java</tt>, and use the 
     processID in other lines of the script.
    <br>&nbsp;
  </ul>
  If you do set up Monit or a cron job, please email the details to 
  <tt>bob dot simons at noaa dot gov</tt> .
    <br>Or, you can join the <a rel="help"
        href="#ERDDAPMailingList">ERDDAP Google Group / Mailing List</a> 
        and share the information there.
  <br>&nbsp;

<li><b><a name="permgen">PermGen</a></b> - 
If you repeatedly use Tomcat Manager to <tt>Reload</tt> (or <tt>Stop</tt> and <tt>Start</tt>) ERDDAP, 
  ERDDAP may fail to start up and throw <tt>java.lang.OutOfMemoryError: PermGen</tt>.
  The solution is to periodically (or every time?) 
  <a rel="help" href="#restart">shut down and restart tomcat and ERDDAP</a>,
  instead of just reloading ERDDAP.
  <br>[Update: This problem should be greatly minimized or fixed in ERDDAP version 1.24.]
  <br>&nbsp;

<li><b><a name="log">log.txt</a></b> -
  If ERDDAP doesn't start up or if something isn't working as expected, 
  it is very useful to look at the error and diagnostic messages in the ERDDAP log file.  
  <ul>
  <li>The log file is <i>bigParentDirectory</i>/logs/log.txt 
    <br>(<i>bigParentDirectory</i> is specified in <a rel="help" href="#setup.xml">setup.xml</a>).
    If there is no log.txt file or if the log.txt file hasn't been updated since
    you restarted ERDDAP, look in the <a rel="help" href="#tomcatLogs">Tomcat Log Files</a> 
    to see if there is an error message there.
  <li>Types of diagnostic messages in the log file:
    <ul>
    <li>The word "error" is used when something went so wrong that the procedure failed to complete.
      Although it is annoying to get an error, the error forces you to deal with the problem.
      Our thinking is that it is better to throw an error, than to have ERDDAP hobble along, 
      working in a way you didn't expect.
    <li>The word "warning" is used when something went wrong, but the procedure was able to complete. 
      These are pretty rare.
    <li>Anything else is just an informative message. 
      You can control how much information is logged with <tt>&lt;logLevel&gt;</tt> in 
        <a rel="help" href="#setup.xml">setup.xml</a>.
    </ul>
  <li>Information is written to the log file on the disk drive in fairly big chunks. 
    The advantage is that this is very efficient -- ERDDAP will never block
    waiting for information to be written to the log file.
    The disadvantage is that the log will almost always end with a 
    partial message, which won't be completed until the next chunk is written.
    You can make it up-to-date (for an instant) by viewing your ERDDAP's 
    status web page at http://<i>your.domain.org</i>/erddap/status.html .
  <li>When the log.txt files gets to 20 MB, 
    <br>the file is renamed log.txt.previous and a new log.txt file is created.
    So log files don't accumulate.
    <p>In setup.xml, you can specify a different maximum size for the log file, in MegaBytes.
    The minimum allowed is 1 (MB). The maximum allowed is 2000 (MB). 
    The default is 20 (MB). For example:
    <br>&lt;logMaxSizeMB&gt;20&lt;/logMaxSizeMB&gt;

  <li>Whenever you restart ERDDAP, 
    <br>ERDDAP makes an archive copy of the 
    log.txt and log.txt.previous files with a time stamp in the file's name. 
    If there was trouble before the restart, 
    it may be useful to analyze these archived files for clues as to what the trouble was.
    You can delete the archive files if they are no longer needed.
    <br>&nbsp;
  </ul>

<li><b><a name="tomcatLogs">Tomcat Log Files</a></b> - 
  If ERDDAP doesn't start up because an error occured very early in ERDDAP's startup, 
  the error message will show up in Tomcat's log files
  (<i>tomcat</i>/logs/catalina.<i>today</i>.log or 
   <i>tomcat</i>/logs/catalina.out),
  not in <a rel="help" href="#log">ERDDAP's log.txt file</a>.
  <br>&nbsp;

<li><b><a name="emailLog">emailLogYEAR-MM-DD.txt</a></b> -
  ERDDAP always writes the text of all out-going email messages 
  in the current day's emailLogYEAR-MM-DD.txt file in <i>bigParentDirectory</i>/logs 
  (<i>bigParentDirectory</i> is specified in <a rel="help" href="#setup.xml">setup.xml</a>).
  <ul>
  <li>If the server can't send out email messages, or if you have configured ERDDAP not to send 
    out email messages, or if you are just curious, this file is a convenient way to see 
    all of the email messages that have been sent out.
  <li>You can delete previous days' email log files if they are no longer needed.
    <br>&nbsp;
  </ul>

<li><b><a name="dailyReport">Daily Report</a></b> - 
  The Daily Report has lots of useful information -- all of the information from 
  your ERDDAP's <a rel="help" href="#statusPage">/erddap/status.html page</a> and more.
  <ul>
  <li>It is the most complete summary of your ERDDAP's status.
  <li>Among other statistics, it includes a list of datasets that didn't load and the exceptions 
    they generated.
  <li>It is generated when you start up ERDDAP (just after ERDDAP finishes trying to load all of 
    the datasets) and generated soon after 7 am local time every morning.
  <li>Whenever it is generated, it is written to <a rel="help" href="#log">ERDDAP's log.txt file</a>.
  <li>Whenever it is generated, it is emailed to <tt>&lt;emailDailyReportsTo&gt;</tt> and 
    <tt>&lt;emailEverythingTo&gt;</tt> (which are specified in 
    <a rel="help" href="#setup.xml">setup.xml</a>) 
    provided you have set up the email system (in setup.xml).
    <br>&nbsp;
  </ul>

<li><b><a name="statusPage">Status Page</a></b> - 
  You can view the status of your ERDDAP from any browser by going to 
  &lt;baseUrl&gt;/erddap/status.html 
  <ul>
  <li>This page is generated dynamically, so it always has up-to-the-moment statistics for your ERDDAP. 
  <li>It includes statistics regarding the number of requests, memory usage, thread stack traces, 
    the taskThread, etc.
  <li>Because the Status Page can be viewed by anyone, it doesn't include quite as much information
    as the <a rel="help" href="#dailyReport">Daily Report</a>.
    <br>&nbsp;
  </ul>

<li><b><a name="addingDatasets">Adding/Changing</a> Datasets</b> - 
  ERDDAP usually rereads datasets.xml every <tt><i>loadDatasetsMinMinutes</i></tt> 
  (specified in <a rel="help" href="#setup.xml">setup.xml</a>). 
    So you can make changes to datasets.xml any time, even while ERDDAP is running.
  <br>A new dataset will be detected soon, usually within 
    <tt><i>loadDatasetsMinMinutes</i></tt>.
  <br>A changed dataset will be reloaded when it is <tt><i>reloadEveryNMinutes</i></tt>
    old (as specified in datasets.xml).
<br>&nbsp;

<li><b><a name="flag">A Flag File</a> Tells ERDDAP to Try to <a name="reloadingDatasets">Reload</a> 
  a Dataset As Soon As Possible</b> 
  <ul>
  <li>ERDDAP won't notice any changes to a dataset's setup in datasets.xml until ERDDAP reloads the dataset.
  <li>If a dataset is active in ERDDAP and you want to force ERDDAP to reload it as soon as possible
    (before the dataset's <tt>&lt;reloadEveryNMinutes&gt;</tt> would cause it to be reloaded),
    put a file in <i>bigParentDirectory</i>/flag 
      (<i>bigParentDirectory</i> is specified in <a rel="help" href="#setup.xml">setup.xml</a>) that has the
    same name as the dataset's datasetID. 
  <li>The contents of the flag file are irrelevant.
  <li>In between major dataset reloads, ERDDAP looks continuously for flag files. 
  <li>When ERDDAP finds a flag file, it deletes the file and tries to reload the dataset very soon
    (usually within seconds).
  <li>Note that when a dataset is reloaded, all files in the 
    <i>bigParentDirectory</i>/<a rel="help" href="#cachedResponses">cache</a>/<i>datasetID</i> 
    directory are deleted.
  <li>Note that if the dataset's xml includes     
<a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#active"><tt>active="false"</tt></a>,
    a flag will cause the dataset to be made inactive 
    (if it is active), and in any case, not reloaded.
  </ul>

<p><a name="setDatasetFlag">ERDDAP</a> has a web service so that flags can be set via URLs. 
  <ul>
  <li>For example,
    <br><tt>http://coastwatch.pfeg.noaa.gov/erddap/setDatasetFlag.txt?datasetID=rPmelTao&amp;flagKey=31415926</tt>
    <br>(that's a fake flagKey) will set a flag for the rPmelTao dataset.  
  <li>There is a different flagKey for each datasetID. 
  <li>Administrators can see a list of flag URLs for all datasets by looking at the bottom of 
    their <a rel="help" href="#dailyReport">Daily Report</a> email.
  <li>Administrators should treat these URLs as confidential, since they give someone the right to
    reset a dataset at will.
  <li>If you think the flagKeys have fallen into the hands of someone who is abusing them,
    you can change <tt>&lt;flagKeyKey&gt;</tt> in <a rel="help" href="#setup.xml">setup.xml</a> and 
    restart ERDDAP
    to force ERDDAP to generate and use a different set of flagKeys.
  <li>If you change <tt>&lt;flagKeyKey&gt;</tt>, delete all of the old subscriptions (see
    the list in your Daily Report) and remember to send the new URLs to the 
    people who you do want to have them.
  </ul>

<p>The flag system can serve as the basis for a more efficient mechanism for telling ERDDAP when to 
  reload a dataset. For example, you could set a dataset's <tt>&lt;reloadEveryNMinutes&gt;</tt> 
  to a large number (e.g., 10080 = 1 week).
  Then, when you know the dataset has changed (perhaps because you added a file to the dataset's data 
  directory), set a flag so that the dataset is reloaded as soon as possible.
  Flags are usually seen quickly.  But if the LoadDatasets thread is already
  busy, it may be a while before it is available to act on the flag.
  But the flag system is much more responsive and much more efficient than setting 
  <tt>&lt;reloadEveryNMinutes&gt;</tt> to a small number.

<li><b>Force Dataset <a name="removingDatasets">Removal</a></b> - 
  If a dataset is active in ERDDAP, and you want to deactivate it as soon as 
  possible, add <a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html"><tt>active="false"</tt></a>
    to the dataset tag and set a <a rel="help" href="#flag">flag</a>.
  Flags are usually seen quickly.  But if the LoadDatasets thread is already
  busy, it may be a while before it is available to act on the flag.
  Once the dataset is not active (i.e., not visible in ERDDAP's list of datasets), 
  you can remove the dataset's description from the datasets.xml file if you want to.
  <br>&nbsp;

<li><b><a name="DatasetsReloaded">When Are Datasets Reloaded?</a></b> 
  A thread called RunLoadDatasets is the master thread that controls 
  when datasets are reloaded. RunLoadDatasets loops forever:
  <ol>
  <li>RunLoadDatasets notes the current time.
  <li>RunLoadDatasets starts a LoadDatasets thread to do a "majorLoad".  
    You can see information about the current/previous majorLoad at the top of 
    your ERDDAP's 
    <br><a rel="help" href="#statusPage">/erddap/status.html page</a>
    (<a href="http://coastwatch.pfeg.noaa.gov/erddap/status.html">status&nbsp;page&nbsp;example</a>).
    <ol>
    <li>LoadDatasets makes a copy of datasets.xml.
    <li>LoadDatasets reads through the copy of datasets.xml and, for each dataset,
       sees if the dataset needs to be (re)loaded or removed.
       <ul>
       <li>If a <a rel="help" href="#flag">flag</a> file exists for this dataset, 
         the file is deleted and 
         the dataset is removed if <tt>active="false"</tt> 
         or (re)loaded if <tt>active="true"</tt> (regardless of the dataset's age).
       <li>If the dataset's dataset.xml chunk has <tt>active="false"</tt>
         and the dataset is currently loaded (active), is is unloaded (removed).       
       <li>If the dataset has <tt>active="true"</tt> and the dataset isn't already loaded,
         it is loaded.
       <li>If the dataset has <tt>active="true"</tt> and the dataset is already loaded,
         the data set is reloaded if the dataset's age (time since last load) is greater than 
         its <tt>&lt;reloadEveryNMinutes&gt;</tt> (default = 10080 minutes),
         otherwise, the dataset is left alone.
       </ul>
    <li>LoadDatasets finishes.
    </ol>
    The RunLoadDatasets thread waits for the LoadDatasets thread to finish.
    If LoadDatasets takes longer than <tt>loadDatasetsMinMinutes</tt>
    (as specified in setup.xml), RunLoadDatasets interrupts the LoadDatasets thread.
    Ideally, LoadDatasets notices the interrupt and finishes.
    But if it doesn't notice the interrupt within a minute, 
    RunLoadDatasets calls <tt>loadDatasets.stop()</tt>, which is undesirable.

  <li>While the time since the start of the last majorLoad is less than
    <tt>loadDatasetsMinMinutes</tt> (as specified in setup.xml, e.g., 15 minutes),
    RunLoadDatasets repeatedly looks for <a rel="help" href="#flag">flag</a> files
    in the <i>bigParentDirectory</i>/flag directory.  If one or more flag files are 
    found, they are deleted, and RunLoadDatasets starts a LoadDatasets thread to do a 
    "minorLoad" (majorLoad=false).  You can't see minorLoad information on 
    your ERDDAP's <a rel="help" href="#statusPage">/erddap/status.html page</a>. 
    <ol>
    <li>LoadDatasets makes a copy of datasets.xml.
    <li>LoadDatasets reads through the copy of datasets.xml and, 
       for each dataset for which there was a flag file:
       <ul>
       <li>If the dataset's dataset.xml chunk has <tt>active="false"</tt>
         and the dataset is currently loaded (active), is is unloaded (removed).
       <li>If the dataset has <tt>active="true"</tt>, the dataset is (re)loaded,
         regardless of its age.
       </ul>
       Non-flagged datasets are ignored.
    <li>LoadDatasets finishes.
    </ol>

  <li>RunLoadDatasets goes back to step 1.
  </ol>
<br>Notes:
  <ul>
  <li><a name="DRStartup">Startup</a>
    <br>When you restart ERDDAP, every dataset with <tt>active="true"</tt> is loaded.
  <li><a name="DRCache">Cache</a>
    <br>When a dataset is (re)loaded, its cache (including any data response files
    and/or image files) is emptied.  
  <li><a name="DRLotsOfDatasets">Lots of Datasets</a>
    <br>If you have a lot of datasets and/or one or more datasets are slow to (re)load,
    a LoadDatasets thread may take a long to finish its work,
    perhaps even longer than <tt>loadDatasetsMinMinutes</tt>.
  <li><a name="DROneLoadDatasetsThread">One LoadDatasets Thread</a>
    <br>There is never more than one LoadDatasets thread running at once.
    If a flag is set when LoadDatasets is already running,
    the flag probably won't be noticed or acted on until that LoadDatasets thread finishes running.
    You might say: "That's stupid. Why don't you just start a bunch of new threads
    to load datasets?"  But if you have lots of datasets which get data from
    one remote server, even one LoadDatasets thread will put substantial stress
    on the remote server.  The same is true if you have lots of datasets which get data from 
    files on one RAID.  There are rapidly diminishing returns from having 
    more than one LoadDatasets thread.
  <li><a name="DRFlagASAP">Flag = ASAP</a>
    <br>Setting a flag just signals that the dataset should be (re)loaded
    as soon as possible, not necessarily immediately.
    If no LoadDatasets thread is currently running, the dataset will start to be reloaded
    within a few seconds.
    But if a LoadDatasets thread is currently running, the dataset probably won't be reloaded
    until after that LoadDatasets thread is finished.
  <li><a name="DRFlagFileDeleted">Flag File Deleted</a>
    <br>In general, if you put a flag file in the <tt><i>bigParentDirectory</i>/erddap/flag</tt>
    directory (by visiting the dataset's flagUrl or putting an actual file there), the
    dataset will usually be reloaded very soon after that flag file is deleted.    
  <li><a name="DRFlagVsReloadEveryNMinutes">Flag vs. Small <tt>reloadEveryNMinutes</tt></a>
    <br>If you have some external way of knowing when a dataset needs to be reloaded
    and if it is convenient for you,
    the best way to make sure that a dataset is always up-to-date is to 
    set its <tt>reloadEveryNMinutes</tt> to a large number (10080?) and
    set a flag (via a script?) whenever it needs to be reloaded.
    That is the system that EDDGridFromErddap and EDDTableFromErddap use
    receive messages that the dataset needs to be reloaded.
  <li><a name="DRLookInLog">Look in log.txt</a>
    <br>Lots of relevant information is written to the 
    <i>bigParentDirectory</i>/logs/log.txt file.
    If things aren't working as you expect, looking at log.txt
    lets you diagnose the problem by finding out exactly what ERDDAP did.
    <ul>
    <li>Search for "majorLoad=true" for the start of major LoadDataset threads.
    <li>Search for "majorLoad=false" for the start of minor LoadDatasets threads.
    <li>Search for a given dataset's datasetID for information about it being
       (re)loaded or queried.
    </ul>
    <br>&nbsp;
  </ul>

<li><b><a name="cachedResponses">Cached Responses</a></b> -
  In general, ERDDAP doesn't cache (store) responses to user requests.
  The rationale was that most requests would be slightly different so the cache wouldn't be very effective.
  The biggest exceptions are requests for image files 
  (which are cached since browsers and programs like Google Earth often re-request images) 
  and requests for .nc files (because they can't be created on-the-fly).
  ERDDAP stores each dataset's cached files in a different directory:
    <i>bigParentDirectory</i>/cache/<i>datasetID</i> 
  since a single cache directory might have a huge number of files which might become slow to access.
  <br>Files are removed from the cache for one of three reasons:
  <ul>
  <li> All files in this cache are deleted when ERDDAP is restarted.
  <li> Periodically, any file more than <tt>&lt;cacheMinutes&gt;</tt> old (as specified in 
    <a rel="help" href="#setup.xml">setup.xml</a>) will be deleted.  
    Removing files in the cache based on age (not Least-Recently-Used) ensures that files won't stay 
    in the cache very long.
    Although it might seem like a given request should always return the same response, that isn't true.
    For example, a tabledap request which includes <tt>&amp;time><i>someTime</i></tt> will change if 
    new data arrives for the dataset.
    And a griddap request which includes <tt>[last]</tt> for the time dimension will change if new 
    data arrives for the dataset.
  <li>Images showing error conditions are cached, but only for a few minutes (it's a difficult situation).
  <li>Every time a dataset is reloaded, all files in that dataset's cache are deleted.
    Because requests may be for the "last" index in a gridded dataset, files in the cache may become
    invalid when a dataset is reloaded.
    <br>&nbsp;
  </ul>

<li><b><a name="storedDatasetInformation">Stored Dataset Information</a></b> -
  <br>For all types of datasets, ERDDAP gathers lots of information when a dataset 
  is loaded and keeps that
  in memory. This allows ERDDAP to respond very quickly to searches, requests
  for lists of datasets,
  and requests for information about a dataset.

  <p>For a few types of datasets (notably EDDGridCopy, EDDTableCopy, 
  EDDGridFrom<i>Xxx</i>Files, and
  EDDTableFrom<i>Xxx</i>Files), ERDDAP stores on disk some information about the
  dataset that is reused 
  when the dataset is reloaded. This greatly speeds the reloading process.  
  <ul>
  <li>Some of the dataset information files are human-readable .json files and are stored in
    <i>bigParentDirectory</i>/dataset/<i>last2LettersOfDatasetID/datasetID</i> .
  <li>ERDDAP only deletes these files in unusual situations, e.g., if you add
    or delete a variable from the dataset's datasets.xml chunk.
  <li>Most changes to a dataset's datasets.xml chunk (e.g., changing a
    global attribute or a variable attribute) don't necessitate that you delete these files. 
    A regular dataset reload will handle these types of changes.
    You can tell ERDDAP to reload a dataset ASAP by setting a 
    <a rel="help" href="#flag">flag</a> for the dataset.
  <li>Similarly, the addition or deletion of files will be handled when 
    ERDDAP reloads a dataset. 
    But ERDDAP will notice this type of change soon and automatically 
    if the dataset is using the 
    <a rel="help"  
    href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#updateEveryNMillis"
    ><tt>&lt;updateEveryNMillis&gt;</tt></a>
    system.
  <li>It should only rarely be necessary for you to delete these files.
    The most common situation where you need to force ERDDAP to delete the stored
    information (because it is out-of-date/incorrect and won't be automatically 
    fixed by ERDDAP)
    is when you make changes
    to the dataset's datasets.xml chunk that affect how ERDDAP interprets 
    data in the source data files, for example, changing the time variable's format string.
  <li>To delete a dataset's stored information files, run 
    <a rel="help"  
    href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#DasDds"
    >DasDds</a>
    (which is easier than figuring in which directory the info is located and 
    deleting the files by hand).
    Then, if ERDDAP is running, set a <a rel="help" href="#flag">flag</a>
    so that the dataset will be reloaded ASAP.
    Remember that if a dataset is an aggregation of a large number of files,
    reloading the dataset may take considerable time.
    <br>&nbsp;
  </ul>

<li><b><a name="requestsFailed">Unusual Activity: >25% of requests failed</a></b> - 
<br>You will probably get an email from ERDDAP periodically with the subject 
"Unusual Activity: >25% of requests failed". It is worth figuring out what is going wrong.
The only way to figure out what is going wrong is to read the 
[bigParentDirectory]/logs/log.txt file and search for "error". 
For each error message, look just above it to find the line where the original request is logged.
The line starts with "{{{{#" and includes the user's IP number and the actual request.

<p>Use the user's IP number (for example, with 
<a rel="help" href="http://network-tools.com/">http://network-tools.com/<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>)
to try to figure who or what the user is.
Sometimes that will tell you pretty accurately who the user is (e.g., it's a search engine's web crawler).
Most of the time it just gives you a clue 
(e.g., it's an amazonaws computer, it's from some university, 
it's someone in Washington State (no offense intended; I like Washington)).

<p>By looking at the actual request, the IP number, and the error message (all from log.txt) for
a series of errors, you can usually figure out basically what is going wrong.
In my experience, there are three common causes of lots of failed requests:

<p>1) A search engine is naively trying the URLs listed in ERDDAP web pages and 
ISO 19115 documents. For example, there are many places which list the base OPeNDAP URL, for example,
http://coastwatch.pfeg.noaa.gov/erddap/griddap/jplMURSST, to which the user is 
supposed to add a file type (e.g., .das, .dds, .html). 
But the search engine doesn't know this. And the request to the base URL fails. 
A related situation is when the search engine generates bizarre requests or 
tries to fill out forms in order to get to "hidden" web pages. 
But the search engines often do a bad job of this, leading to failures. 
The solution is: create a <a rel="help" href="#robots">robots.txt</a> file.

<p>2) Some user is running a script that is repeatedly asking for something that isn't there. 
Maybe it is a dataset that used to exist, but is gone now (temporarily or permanently).
Scripts often don't expect this and so don't deal with it intelligently. 
So the script just keeps making requests and the requests keep failing.  
If you can guess who the user is (from the IP number above), contact them 
and tell them the dataset is no longer available and ask them to change their script.

<p>3) Something is really wrong with some dataset. Usually, ERDDAP will 
make the troubled dataset inactive. Sometimes it doesn't, so all the requests
to it just lead to errors. If so, fix the problem with the dataset or (if you can't)
set the dataset to 
<a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#active">active="false"</a>.
Of course, this may lead to problem #2.

<p>Sometimes the errors aren't so bad, notably, if ERDDAP can detect the error
and respond very quickly (&lt;=1ms). So you may decide to take no action.

<p>If all else fails, there is a universal solution: 
add the user's IP number to the <a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#requestBlacklist">&lt;requestBlacklist&gt;</a>.
This isn't as bad or as drastic an option as it might seem. 
The user will then get an error message saying s/he has been blacklisted and 
telling them your (the ERDDAP administrator's) email address.  
Sometimes the user will contact you and you can resolve the problem. 
Sometimes the user doesn't contact you and you will see the exact same behavior 
coming from a different IP number the next day. 
Blacklist the new IP number and hope that they will eventually get the message.
(Or this is your Groundhog Day, from which you will never escape. Sorry.)

<li><b><a name="robots">robots.txt</a></b> - 
  The search engine companies use web crawlers (e.g., GoogleBot) to examine all of
  the pages on the web to add the content to the search engines.
  For ERDDAP, that is basically good.  ERDDAP has lots of links between pages, so the crawlers
  will find all of the web pages and add them to the search engines. 
  Then, users of the search engines will be able to find datasets on your ERDDAP.

  <p>Unfortunately, some web crawlers (e.g., GoogleBot) are now filling out and submitting
  forms in order to find additional content.  For web commerce sites, this is great. 
  But this is terrible for ERDDAP because it just leads to an <b>infinite</b> number of
  undesirable and pointless attempts to crawl the actual data. 
  This can lead to more requests for data than from all other users combined.
  And it fills the search engine with goofy, pointless subsets of the actual data.

  <p>To tell the web crawlers to stop filling out forms and just generally not 
    looking at web pages they don't need to look at, you need to create a text file called 
  <a rel="help" href="http://en.wikipedia.org/wiki/Robots_exclusion_standard">robots.txt<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> 
  in the root directory of your web site's document hierarchy so that it can be viewed by 
  anyone as, e.g., http://www.example.com/robots.txt .
  <br>If you are creating a new robots.txt file, this is a good start:
    <pre>
User-Agent: *
Disallow: /erddap/files/ 
Disallow: /files/ 
Disallow: /images/ 
Disallow: /*?
Disallow: /*?*
Disallow: /*.asc*
Disallow: /*.csv*
Disallow: /*.dods*
Disallow: /*.esriAscii*
Disallow: /*.esriCsv*
Disallow: /*.geoJson*
Disallow: /*.htmlTable*
Disallow: /*.json*
Disallow: /*.mat*
Disallow: /*.nc*
Disallow: /*.odvTxt*
Disallow: /*.tsv*
Disallow: /*.xhtml*
Disallow: /*.geotif*
Disallow: /*.kml*
Disallow: /*.pdf*
Disallow: /*.png*
Disallow: /*.large*
Disallow: /*.small*
Disallow: /*.transparentPng*
Sitemap: http://<b><i>your.institutions.url</i></b>/erddap/sitemap.xml</pre>
  (But replace <i>your.institutions.url</i> with your ERDDAP's base URL.
  <br>It may take a few days for the search engines to notice and for the changes to take effect.
  <br>&nbsp;

<li><b><a name="sitemap">sitemap.xml</a></b> - As the
  <a rel="help" href="http://www.sitemaps.org/">www.sitemaps.org<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> web site says:
  <blockquote>Sitemaps are an easy way for webmasters to inform search engines about pages on their 
  sites that are available for crawling. In its simplest form, a Sitemap is an XML file that lists
  URLs for a site along with additional metadata about each URL (when it was last updated, how
  often it usually changes, and how important it is, relative to other URLs in the site) so that
  search engines can more intelligently crawl the site.

  <p>Web crawlers usually discover pages from links within the site and from other sites. Sitemaps
  supplement this data to allow crawlers that support Sitemaps to pick up all URLs in the Sitemap
  and learn about those URLs using the associated metadata. Using the Sitemap protocol does not
  guarantee that web pages are included in search engines, but provides hints for web crawlers
  to do a better job of crawling your site.
  </blockquote>
  Actually, since ERDDAP is RESTful, search engine spiders can easily crawl your ERDDAP.
  But they tend to do it more often (daily!) than necessary (monthly?).
  <ul>
  <li>Given that each search engine may be crawling your entire ERDDAP every day,
    this can lead to a lot of unnecessary requests.
  <li>So ERDDAP generates a sitemap.xml file for your ERDDAP which tells search engines 
    that your ERDDAP only needs to be crawled every month.
  <li>You should add a refernce to ERDDAP's sitemap.xml to your 
     <a rel="help" href="http://en.wikipedia.org/wiki/Robots_exclusion_standard">robots.txt<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> file:
     <br>&nbsp;&nbsp;<tt>Sitemap: http://<b>www.yoursite.org</b>/erddap/sitemap.xml</tt>
  <li>If that doesn't seem to be getting the message to the crawlers, you can tell the various search 
    engines about the sitemap.xml file by visiting these URLs (but change <b>YourInstitution</b> 
    to your institution's acronym or abbreviation and <b>www.yoursite.org</b> to your ERDDAP's URL):
    <ul> <!-- from http://rapid-dev.net/tag/ping-bing-sitemap/ -->
    <li>http://submissions.ask.com/ping?sitemap=http://<b>www.yoursite.org</b>/erddap/sitemap.xml
    <li>http://www.bing.com/webmaster/ping.aspx?siteMap=http://<b>www.yoursite.org</b>/erddap/sitemap.xml
    <li>http://www.google.com/ping?sitemap=http://<b>www.yoursite.org</b>/erddap/sitemap.xml    <li>http://search.yahooapis.com/SiteExplorerService/V1/updateNotification?appid=<b>YourInstitution</b>_ERDDAP&amp;url=http://<b>www.yoursite.org</b>/erddap/sitemap.xml
    </ul>
    (I think) you just need to ping each search engine once, for all time. 
    The search engines will then detect changes to sitemap.xml periodically.
  </ul>
<br>&nbsp;

<li><b><a name="pushPull">Data Dissemination / Data Distribution Networks: Push and Pull Technology</a></b> 
  <ul>
  <li>Normally, ERDDAP acts as an intermediary: it takes a request from a user; 
    gets data from a remote data source; reformats the data; and sends it to the user.
  <li><a rel="help" href="http://en.wikipedia.org/wiki/Pull_technology">Pull Technology<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>: 
    ERDDAP also has the ability to actively get all of the available data  
    from a remote data source and 
    <a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#EDDGridCopy">store 
    a local copy of the data</a>.
  <li><a rel="help" href="http://en.wikipedia.org/wiki/Push_technology">Push Technology<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>: 
    By using ERDDAP's 
    <a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/information.html#subscriptions">subscription services</a>, 
    other data servers can be notified as soon 
    as new data is available so that they can request the data (by pulling the data).
  <li>ERDDAP's 
<a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#EDDGridFromErddap">EDDGridFromErddap</a> and
<a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#EDDTableFromErddap">EDDTableFromErddap</a> use ERDDAP's subscription services and 
    <a rel="help" href="#flag">flag system</a> so that it will be notified immediately when new data is available. 
  <li>You can combine these to great effect: if you wrap an EDDGridCopy around an EDDGridFromErddap 
    dataset (or wrap an EDDTableCopy around an EDDTableFromErddap dataset),
    ERDDAP will automatically create and maintain a local copy of another ERDDAP's dataset.
  <li>Because the subscription services work as soon as new data is available,
    push technology disseminates data very quickly (within seconds).
  </ul>

  <p>This architecture puts each ERDDAP administrator in charge of determining where the data 
  for his/her ERDDAP comes from.
  <ul>
  <li>Other ERDDAP administrators can do the same.  There is no need for coordination between 
    administrators.
  <li>If many ERDDAP administrators link to each other's ERDDAPs, a data distribution network is formed.
  <li>Data will be quickly, efficiently, and automatically disseminated from data sources 
    (ERDDAPs and other servers) to data re-distribution sites (ERDDAPs) anywhere in the network.
  <li>A given ERDDAP can be both a source of data for some datasets and a re-distribution site for other
    datasets.
  <li>The resulting network is roughly similar to data distribution networks set up with programs like 
    <a rel="help" href="http://www.unidata.ucar.edu/software/idd/">Unidata's IDD/IDM<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>, but less rigidly structured.
    <br>&nbsp;
  </ul>


<li><b><a name="security">Security</a>, Authentication, and Authorization</b> -
By default, ERDDAP 
runs as an entirely public server (using http and/or https)  
with no login  
(<a rel="help" href="http://en.wikipedia.org/wiki/Authentication">authentication<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>) 
system and no restrictions to data access 
(<a rel="help" href="http://en.wikipedia.org/wiki/Authorization">authorization<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>). 

<p>If you want to restrict access to some or all datasets to some users, you can use ERDDAP's
built-in security system. When the security system is in use:
<ul>
<li>ERDDAP uses 
    <a rel="help" href="http://en.wikipedia.org/wiki/Role-based_access_control">role-based access control<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>.
  <ul>
  <li>The ERDDAP administrator defines users with the
    <a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#user"><tt>&lt;user&gt;</tt></a>
    tag in datasets.xml.
    Each user has a username, a password (if <tt>authentication=custom</tt>), 
    and one or more roles. 
  <li>The ERDDAP administrator defines which roles have access to a given dataset via the
    <a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#accessibleTo"><tt>&lt;accessibleTo&gt;</tt></a>
    tag in datasets.xml for any dataset that shouldn't have public access.
  </ul>
<li>The user's log in status (and a link to log in/out) will be shown at the top
  of every web page.
  (But a logged in user will appear to ERDDAP to be not logged in if he uses an http URL.)
<li>If the &lt;baseUrl&gt; that you specify in your setup.xml is an <b>http</b> URL,
  users who are not logged in may use ERDDAP's <b>http</b> URLs.
  If &lt;baseHttpsUrl&gt; is also specified, users who are not logged in 
  can also use https URLs.
<li>If the &lt;baseUrl&gt; that you specify in your setup.xml is an <b>https</b> URL,
  users who are not logged are encouraged to use ERDDAP's <b>https</b> URLs --
  all of the links on ERDDAP web pages will refer to https URLs.
  But the only way to force users to use https URLs is by blocking
  use of the http URLs via Apache + Tomcat.
  A reason not to force users to use https URLs is: 
  the underlaying SSL/TLS link takes time to establish and
  then takes time to encrypt and decrypt all information transmitted between
  the user the the server.
<li>Users who are logged in MUST use ERDDAP's <b>https</b> URLs.
  If they use http URLs, they appear to ERDDAP to be not logged in.
  This ensures the privacy of the communications and 
  helps prevent 
    <a rel="help" href="http://en.wikipedia.org/wiki/Session_hijacking"
    >session hijacking and sidejacking<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>.    
<li>Anyone who isn't logged in can access and use the public datasets.
  By default, private datasets don't appear in lists of datasets if a user isn't logged in.
  If the administrator has set setup.xml's <tt>&lt;listPrivateDatasets&gt;</tt> to true, 
  they will appear.
  Attempts to request data from private datasets (if the user knows the URL) will be redirected
  to the login page.
<li>Anyone who is logged in will be able to see and request data from any public dataset
  and any private dataset to which their role allows them access.
  By default, private datasets to which a user doesn't have access don't appear in lists of datasets.
  If the administrator has set setup.xml's <tt>&lt;listPrivateDatasets&gt;</tt> to true, 
  they will appear.
  Attempts to request data from private datasets to which the user doesn't have access will be 
  redirected to the login page.
<li>The RSS information for all datasets, even private datasets, 
  is always available to anyone.
  (This is not ideal. But RSS readers won't ever log in, so they need access 
  without logging in.)
  But, since private datasets that aren't accessible aren't advertised, 
  their RSS links are not advertised either.
<li>Email subscriptions can only be set up when a user has access to a dataset.
  If a user subscribes to a private dataset, the subscription 
  continues to function after the user has logged out.
</ul>

<p>To set up the security/authentication/authorization system:
<ul>
<li>Do the standard ERDDAP <a rel="help" href="#initialSetup">initial setup</a>.
<li>In <a rel="help" href="#setup.xml">setup.xml</a>, 
  <ul>
  <li>Add/change the <tt>&lt;authenticate&gt;</tt> value from nothing to 
    <tt>custom</tt>, <tt>email</tt>, or <tt>google</tt> (recommended).
    See the comments about these options below.
  <li>Add/change the <tt>&lt;baseHttpsUrl&gt;</tt> value. 
  <li>Insert/uncomment <tt>&amp;loginInfo;</tt> in <tt>&lt;startBodyHtml&gt;</tt> to display 
    the user's log in/out info 
    at the top of each web page.
  </ul>
<li>For testing purposes on your personal computer, 
  <a rel="help" href="http://tomcat.apache.org/tomcat-8.0-doc/ssl-howto.html"
    >follow these instructions to configure tomcat to support SSL<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
      (the basis for https connections) by creating a keystore with a 
   <a rel="help" href="http://en.wikipedia.org/wiki/Self-signed_certificate"
     >self-signed certificate<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
    and by modifying <i>tomcat</i>/conf/server.xml to uncomment the connector for port 8443.
    On Windows, you may need to move .keystore from "c:\Users\<i>you</i>\.keystore" to 
    "c:\Users\Default User\.keystore"  or "c:\.keystore" 
    (see <i>tomcat</i>/logs/catalina.<i>today</i>.log if the application doesn't 
    load or users can't see the log in page).
    You can see when the .keystore certificate will expire by examining the 
    certificate when you log in.  
  <p>For a publicly accessible server, instead of using a self-signed certificate, 
    it is strongly recommended that you buy and install a certificate signed by a 
     <a rel="help" href="http://en.wikipedia.org/wiki/Certificate_authority">certificate authority<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>, 
     because it gives your clients more assurance that they are indeed connecting to your
    ERDDAP, not a man-in-the-middle's version of your ERDDAP.
    Many vendors sell digital certificates. (Search for web.) They are not expensive. 
<li>On Linux computers, if Tomcat is running in Apache, modify the 
  /etc/httpd/conf.d/ssl.conf
  file to allow HTTPS traffic to/from ERDDAP without requiring the :8443 port number
  in the URL:
  <ol>
  <li>Modify the existing &lt;VirtualHost&gt; tag (if there is one),
    or add one at the end of the file so that it at least has these lines:
<pre>
&lt;VirtualHost _default_:443&gt;
   SSLEngine on
   SSLProxyEngine On
   ProxyPass /erddap http://localhost:8443/erddap
   ProxyPassReverse /erddap http://localhost:8443/erddap
&lt;/VirtualHost&gt;
</pre>
  <li>Then restart Apache: <tt>/usr/sbin/apachectl restart</tt> (but sometimes it is in a different directory).
  </ol>

<li>In <i>tomcat</i>/conf/server.xml, uncomment the port=8443 &lt;Connector&gt; tag:
<pre>
&lt;Connector port="8443" protocol="org.apache.coyote.http11.Http11NioProtocol"
    maxThreads="150" SSLEnabled="false" scheme="https" secure=“true"
    proxyPort="443" clientAuth="false" sslProtocol="TLS" /&gt;
</pre>
<li><a name="authorization">In</a> datasets.xml, create a 
  <a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#user"><tt>&lt;user&gt;</tt></a>
  tag for each user with username, password (if <tt>authorization=custom</tt>), 
    and roles information.
  This is the authorization part of ERDDAP's security system.
<li>In datasets.xml, add an
  <a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#accessibleTo"
  ><tt>&lt;accessibleTo&gt;</tt></a>
  tag to each dataset that shouldn't have public access.
  <tt>&lt;accessibleTo&gt;</tt> lets you specify which roles have access to that dataset.
<li>Restart Tomcat.
  Trouble? Check the Tomcat logs.
<li>CHECK YOUR WORK! Any mistake could lead to a security flaw.
<li>Check that the login page uses https (not http).
  Attempts to login via http should be automatically redirected to 
  https and port 8443 (although the port number may be hidden via an Apache proxy).
  You may need to work with your network administrator to allow external web 
  requests to access port 8443 on your server.
<li>You can change the <tt>&lt;user&gt;</tt> and <tt>&lt;accessibleTo&gt;</tt> 
  tags at any time.
  The changes will be applied at the next regular reload of any dataset,
  or ASAP if you use a <a rel="help" href="#flag">flag</a>. 
</ul>

<p><a name="authentication">Authentication (logging in)</a>
  <br>Currently, ERDDAP supports 
  <tt>custom</tt>, <tt>email</tt>, and <tt>google</tt>
  <!-- a rel="help" href="http://openid.net/"><tt>openid</tt><img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> -->
      (recommended) authentication.
We strongly recommend the <tt>google</tt> option because it frees you from storing
and handling user's passwords (needed for <tt>custom</tt>)
and is more secure than the <tt>email</tt> option.
Remember that users often use the same password at different sites.
So they may be using the same password for your ERDDAP as they do at their bank.
That makes their password very valuable -- much more valuable to the user than 
the data they are requesting.
So you need to do as much as you can to keep the passwords private.
That is a big responsibility.
The <tt>email</tt> and <tt>google</tt> options take care of passwords, 
so you don't have to gather, store, or work with them. 
So you are freed from that responsibility.

<p>All authentication options use a 
    <a rel="help" href="http://en.wikipedia.org/wiki/HTTP_cookie">cookie<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> 
    on the user's computer, so the user's browser must be 
  set to allow cookies.  If a user is making ERDDAP requests from a computer
  program (not a browser), cookies are hard to work with. Sorry.


<p>The details of the authentication options are:
<ul>
<li><a name="authenticationCustom"><tt><b>custom</b></tt></a>
  <br><tt>custom</tt> is ERDDAP's custom system for letting users log in by 
  entering their User Name and Password in a form on a web page.
  If a user tries and fails to log in 3 times within 10 minutes, 
  the user is blocked from trying to log in for 10 minutes. 
  This prevents hackers from simply trying millions
  of passwords until they find the right one.

  <p>This is secure because the User Name and Password are transmitted via https 
  (not http),
  but <tt>authentication=google</tt> is better because it frees you from
  having to handle passwords.
  The <tt>custom</tt> approach requires you to collect a user's Name and 
  a hash digest of their Password 
  (use your phone! email isn't secure!) and store them in datasets.xml in  
    <a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#user"><tt>&lt;user&gt;</tt></a> tags.

  <p>With the <tt>custom</tt> option, no one can log in until you 
  (the ERDDAP administrator) create a <tt>&lt;user&gt;</tt> tag for the user,
  specifying the user's name as the username, 
  the hash digest of their password as the password, and their roles.

  <p>Not Recommended
  <br>Because of the awkwardness of generating and transmitting the hash digest
  of the user's password and because of the risks associated with 
  ERDDAP holding the hash digests of the passwords, 
  this option is not recommended.

  <p>To increase the security of this option:
  <ul>
  <li>Use <tt>UEPSHA256</tt> for <tt>&lt;passwordEncoding&gt;</tt>
    in setup.xml.
  <li>Use an as-secure-as-possible method to pass the hash digest
    of the user's password from the user to the ERDDAP administrator (phone?).
  <li>Make sure that other users on the server (i.e., Linux users, not ERDDAP users) 
    can't read files in the Tomcat directory or ERDDAP's bigParentDirectory. 
    <br>On Linux, as user=tomcat, use: 
    <br><tt>chmod -R g-rwx <i>bigParentDirectory</i></tt>
    <br><tt>chmod -R g-rwx <i>tomcatDirectory</i></tt>
    <br>&nbsp;
  </ul>

<!--li><a rel="help" href="http://openid.net/"><tt>openid</tt><img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> 
  is an open standard that lets users log 
  in with your password at one web site
  and then log in without your password at many other web sites, including ERDDAP.
  OpenID is very convenient for ERDDAP administrators -- you don't ever have to deal with passwords.
  All you need is a user's OpenID URL (which is public information) 
  so that you can define the users and their roles in datasets.xml with 
     <a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#user"><tt>&lt;user&gt;</tt></a> tags.
  -->

<li><a name="authenticationEmail"><tt><b>email</b></tt></a>
  <br>The <tt>email</tt> authentication option uses a user's email account 
  to authenticate the user (by sending them an email with a special link
  that they have to access in order to log in).
  Unlike other emails that ERDDAP sends, ERDDAP does not write these 
  invitation emails to the email log file because they contain confidential 
  information.
  <br>In theory, this is not very secure, because emails aren't always encrypted,
  so a bad guy with the ability to intercept emails could abuse this system
  by using a valid user's email address and intercepting the invitation email.
  <br>In practice, if you set up ERDDAP to use a Google email account to send emails,
  and if you set it up to use one of the TLS options for the connection, 
  and if the user has a Google email account, this is somewhat secure because
  the emails are encrypted all the way from ERDDAP to the user.

  <p>To increase the security of this option:
  <ul>
  <li>Make sure that other users on the server (i.e., Linux users, not ERDDAP users) 
    can't read files in the Tomcat directory or ERDDAP's bigParentDirectory. 
    <br>On Linux, as user=tomcat, use: 
    <br><tt>chmod -R g-rwx <i>bigParentDirectory</i></tt>
    <br><tt>chmod -R g-rwx <i>tomcatDirectory</i></tt>
  <li>Set things up to get end-to-end security for the emails
    sent from ERDDAP to the users.
    For example, you could make a Google-centric system by 
    only creating &lt;user&gt; tags for Google-managed email addresses
    and by setting up your ERDDAP to use a Google email server 
    via a secure/TLS connection: in your setup.xml, use e.g., <tt>
    <br>&lt;emailSmtpHost&gt;smtp.gmail.com&lt;/emailSmtpHost&gt;
    <br>&lt;emailSmtpPort&gt;587&lt;/emailSmtpPort&gt;
    <br>&lt;emailProperties&gt;mail.smtp.starttls.enable|true&lt;/emailProperties&gt;</tt>
  </ul>

  <p>Not Recommended
  <br>We only recommend the <tt>email</tt> authentication option only as a 
  temporary alternative to the 
  <a rel="help" href="#authenticationGoogle"><tt>google</tt> authentication option</a>,
  and only if you follow the security suggesions above. 
  The weakness of the <tt>google</tt> option is that it 
  relies on an external authentication system (Google Sign-In),
  which may suddenly cease
  to work with ERDDAP, leaving your users unable to log in. In that case,
  switching temporarily to the <tt>email</tt> option solves the problem
  until the <tt>google</tt> option is again working.

  <p>As with the <tt>google</tt> option, <tt>email</tt> is very convenient for 
  ERDDAP administrators -- 
  you don't ever have to deal with passwords or their hash digests.
  All you need to create is a 
  <a rel="help" 
  href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#user"
  ><tt>&lt;user&gt;</tt></a>
  tag for a user in datasets.xml is the user's Google email address,
  which ERDDAP uses as the user's name.
  (The <tt>password</tt> attribute isn't used when authentication=email or google.)

  <p>With the <tt>email</tt> option, only users that have a <tt>&lt;user&gt;</tt> tag
  in datasets.xml can try to log in to ERDDAP by providing their
  email address and clicking on the link in the email that ERDDAP sends them.

  <p>ERDDAP treats email addresses as case-insensitive. It does this by
  converting email addresses you enter (in &lt;user&gt; tags)
  or users enter (on the login form) to their all lowercase version.

  <p>To set up authentication=email:
  <ul>
  <li>In your setup.xml, change the &lt;baseHttpsUrl&gt; tag's value.
    <br>For experimenting/working on your personal computer, use 
    <br><tt>https://localhost:8443</tt>
    <br>For your public ERDDAP, use
    <br><tt>https://<i>your.domain.org</i>:8443</tt> 
    <br>or without the :8443 if you are using an Apache 
    <a rel="help" href="#ProxyPass">proxypass</a> so that the port number isn't needed.

  <li>In your setup.xml, change the &lt;authentication&gt; tag's value to <tt>email</tt>:
    <br><tt>&lt;authentication&gt;email&lt;/authentication&gt;</tt>

  <li>In your setup.xml, make sure the email system is setup via all of the
    <tt>&lt;email...&gt;</tt> tags, so that ERDDAP can send out emails.
    If possible, set this up to use a secure connection (SSL / TLS) to the email server.

  <li>In your datasets.xml, create 
    <a rel="help" 
      href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#user"
      ><tt>&lt;user&gt;</tt></a>    
    tags for each user who will have access to private datasets.
    <br>Use the user's email address as the <tt>username</tt> in the tag.
    <br>Don't specify the <tt>password</tt> attribute for the user. 

  <li>Restart ERDDAP so that the changes to setup.xml and datasets.xml take effect.
    <br>&nbsp;
  </ul>

  
<li><a name="authenticationGoogle"><tt><b>google</b></tt></a>  (recommended)
  <br>The <tt>google</tt> option uses 
  <a rel="help" href="https://developers.google.com/identity/sign-in/web/"
  >Google Sign-In<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>, 
  which is based on 
  <a rel="help" href="http://oauth.net/2/"
  >OAuth 2.0<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>,
  the current version of the OAuth protocol.

  <p>The <tt>google</tt> option lets users log in by signing into their
  Google email account, 
  including Google-managed accounts such as @noaa.gov accounts.
  This allows ERDDAP to verify the user's identity (name and email address) 
  and access their profile image, 
  but does not give ERDDAP access to their emails, their Google Drive, 
  or any other private information.

  <p>The <tt>google</tt> option is the successor to the <tt>openid</tt> option,
  which was discontinued after ERDDAP version 1.68, 
  and which was based on a version of openID that is now out-of-date.
  Please switch to the <tt>google</tt> option.

  <p>Google Sign-In is very convenient for ERDDAP administrators -- 
  you don't ever have to deal with passwords or their hash digests.
  All you need to create is a 
  <a rel="help" 
  href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#user"
  ><tt>&lt;user&gt;</tt></a>
  tag for a user in datasets.xml which specifies the user's Google email address
  as the username attribute.
  (The <tt>password</tt> attribute isn't used when 
  <tt>authentication=google</tt> or <tt>email</tt>.)

  <p>With the <tt>google</tt> option, anyone can log in to ERDDAP by 
  signing into their Google email account, 
  but no one will have the right to access private datasets
  until you (the ERDDAP administrator) create a <tt>&lt;user&gt;</tt> tag,  
  specifying their email address as the username and specifying their roles.

  <p>Recommended
  <br>This is the authentication option which we believe is by far the most 
  secure option. 
  The other options have significantly weaker security.

  <p>ERDDAP treats email addresses as case-insensitive. It does this by
  converting email addresses you enter (in &lt;user&gt; tags)
  or users enter (on the login form) to their all lowercase version.

  <p>To set up authentication=google:
  <ul>
  <li>In your setup.xml, change the &lt;baseHttpsUrl&gt; tag's value.
    <br>For experimenting/working on your personal computer, use 
    <br><tt>https://localhost:8443</tt>
    <br>For your public ERDDAP, use
    <br><tt>https://<i>your.domain.org</i>:8443</tt> 
    <br>or without the :8443 if you are using an Apache 
    <a rel="help" href="#ProxyPass">proxypass</a> so that the port number isn't needed.

  <li>In your setup.xml, change the &lt;authentication&gt; tag's value to <tt>google</tt>:
    <br><tt>&lt;authentication&gt;google&lt;/authentication&gt;</tt>

  <li>If you don't have a Google email account, 
    <a rel="help" href="https://www.google.com/intl/en_us/mail/help/about.html"
    >create one<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
  <li>Follow 
   <a rel="help" href="https://developers.google.com/identity/sign-in/web/devconsole-project"
   >these instructions<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
    to create a Google Developers Console project and get a client ID.

    <p>For <tt>authorized JavaScript origins</tt>, 
    enter the value from <tt>&lt;baseHttpsUrl&gt;</tt> 
    from your personal computer's ERDDAP setup.xml, e.g., 
    <br><tt>https://localhost:8443</tt>
    <br>On a second line, add the <tt>&lt;baseHttpsUrl&gt;</tt> 
      from your public ERDDAP setup.xml, e.g., 
    <br><tt>https://<i>your.domain.org</i>:8443</tt> 

    <p>Don't specify any <tt>Authorized redirect URIs</tt>.

    <p>When you see your Client ID for this project, 
      copy and paste it into your setup.xml
      (usually just below <tt>&lt;authentication&gt;</tt> to be orderly, 
      but placement doesn't actually matter), 
      in the <tt>&lt;googleClientID&gt;</tt> tag, e.g.,
      <br><tt>&lt;googleClientID&gt;<i>yourClientID</i>&lt;/googleClientID&gt;</tt>
      <br>The client ID will be a string of about 75 characters, 
        probably starting with several digits and ending with 
        <tt>.apps.googleusercontent.com</tt> .


  <li>In your datasets.xml, create 
    <a rel="help" 
      href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#user"
      ><tt>&lt;user&gt;</tt></a>    
    tags for each user who will have access to private datasets.
    <br>Use the user's email address as the <tt>username</tt> in the tag.
    <br>Don't specify the <tt>password</tt> attribute for the user. 

  <li>Restart ERDDAP so that the changes to setup.xml and datasets.xml take effect.
  </ul>

  <p>The <tt>google</tt> option relies on Google Sign-In. If that suddenly 
  ceases to work (for whatever reason), users won't be able to sign in to your
  ERDDAP. As a temporary solution, you can (it's up to you) switch to ERDDAP's 
  <tt>email</tt> authentication option temporarily. 
  The <tt>&lt;user&gt;</tt> tag setup is the same, so the only thing
  you need to do is change the &lt;authentication&gt; tag's value in setup.xml, to
  <br><tt>&lt;authentication&gt;email&lt;/authentication&gt;</tt>

</ul>

<p>ERDDAP no longer supports the <tt>openid</tt> authentication option,
which was based on a version of openID that is now out-of-date.
Please use the <tt>google</tt> option instead. 

<p>ERDDAP doesn't support BASIC authentication because:
<ul>
<li>BASIC seems geared toward predefined web pages needing secure access or
  blanket on/off access 
  to the whole site, but ERDDAP allows (restricted access) datasets to be added 
  on-the-fly.
<li>BASIC authentication doesn't offer a way for users to log out!  
<li>BASIC authentication is known to be not secure.  
</ul>


<p>Secure Data Sources
<br>If a data set is to have restricted access to ERDDAP users, 
the data source (from where ERDDAP gets the data) should not be publicly accessible.
So how can ERDDAP get the data for restricted access datasets? Some options are:
<ul>
<li>ERDDAP can serve data from local files (for example, via EDDTableFromFiles or EDDGridFromFiles).  
  <br>&nbsp;
<li>ERDDAP can be in a 
     <a rel="help" href="http://en.wikipedia.org/wiki/Demilitarized_zone_(computing)">DMZ<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
     and the data source (e.g., an OPeNDAP server or a database) can be 
   behind a <a rel="help" href="http://en.wikipedia.org/wiki/Firewall">firewall<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>,
     where it is accessible to ERDDAP but not to the public.
  <br>&nbsp;
<li>The data source can be on a public web site, but require a login to get the data.
  The two types of dataset that ERDDAP can log on to access is 
    <a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#EDDTableFromDatabase"
      >EDDTableFromDatabase</a> and
    <a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#EDDTableFromCassandra"
      >EDDTableFromCassandra</a>.
  These datasets support (and should always use) user names 
  (create an ERDDAP user who only has read-only privileges),
  passwords, SSL connections, and other security measures.

  <p>But in general, currently, ERDDAP can't deal these data sources because it has no
  provisions for logging on to the data source.
  This is the reason why access to 
    <a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#EDDGridFromErddap"
      >EDDGridFromErddap and EDDTableFromErddap</a> datasets
  can't be restricted.
  Currently, the local ERDDAP has no way to login and access the metadata information 
  from the remote ERDDAP.
  And putting the "remote" ERDDAP behind your firewall and removing that dataset's 
  accessibleTo restrictions doesn't solve the problem:
  since user requests for EDDXxxFromErddap data need to be redirected to the 
  remote ERDDAP, the remote ERDDAP must be accessible.

</ul>

<p><a name="defensesAgainstHackers">Defenses Against Hackers</a>
<br>There are bad guy hackers who 
try to exploit security weaknesses in server software like ERDDAP. 
ERDDAP follows the common security advice to have several layers of defenses:

<ul>
<li>Restricted Privileges - One of the most important defenses is to 
run Tomcat via a user called tomcat that doesn't have a password (so no one
can log in as that user) and has limited file system privileges (e.g.,
read-only access to the data).
See ERDDAP's instructions for <a rel="help" href="#tomcat">setting up tomcat</a>.

<li>Heavy Use -
In general, ERDDAP is built for heavy use, including by scripts which make 
tens of thousands of requests, one after another. 
It is hard for ERDDAP to simultaneously open itself up to heavy legitimate use and
shield itself from abuse.
It is sometimes hard to differentiate heavy legitimate use, excessive legitimate use,
and illegitimate use (and sometimes it is really easy).
Among other defenses, ERDDAP consciously does not allow a single request to 
use an inordinate fraction of the system's resources (unless the system is otherwise
not active). 

<li>Identify Troublesome Users -
If ERDDAP is slowing down or freezing 
(perhaps because a naive user or a bot is running multiple
scripts to submit multiple requests simultaneously 
or perhaps because of a bad guy's
<a rel="help" href="http://en.wikipedia.org/wiki/Denial-of-service_attack">Denial-of-service</a>
attack), you can look at the 
<a rel="help" href="#dailyReport">Daily Report email</a>
(and more requent identical information in the 
<a rel="help" href="#dailyReport">ERDDAP log file</a>)
which displays the number of requests made by the most active users 
(see "Requester's IP Address (Allowed)").
ERDDAP also sends emails to the administrator whenever there is
<a rel="help" href="#requestsFailed">"Unusual activity: >25% of requests failed"</a>.
You can then look in the ERDDAP log file to see the nature of their requests.
If you feel that someone is making too many requests, bizarre
requests (you wouldn't believe what I've seen, well, maybe you would), 
or attack-type requests, 
you can add their IP address to the blacklist.

<li>Blacklist - 
You can add the IP address of troublesome users, bots, and 
<a rel="help" href="http://en.wikipedia.org/wiki/Denial-of-service_attack">Denial-of-service</a>
attackers to the ERDDAP
<a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#requestBlacklist"
>blacklist</a>, so that future requests from them will be immediately rejected.
This setting is in datasets.xml so that you can quickly add an IP address to the list
and then <a rel="help" href="#flag">flag</a>
a dataset so that ERDDAP immediately notices and applies the change.
The error message sent to blacklisted users encourages them to contact the ERDDAP administrator
if they feel they have been mistakenly put on the blacklist.
(In our experience, several users have been unaware that they were running
multiple scripts simultaneously, or that their scripts were making nonsense requests.)

<li>Dataset Security -
Some types of datasets (notably, EDDTableFromDatabase) present additional security risks
(e.g., SQL injection)
and have their own security measures. See the information for those types 
of datasets in 
<a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html"
>Working with the datasets.xml File</a>,
notably 
<a rel="help"
href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#databaseSecurity"
>EDDTableFromDatabase security</a>.

<li>Security Audit - 
I (Bob) tried repeatedly for 3+ years to get NOAA IT security to do a security 
audit of ERDDAP. They have repeatedly refused. At one point, they said they
only do that for software developed in the DC area.
Fortunately, in 2012, a group in USGS started to use ERDDAP. 
In early 2013, they hired the security firm Acunetix to do a security scan of ERDDAP.
They found some problems.
I fixed some of them and gave reasons for why the other issues were false alerts. 
They redid the scan. If you would like to see the report and my reply,
please email <tt>bob dot simons at noaa dot gov</tt>.

</ul>

<p>Questions? Suggestions? 
<br>If you have any questions about ERDDAP's security system
or have any questions, doubts, concerns, or suggestions about how it is set up, 
please email <tt>bob dot simons at noaa dot gov</tt>.
</ul>

<!-- ******* -->
<h2><a name="dontNeedToKnow">Things You Don't Need To Know</a></h2>
These are details that you don't need to know until a need arises.
<ul>
<li><b><a name="secondErddap">Setting</a> Up a Second ERDDAP for Testing/Development</b>  
  <br>If you want to do this, there are two approaches:
  <ul>
  <li> (Best) Install Tomcat and ERDDAP on a computer other than the computer that has your public ERDDAP.
    If you use your personal computer: 
    <ol>
    <li>Do the installation one step at a time. Get Tomcat up and running first.
      <br>When Tomcat is running, the Tomcat Manager should be at 
      <br><a rel="help" href="http://127.0.0.1:8080/manager/html/">http://127.0.0.1:8080/manager/html/</a>
    <li>Install ERDDAP.
    <li>Don't use ProxyPass to eliminate the port number from the ERDDAP URL.
    <li>In <a rel="help" href="#setup.xml">setup.xml</a>, set <tt>baseUrl</tt> 
      to <tt>http://127.0.0.1:8080</tt> 
    <li>After you start up this ERDDAP, you should be able to see it at 
      <br><a rel="help" href="http://127.0.0.1:8080/erddap">http://127.0.0.1:8080/erddap</a> 
    </ol>
  <li> <a name="secondTomcat">(Second Best)</a> Install another Tomcat on the same computer as your public ERDDAP.
    <ol>
    <li>Do the installation one step at a time. Get Tomcat up and running first.
      <br>Change all of the port numbers associated with the second Tomcat (e.g., change 8080 to 8081)
      (see these <a rel="help" href="http://viralpatel.net/blogs/2009/08/running-multiple-instance-apache-tomcat-single-server.html">directions<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>).    
    <li>Install ERDDAP in the new Tomcat.
    <li>Don't use ProxyPass to eliminate the port number from the ERDDAP URL.
    <li>In <a rel="help" href="#setup.xml">setup.xml</a>, set <tt>baseUrl</tt> 
      to <tt>http://www.<i>yourDomainName</i>:8081</tt> 
    <li>After you start up this ERDDAP, you should be able to see it at 
      <br><tt>http://www.<i>yourDomainName</i>:8081/erddap</tt>
      <br>&nbsp;
    </ol>
  </ul>


<li><b><a name="heavyLoads">Heavy Loads / Constraints</a></b> - 
  With heavy use, a standalone ERDDAP may be constrained by various problems. 
  For more information, see the 
    <a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/grids.html#heavyLoads">list of 
    constraints and solutions</a>.
  <br>&nbsp;
  
<li><a name="grids"><b>Grids, Clusters, and Federations</b></a> - 
  Under very heavy use, a single standalone ERDDAP will run into 
  one or more constraints and even the suggested solutions will be insufficient.  
  For such situations, ERDDAP has features that make it easy to construct scalable grids 
  (also called clusters or federations) of ERDDAPs  which allow the system to handle very heavy use
  (e.g., for a large data center). For more information, see  
    <a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/grids.html">grids, clusters, 
      and federations of ERDDAPs</a>.
  <br>&nbsp;

<li><a name="cloudComputing"><b>Cloud Computing</b></a> - 
  Several companies are starting to offer 
  <a rel="help" 
  href="https://en.wikipedia.org/wiki/Cloud_computing">cloud computing services<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> 
  (e.g., <a rel="help" href="http://aws.amazon.com/">Amazon Web Services<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>).
  <a rel="help" href="http://en.wikipedia.org/wiki/Web_hosting_service">Web hosting companies<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> 
     have offered simpler services since the mid-1990's, but the "cloud" services 
     have greatly expanded the flexibility of the systems and the range of
     services offered. 
  You can use these services to set up a single ERDDAP 
  or a grid/cluster of ERDDAPs to handle very heavy use.
  For more information, see  
  <a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/grids.html#cloudComputing">cloud 
    computing with ERDDAP</a>.
  <br>&nbsp;

<li><b><a name="amazon">Amazon Web Services (AWS) EC2 Installation Overview</a></b> - 
  <a rel="help" href="http://aws.amazon.com/">Amazon Web Services (AWS)<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
  is a 
  <a rel="help" 
  href="https://en.wikipedia.org/wiki/Cloud_computing">cloud computing service<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
  that offers a wide range of computer infrastructure that you can rent by the hour.
  You can install ERDDAP on an 
  <a rel="help" href="http://aws.amazon.com/ec2/">Elastic Compute Cloud (EC2)<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
  instance (their name for a computer that you can rent by the hour).
  AWS has an excellent 
  <a rel="help" 
  href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/concepts.html">AWS User Guide<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
  and you can use Google to find answers to specific questions you might have.
  Brace yourself -- 
  it is a fair amount of work to get started. But once you get one server up and running, 
  you can easily rent as many additional resources (servers, databases, SSD-space, etc.)
  as you need, at a reasonable price.
  [This isn't a recommendation or endorsement of Amazon Web Services. 
  There are other cloud providers.]

  <p>An overview of things you need to do to get ERDDAP running on AWS is:
  <ul>
  <li>In general, you will do all the things described in the 
    <a rel="help" 
  href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/concepts.html">AWS User Guide<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>.
  <li>Set up an AWS account.
  <li>Set up an AWS user within that account with administrator privileges.
    Log in as this user to do all the following steps.  
  <li>Elastic Block Storage (EBS) is the AWS equivalent of a hard drive attached to 
    your server. 
    Some EBS space will be allocated when you first create an EC2 instance.
    It is persistent storage -- the information isn't lost when you stop
    your EC2 instance. And if you change instance types, your EBS space
    automatically gets attached to the new instance.
  <li>Create an Elastic IP address so that your EC2 instance has a stable,
    public URL (as opposed to just a private URL that changes every time you 
    restart your instance).
  <li>Create and start up an EC2 instance (computer). 
    There are a wide range of 
    <a rel="help" href="http://aws.amazon.com/ec2/instance-types/">instance types<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>, 
    each at a different price.
    An m4.large or m4.xlarge instance is powerful and is probably suitable 
    for most uses, but choose whatever meets your needs.   
    You will probably want to use Amazon's Linux as the operating system.
  <li>If your desktop/laptop computer is a Windows computer, you can use
    <a rel="help" 
    href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/putty.html">PuTTY<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>,
    a free SSH client for Windows, to get access to your EC2 instance's command line. 
    Or, you may have some other SSH program that you prefer.
  <li>When you log into your EC2 instance, you will be logged in as the 
    administrative user with the user name "ec2-user".
    ec2-user has sudo privileges.
    So, when you need to do something as the root user, use: <tt>sudo <i>someCommand</i></tt>
  <li>If your desktop/laptop computer is a Windows computer, you can use
    <a rel="help"
    href="http://stackoverflow.com/questions/16744863/connect-to-amazon-ec2-file-directory-using-filezilla-and-sftp">FileZilla<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>, 
    a free SFTP program, to transfer files
    to/from your EC2 instance. Or, you may have some other SFTP program that you prefer.
  <li><a rel="help"
  href="http://codingsteps.com/install-apache-php-apc-mysql-on-amazon-ec2-with-amazon-linux-ami/">Install Apache<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> 
    on your EC2 instance.
  <li>Follow the standard <a rel="help" href="#initialSetup">ERDDAP installation instructions</a>.
    <br>&nbsp;
  </ul>

<li><b><a name="waitThenTryAgain">WaitThenTryAgain Exception</a></b> - 
  In unusual circumstances, a user may get an error message like
  <tt>
  <br>&nbsp;&nbsp;WaitThenTryAgainException: 
  <br>&nbsp;&nbsp;There was a (temporary?) problem.  Wait a minute, then try again.  
    (In a browser, click the Reload button.)
  <br>&nbsp;&nbsp;Details: GridDataAccessor.increment: partialResults[0]="123542730" was expected 
    to be "123532800". </tt>
  <br>The explanation is: 
  For each EDDGrid dataset, ERDDAP keeps the axis variable values in memory.
  They are used, for example, to convert requested axis values that use the "()" format into index numbers. 
  For example, if the axis values are "10, 15, 20, 25", a request for (20)
  will be interpreted as a request for index #2 (0-based indices).
  When ERDDAP gets a request for data and gets the data from the source, 
  it verifies that the axis values that it got from the source match the axis values in memory.
  Normally, they do.
  But sometimes the data source has changed in a significant way:
  for example, index values from the beginning of the axis variable may have
  been removed (e.g., "10, 15, 20, 25" may have become "20, 25, 30").
  If that happens, it is clear that ERDDAP's interpretation of the request (e.g., "(20)" is index #2)
  is now wrong. So ERDDAP throws an exception and marks the dataset as needing to be reloaded.
  ERDDAP will update the dataset soon (often in a few seconds, usually within a minute).
  Other, similar problems also throw the WaitThenTryAgain exception.

  <p>Starting with ERDDAP version 1.14, it became much less likely that a user would actually see this error.
  Now, when the underlying error occurs, ERDDAP automatically internally tries to reload the dataset 
  and resubmit the request to the reloaded dataset.
  Often this succeeds. When it does, the user will simply see that a given request took a little longer 
  than usual. If it fails, the user should (as the message says) wait a minute, then try again.

<li><b><a name="palettes">Palettes</a></b> are used to convert a range of numbers into a range of colors
when making graphs and maps. 
  ERDDAP comes with several pre-made palettes. You can add additional palettes.
  ERDDAP's palettes are defined in <a rel="help" href="http://gmt.soest.hawaii.edu/">GMT<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>-style 
    <a rel="help" href="http://gmt.soest.hawaii.edu/gmt/html/GMT_Docs.html#x1-720004.15">.cpt (Color Palette Table) files<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>.
  All ERDDAP .cpt files are valid GMT .cpt files, but the opposite may not be true.
  ERDDAP may just support a subset of what GMT supports.  
  If there is trouble, ERDDAP will probably throw an error when the .cpt file is parsed 
  (which is better than misusing the information).
  ERDDAP requires that all .cpt files be stored in <i>tomcat</i>/webapps/erddap/WEB-INF/cptfiles.
  To get ERDDAP to use a new .cpt file, store the file in that directory 
  and either:
  <ul>
  <li>If you use the default messages.xml file: add the file name to the &lt;palettes&gt; tag in
    <br><i>tomcat</i>/webapps/erddap/WEB-INF/classes/gov/noaa/pfel/erddap/util/messages.xml.
    <br>If you do this, you need to do it every time you upgrade ERDDAP.
  <li>If you use a custom messages.xml file: add the file name to the &lt;palettes&gt; tag 
    in your custom messages.xml file: 
    <i>tomcat</i>/content/erddap/messages.xml .
    If you do this, you only need to do it once (but there is other work to maintain a custom messages.xml file). 
  </ul>  
  <br>But don't remove any of the standard palettes. They are a standard feature of all ERDDAP installations.
  An advantage of this approach is that you can specify the order of the palettes in the list 
  presented to users.
  <br>And for every new ERDDAP release, you need to put your .cpt files in 
    <i>tomcat</i>/webapps/erddap/WEB-INF/cptfiles and restart ERDDAP so ERDDAP findes the files.
  <br>&nbsp;

<li><b><a name="colorbars">How does ERDDAP generate the colors in a colorbar?</a></b>
  <ol>
  <li>The user selects one of the predefined <a rel="help" href="#palettes">palettes</a> or uses the default,
    e.g., Rainbow.  Palettes are stored/defined in GMT-style .cpt Color Palette Table files.  
    Each of ERDDAP's predefined palettes has a simple integer range, 
    e.g., 0 to 1 (if there is just one section in the palette), 
    or 0 to 4 (if there are four sections in the palette).
    Each segment in the file covers n to n+1, starting at n=0.
  <li>ERDDAP generates a new .cpt file on-the-fly, by scaling the predefined palette's range
    (e.g., 0 to 4) to the range of the palette needed by the
    user (e.g., 0.1 to 50) and then generating a section in the 
    new palette for each section of the new palette 
    (e.g., a log scale with ticks at 0.1, 0.5, 1, 5, 10, 50 will have 5 sections).
    The color for the end point of each section is generated by finding the relevant section of the
    palette in the .cpt file, then linearly interpolating the R, G, and B values.
    (That's the same as how GMT generates colors from its Color Palette Table files.)
    This system allows ERDDAP to start with generic palettes 
    (e.g., Rainbow with 8 segments, in total spanning 0 to 8)
    and create custom palettes on-the-fly
    (e.g., a custom Rainbow, which maps 0.1 to 50 mg/L to the rainbow colors).
  <li>ERDDAP then uses that new .cpt file to generate the color for each different colored pixel 
    in the color bar
    (and later for each data point when plotting data on a graph or map),
    again by finding the relevant section of the
    palette in the .cpt file, then linearly interpolating the R, G, and B values.    
  </ol>
  This process may seem unnecessarily complicated. But it solves problems
  related to log scales that are hard to solve other ways.

  <p>So how can you mimic what ERDDAP is doing?  That isn't easy.
  Basically you need to duplicate the process that ERDDAP is using.
  If you are a Java programmer, you can use the same Java class that ERDDAP uses to do all of this: 
  <br><i>tomcat</i>/webapps/erddap/WEB-INF/classes/gov/noaa/pfel/coastwatch/sgt/CompoundColorMap.java.


<li><b><a name="dataDistribution">Guidelines for Data Distribution Systems</a></b> 
  - More general opinions about the design and evaluation 
  of data distribution systems can be found  
  <a rel="help" href="http://coastwatch.pfel.noaa.gov/erddap/images/erddapTalk/erdData.html">here</a>.
  <br>&nbsp;

<li><b><a name="ArchiveADataset">ArchiveADataset</a></b>  
  - Included in your ERDDAP installation is a command line tool called ArchiveADataset
  which can help you make an archive (a .tar.gz file) with part or all of a dataset
  stored in a series of data files in a file format that is suitable for 
  submission to NOAA's NCEI archive (.nc for gridded datasets or 
  <a rel="help"
href="http://coastwatch.pfeg.noaa.gov/erddap/tabledap/documentation.html#ncCFMA">.ncCFMA</a>    
  for tabular datasets, as specified by the 
  <a rel="help"
href="https://www.nodc.noaa.gov/data/formats/netcdf/v2.0/">NCEI NetCDF Templates v2.0<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>).

  <p>ArchiveADataset follows these 
  <a rel="help"
href="https://www.ncdc.noaa.gov/atrac/guidelines.html">NCEI Archiving Guidelines<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>,
  this guide for 
  <a rel="help"
href="https://sites.google.com/a/noaa.gov/ncei-ioos-archive/cookbook?pli=1">Archiving
Your Data at NCEI<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>,
   and the related
  <a rel="help"
href="https://sites.google.com/a/noaa.gov/ncei-ioos-archive/cookbook/data-integrity">Practices
for Ensuring Data Integrity<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>.
  Not surprisingly, the 
  <a rel="help" 
  href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#globalAttributes"
  >global and variable metadata</a> 
  that ERDDAP encourages/requires is almost exactly the same metadata 
  that NCEI encourages/requires,
  so all of your datasets should be ready for submission to NCEI via
  <a rel="bookmark" href="https://www.nodc.noaa.gov/s2n/">Send2NCEI<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
  or 
  <a rel="bookmark" href="https://www.ncdc.noaa.gov/atrac/index.html">ATRAC<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
    (NCEI's Advanced Tracking and Resource tool for Archive Collections).
  Also, NCEI can download the ISO 19115 .xml metadata file for the dataset from 
  your ERDDAP.
  
  <p>ArchiveADataset may be useful in other situations,
  for example, for ERDDAP administrators who need to convert a subset of a dataset
  (on a private ERDDAP) from its native file format into a set of 
  <a rel="help"
href="http://coastwatch.pfeg.noaa.gov/erddap/tabledap/documentation.html#ncCFMA">.ncCF files</a>,
  so that a public ERDDAP can 
  serve the data from the .ncCF files instead of the original files.

  <p>Once you have set up ERDDAP and run it (at least one time), 
  you can find and use ArchiveADataset in the 
  <i>tomcat</i>/webapps/erddap/WEB-INF directory. 
  There is a shell script (ArchiveADataset.sh) for Linux/Unix 
  and a batch file (ArchiveADataset.bat) for Windows. 
  When you run ArchiveADataset, it will ask you a series of questions. 
  For each question, type a response, then press Enter. 
  Or press ^C to exit a program at any time.

  <p>Or, you can put the answers to the questions, in order, on the command line.
  To do this, run the program once and type in and write down your answers.
  Then, you can create a single command line (with the answers as parameters) which 
  runs the program and answers all the questions.
  <br>Use the word <tt>default</tt> if you want to use the default value for a given parameter.
  <br>Use "" (two double quotes) as a placeholder for an empty string.
  <br>Specifying parameters on the command line can be very convenient, for example, 
  if you use ArchiveADataset once a month to 
  archive a month's worth of data. Once you have generated the command line 
  with parameters and saved that in your notes or in a shell script, 
  you just need to make small changes each month to make that month's archive.

  <p>The questions that ArchiveADataset asks allow you to:
  <ul>
  <li>Specify a contact email address for this archive
    (it will be written in the READ_ME.txt file in the archive).
  <li>Specify the datasetID of the dataset you want to archive.
  <li>Specify which data variables you want to archive (usually all).
  <li>Specify which subset of the dataset you want to archive.
    You need to format the subset in the same way you would format 
    a subset for a data request,
    so it will be different for gridded 
    than for tabular datasets.
    <ul>
    <li>For gridded datasets, you can specify a range of values of the leftmost dimension,
      usually that is a range of time. ArchiveADataset will make a separate
      request and generate a separate data file for each value in the range of values. 
      Since gridded datasets are usually large, you will almost always have to specify 
      a small subset relative to the size of the entire dataset.
      <br>For example, <tt>[(2015-12-01):(2015-12-31)][][][]</tt> 
    <li>For tabular datasets, you can specify any collection of constraints, but
      it is often a range of time.
      Since tabular datasets are usually small, it is often possible to specify 
      no constraints, so that the entire dataset is archived.
      <br>For example, <tt>&amp;time&gt;=2015-12-01&amp;time&lt;2016-01-01</tt>
    </ul>
  <li>For tabular datasets: specify a comma separated list of 0 or more variables 
    that will determine 
    how the archived data is further subsetted into different data files.
    For datasets that have
    <br><a rel="help" 
    href="http://coastwatch.pfeg.noaa.gov/erddap/download/setupDatasetsXml.html#cdm_data_type"
    ><tt>cdm_data_type</tt></a><tt>=TimeSeries|TimeSeriesProfile|Trajectory|TrajectoryProfile</tt>
    <br>you should almost always specify the variable that has the 
    <tt>cf_role=timeseries_id</tt> (e.g., stationID) 
    or <tt>cf_role=trajectory_id</tt> attibute.
    ArchiveADataset will make a separate request and generate a separate
    data file for each combination of the values of these variables,
    e.g., for each stationID.
    <br>For all other tabular datasets, you will probably not specify any variables
    for this purpose. 
    <br>Warning: If the subset of the dataset you are archiving is very large (&gt;2GB) 
    and there is no suitable variable for this purpose,
    then ArchiveADataset is not usable with this dataset. This should be rare.
  <li>Specify the file format for the data files that will be created.
    <br>For gridded datasets, for NCEI, use <tt>.nc</tt> .
    <br>For tabular datasets, for NCEI, use 
      <a rel="help"
      href="http://coastwatch.pfeg.noaa.gov/erddap/tabledap/documentation.html#ncCFMA"
      ><tt>.ncCFMA</tt></a>.    
  <li>Specify the type of file digest 
    to be created for each data file and 
    for the .tar.gz file.  
    The file digest provides a way for the client (e.g., NCEI) 
    to test whether the data file has become corrupted. 
    Traditionally, these were 
    <a rel="bookmark" href="https://en.wikipedia.org/wiki/MD5">.md5 files<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>,
    but now there are better options.
    For NCEI, use <tt>.sha256</tt> .
  </ul>

  <p>After you answer all of the questions, ArchiveADataset will:
  <ol>
  <li>Make a series of requests to the dataset and stage the resulting data files in
      <i>bigParentDirectory</i>/ArchiveADataset/<i>datasetID_timestamp</i>/. 
    <br>For gridded datasets, there will be a file for each value of the leftmost dimension
      (e.g., time). The name of the file will be that value (e.g., the time value).
    <br>For tabular datasets, there will be a file for each value of the
      ... variable(s). The name of the file will be that value.
      If there is more than one variable, the left variables will be used
      to make subdirectory names, and the rightmost variable will be used
      to make the file names.
    <br>Each of data file must be &lt;2GB (the maximum allowed by .nc version 3 files).
  <li>Make a file related to each data file with the digest of the data file.
    For example, if the data file is 46088.nc and the digest type is .sha256, 
    then the digest file will have the name 46088.nc.sha256 .
  <li>Make a READ_ME.txt file with information about the archive,
    including a list of all the settings you specified to generate this archive.
  <li>Make 3 files in <i>bigParentDirectory</i>/ArchiveADataset/ :
    <ul>
    <li>A .tar.gz archive file named <i>datasetID_timestamp</i>.tar.gz
      containing all of the staged data files and digest files.
      The .tar.gz file may be any size, limited only by disk space.
    <li>A digest file for the .tar.gz file, for example,
      <i>datasetID_timestamp</i>.tar.gz.sha256
    <li>A text file named
      <i>datasetID_timestamp</i>.tar.gz.listOfFiles.txt
      which lists all of the files in the .tar.gz file.
    </ul>
    If you are preparing the archive for NCEI, these are the files that you will send to 
    NCEI, perhaps via 
    <a rel="bookmark" href="https://www.nodc.noaa.gov/s2n/">Send2NCEI<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
    or 
    <a rel="bookmark" href="https://www.ncdc.noaa.gov/atrac/index.html">ATRAC<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
    (NCEI's Advanced Tracking and Resource tool for Archive Collections).
  <li>Delete all of the staged files so that only the .tar.gz, .tar.gz.sha256, 
    and .tar.gz.listOfFiles.txt files remain.
  </ol>

  <p>Problems? Suggestions? ArchiveADataset is new. If you have problems or suggestions,
    please email them to <tt>bob dot simons at noaa dot gov</tt> .
  <br>&nbsp;

</ul>

<!-- ******* -->
<h2><a name="slideShows">Slide Shows</a></h2>

Here are some PowerPoint slide shows and documents that Bob Simons has created 
related to ERDDAP.
<p><b>DISCLAIMER: The content and opinions expressed in these documents 
are Bob Simons' personal opinions and 
do not necessarily reflect any position of the 
Government or the National Oceanic and Atmospheric Administration.</b>

<p>The Three Main Documents:
<ul>
<li><a rel="help" 
  href="http://coastwatch.pfel.noaa.gov/erddap/images/erddapTalk/erddapTalk4.ppt"
  >The main introduction to ERDDAP (version 4)</a>
<li><a rel="help" 
  href="http://coastwatch.pfeg.noaa.gov/erddap/download/grids.html"
  >ERDDAP: Heavy Loads, Grids, Clusters, Federations, and Cloud Computing</a>
<li><a rel="help" 
  href="http://coastwatch.pfel.noaa.gov/erddap/images/erddapTalk/erdData.html"
  >Bob's Guidelines for Data Distribution Systems</a>
</ul>

<p>Previous/Specialized Presentations:
<ul>
<li><a rel="help" 
  href="http://coastwatch.pfel.noaa.gov/erddap/images/erddapTalk/OneAndDone.pptx"
  >2016 EDMC: One And Done</a>

<li><a rel="help" 
  href="http://coastwatch.pfel.noaa.gov/erddap/images/erddapTalk/NextGeneration.pptx"
  >2016 Gov API: Next Generation Data Servers</a> 

<li><a rel="help"
  href="http://coastwatch.pfel.noaa.gov/erddap/images/erddapTalk/TabularAggregation.pptx"
  >2015 ESIP: Tabular Aggregation</a>

<li><a rel="help"
  href="http://coastwatch.pfel.noaa.gov/erddap/images/erddapTalk/SimonsDosDontsTabular.pptx"
  >2014 EDMC: Bob's Do's and Don't for Tabular Data</a>

<li><a rel="help"
  href="http://coastwatch.pfel.noaa.gov/erddap/images/erddapTalk/TheIdealUserInterface.pptx"
  >2014 EDMC: The Ideal User Interface</a>

<li><a rel="help"
  href="http://coastwatch.pfel.noaa.gov/erddap/images/erddapTalk/TabularData.pptx"
  >2014 ESIP: Tabular Data</a>

<li><a rel="help"
  href="http://coastwatch.pfel.noaa.gov/erddap/images/erddapTalk/DoMoreWithLess.ppt"
  >2013 EDMC: Do More With Less</a>

<li><a rel="help"
  href="http://coastwatch.pfel.noaa.gov/erddap/images/erddapTalk/guidelines3.ppt"
  >2012 EDMC: Guidelines for Data Distribution Systems</a>
</ul>

<p>I hope it isn't true that
<a rel="bookmark"
href="http://markandrewgoetz.com/blog/wp-content/uploads/2009/11/tufte-wallpaper.png">"Every 
time you make a PowerPoint, Edward Tufte kills a kitten."<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
<br>&nbsp;

<!-- ******* -->
<h2><a name="programmersGuide">Programmer's Guide</a></h2>
These are things that only a programmer who intends to work with ERDDAP's Java classes needs to know.
<ul>

<li><b><a name="sourceCode">Source Code</a></b> 
  <ul>
  <li>The source code for the current version of ERDDAP is always in the current erddap.war file.
    So when you install ERDDAP in tomcat, all of the source code is unpacked
    and installed on the server. If you just want to read the source code,
    this is the easiest option.
  <li>The source code for recent public versions and in-development versions 
    is also available via <a rel="help" href="https://github.com/BobSimons">GitHub<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>.
    Please read the <a rel="help" href="https://github.com/BobSimons/erddap/wiki">Wiki<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> 
    for that project. 
    If you want to modify the source code (and possibly have the changes incorporated
    into the standard ERDDAP distribution), this is the recommended approach.
  <li>ERDDAP and its subcomponents have very liberal, open-source <a rel="copyright" href="#license">licenses</a>,
    so you can use and modify the source code for any purpose, for-profit or not-for-profit.
    Note that ERDDAP and many subcomponents have licenses that require that you 
    acknowledge the source of the code that you are using. See
    <a rel="copyright" href="#credits">Credits</a>. Whether required or not, it is just
    good form to acknowledge all of these contributors.
    <br>&nbsp;
  </ul>

<li><b><a name="useTheCode">Use the Code for Other Projects</a></b> 
  While you are welcome to use parts of the ERDDAP code for other projects, 
  be warned that the code can and will change.   
  We don't promise to support other uses of our code. 
  Git and GitHub will be your main solutions for dealing with this - 
  Git allows you to merge our changes into your changes. 

  <p><b>For many situations where you might be tempted to use parts of ERDDAP in your project, 
  we think you will find it much easier to install and use ERDDAP as is,</b>
  and then write other services which use ERDDAP's services.
  You can set up your own ERDDAP installation crudely in an hour or two.
  You can set up your own ERDDAP installation in a polished way in a few days 
  (depending on the number and complexity of your datasets).
  But hacking out parts of ERDDAP for your own project is likely to take weeks 
  (and months to catch subtleties) and you will lose the ability to 
  incorporate changes and bug fixes from subsequent ERDDAP releases.
  We (obviously) think there are many benefits to using ERDDAP as is and making 
  your ERDDAP installation publicly accessible.
  However, in some circumstances, you might not want to make your ERDDAP
  installation publicly accessible.
  Then, your service can access and use your private ERDDAP and your clients 
  needn't know about ERDDAP.

  <p><b><a name="halfWay">Half Way</a></b> - Or, there is another approach
  which you may find useful 
  which is half way between delving into ERDDAP's code and using ERDDAP as a 
  stand-alone web service:
  In the EDD class, there is a static method which lets you make an instance of a dataset 
  (based on the specification in datasets.xml): 
  <br>&nbsp;&nbsp;<tt>oneFromDatasetXml(String tDatasetID)</tt>
  <br>It returns an instance of an EDDTable or EDDGrid dataset.
  Given that instance, you can call 
  <br>&nbsp;&nbsp;<tt>makeNewFileForDapQuery(String userDapQuery, String dir, 
  String fileName, String fileTypeName)</tt>
  <br>to tell the instance to make a data file, of a specific fileType, with 
  the results from a user query.
  Thus, this is a simple way to use ERDDAP's methods to request data and get a
  file in response, just as a client would use the ERDDAP web application.
  But this approach works within your Java program and bypasses the need for an 
  application server like Tomcat.
  We use this approach for many of the unit tests of EDDTable and EDDGrid subclasses,
  so you can see examples of this in the source code for all of those classes.

<li><b><a name="developmentEnvironment">Development Environment</a></b>
  <ul>
  <li>Directory Structure 
    <ul>
    <li>If you are installing ERDDAP in a Tomcat (whether or not you will
      actually use it that way), follow the instructions above.
    <li>If you aren't installing ERDDAP in a Tomcat, you still need to make a
      Tomcat-like directory structure,
      so that ERDDAP can find the setup files in <i>tomcat</i>/content/erddap .
      <ul>
      <li>Make a directory somewhere called "tomcat" (it can be something else,
        but this is easier to explain).
      <li>As indicated above, unzip erddapContent.zip into <i>tomcat</i>, creating <i>tomcat</i>/content/erddap .
        Follow the instructions above to modify 
        <a rel="help" href="#setup.xml">setup.xml</a> and datasets.xml.
        Depending on your situation, you may need to specify that directory by 
        adding something like
        <br>&nbsp;&nbsp;<tt>-DErddapContentDirectory="<i>/someDirectory/content/erddap/</i>"</tt>  
        <br>to the Java command line for your program.
      <li>Make a <i>tomcat</i>/webapps/erddap directory.
      <li>.war files are just .zip files that follow a few additional conventions.
        So you can use an unzip program to unzip erddap.war into
        <i>tomcat</i>/webapps/erddap .
        That has all of ERDDAP's .java classes and many other files.
      </ul>
    </ul>
  <li>Our development environment is just a programmer's editor (we're not saying which one).
    (No, we don't use Eclipse, Ant, Maven, or ...; nor do we offer ERDDAP-related support for them.
    If we required you to use Ant and you preferred Maven (or vice versa), you wouldn't be very happy about it.)
  <li>We use a batch file which deletes all of the .class files in the source tree.
  <li>We currently use javac 1.8.0_77 <!-- javaVersion --> to compile gov.noaa.pfel.coastwatch.TestAll  
     (it has links to a few classes that wouldn't be compiled otherwise) 
     and java 1.8.0_77 <!-- javaVersion --> to run the tests.  
     For security reasons, it is almost always best to use the latest versions of Java and Tomcat.
     <ul>
     <li>When we run javac or java, the current directory is <i>tomcat</i>/webapps/erddap/WEB-INF .
     <li><a name="classpath">Our</a> javac and java classpath (including some unnecessary items) is currently
       <!-- Bob: don't forget to update the classpath in the .bat/shell script files in WEB-INF. -->
       <br><tt>
./classes;../../../lib/servlet-api.jar;lib/axis.jar;lib/cassandra-driver-core.jar;lib/netty-all.jar;lib/guava.jar;lib/metrics-core.jar;lib/lz4.jar;lib/snappy-java.jar;lib/commons-compress.jar;lib/commons-discovery.jar;lib/itext-1.3.1.jar;lib/jaxrpc.jar;lib/lucene-core.jar;lib/mail.jar;lib/netcdfAll-latest.jar;lib/slf4j.jar;lib/postgresql.jdbc.jar;lib/saaj.jar;lib/wsdl4j.jar;lib/aws-java-sdk.jar;lib/commons-codec.jar;lib/commons-logging.jar;lib/fluent-hc.jar;lib/httpclient.jar;lib/httpclient-cache.jar;lib/httpcore.jar;lib/httpmime.jar;lib/jna.jar;lib/jna-platform.jar;lib/jackson-annotations.jar;lib/jackson-core.jar;lib/jackson-databind.jar</tt>
       <br>If you get error messages about classes not found
         when you compile or run ERDDAP or one of its tools, 
         compare your command line's classpath to the classpath above
         to figure out which .jars are missing from your classpath.
     <li>So your javac command line will be something like
       <br><tt>javac -cp (classpath above) classes/gov/noaa/pfel/coastwatch/TestAll.java</tt>
     <li>And your java command line will be something like
       <br><tt>java -cp (classpath above) -Xmx1200M -Xms1200M classes/gov/noaa/pfel/coastwatch/TestAll</tt>
       <br>Optional: you can add <tt>-verbose:gc</tt>. It tells Java to print garbage collection 
       statistics.
     <li>If TestAll compiles, everything ERDDAP needs has been compiled.
       Lots of classes are compiled that aren't needed for ERDDAP.
       If compiling TestAll succeeds but doesn't compile some class, that class isn't needed.
       (There are some unfinished/unused classes.)
     </ul>
  <li>We use some 3rd party source code instead of .jar files (notably for Dods)
     and have modified them slightly to avoid problems compiling with Java 1.8. <!-- javaVersion -->
     We have often made other slight modifications (notably to Dods) for other reasons.
  <li>Most classes have test methods. We run lots of tests via TestAll. 
     Unfortunately, many of the tests are specific to our set up.  (Sorry.)
  <br>&nbsp;
  </ul>

<li><b><a name="importantClasses">Important Classes</a></b> - If you want to look 
at the source code and try to figure out how ERDDAP works, please do. 
  <ul>
  <li>The code has JavaDoc comments, but the JavaDocs haven't been generated. Feel free to generate them.
  <li>The most important classes (including the ones mentioned below) are within gov/noaa/pfel/erddap.
  <li>The Erddap class has the highest level methods.  It extends HttpServlet.
  <li>Erddap passes requests to instances of subclasses of EDDGrid or EDDTable, 
    which represent individual datasets.
  <li>EDDGrid and EDDTable subclasses parse the request, get data from subclass-specific methods, 
    then format the data for the response.
  <li>EDDGrid subclasses push data into GridDataAccessor (the internal data container for gridded data).
  <li>EDDTable subclasses push data into TableWriter subclasses, which write data to a specific file 
    type on-the-fly.
  <br>&nbsp;
  </ul>

<li><b><a name="codeContributions">Code Contributions</a></b> - 
  If you have written some code which would be a nice addition to ERDDAP, 
  please email <tt>bob dot simons at noaa dot gov</tt>. We'll work out the details.
  The two situations that are most likely are:
    <ol>
    <li>You want to write another subclass of EDDGrid or EDDTable to handle another data source type.
       If so, we recommend that you find the closest existing subclass and use that code as a starting   point.
    <li>You want to write another saveAs<i>FileType</i> method.
       If so, we recommend that you find the closest existing saveAs<i>FileType</i> method
         in EDDGrid or EDDTable 
       and use that code as a starting point.
    </ol>
  Both of these situations have the advantage that the code you write is self-contained.
  You won't need to know all the details of ERDDAP's internals.
  And it will be easy for us to incorporate your code in ERDDAP.
  Note that if you do submit code, the license will need compatible with the ERDDAP 
    <a rel="copyright" href="#license">license</a> (e.g., 
    <a rel="bookmark" href="http://www.apache.org/licenses/">Apache<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>,
    <a rel="bookmark" href="http://www.opensource.org/licenses/bsd-license.php">BSD<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>, or
    <a rel="bookmark" href="http://www.opensource.org/licenses/mit-license.php">MIT-X<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>).
  You can hold the copyright to your code. We'll list your contribution in the 
    <a rel="copyright" href="#credits">credits</a>.
  <br>&nbsp;

</ul>


<!-- ******* -->
<h2><a name="changes">List of Changes</a></h2>

The  
<a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/changes.html">List of Changes</a>
for each ERDDAP release is now on a separate web page.


<!-- ******* -->
<h2><a name="credits">Credits</a></h2>

ERDDAP is a product of the  
<a title="National Oceanic and Atmospheric Administration" rel="bookmark" href="http://www.noaa.gov">NOAA<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>  
<a title="National Marine Fisheries Service" rel="bookmark" href="http://www.nmfs.noaa.gov">NMFS<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>  
<a title="Environmental Research Division" rel="bookmark" href="http://swfsc.noaa.gov/textblock.aspx?Division=ERD&amp;id=1315&amp;ParentMenuId=200">ERD</a>.
<br>Bob Simons is the author of ERDDAP (the designer and programmer who wrote 
the ERDDAP-specific code).
<br>Roy Mendelssohn instigated the project and provides essential ongoing support
(including hardware, network, and other software support) that has made this 
project possible and facilitated this probject,
including by freeing up Bob's time so he could spend more time on the ERDDAP code.
<br>The ERDDAP-specific code is licensed as copyrighted open source, with 
  <a rel="bookmark" href="http://www.noaa.gov">NOAA<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> 
  holding the copyright. See the <a rel="copyright" href="#license">ERDDAP license</a>.
<br>ERDDAP uses copyrighted open source, Apache, LGPL, MIT/X, Mozilla, and public domain libraries and data.
<br>ERDDAP does not require any GPL code or commercial programs.

<p>The bulk of the funding for work on ERDDAP has come from NOAA,
in that it pays Bob Simons salary (he is a full time government employee with 
"hard"-money/full funding).
In the early days of ERDDAP, when he was a government contractor, 
funding came from the
<a rel="bookmark" href="http://coastwatch.noaa.gov/">NOAA CoastWatch<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> program, 
the <a rel="bookmark" href="http://www.ioos.gov/">NOAA IOOS<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
program, and the now defunct Pacific Ocean Shelf Tracking (POST) program.  

<p>Much credit goes to the many ERDDAP administrators and users who have made
suggestions and comments which have led to many improvements in ERDDAP. 
Many are mentioned by name in the 
<a rel="help" href="http://coastwatch.pfeg.noaa.gov/erddap/download/changes.html">List of Changes</a>.
Thank you all (named and unnamed) very much.

<p>Here is the list of software that ERDDAP uses. We very grateful for all of these.
Thank you very much.
(If we have accidentally omitted a project, please let us know so we can give
credit where credit is due.)

<ul>
<li>ERDDAP is a 
    <a rel="help" href="http://www.oracle.com/technetwork/java/javaee/servlet/index.html">Java Servlet<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
    program. At ERD, it runs inside of a
    <a rel="help" href="http://tomcat.apache.org/">Tomcat<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> application server
    (license: <a rel="bookmark" href="http://www.apache.org/licenses/">Apache<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>), 
  with an 
    <a rel="help" href="http://httpd.apache.org/">Apache<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> web server
    (license: <a rel="bookmark" href="http://www.apache.org/licenses/">Apache<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>), 
    running on a computer using the 
    <a rel="help" href="http://www.redhat.com/">Red Hat Linux<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> operating 
  system (license: <a rel="bookmark" href="http://www.linux.org/info/gnu.html">GPL<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>).
<li>The data sets are from various sources. See the metadata (in particular the "sourceUrl", "infoUrl", 
  and "institution") for each dataset.
<li> The com/cohort classes are from CoHort Software 
    (<a rel="help" href="http://www.cohort.com">http://www.cohort.com<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>)
    which makes these classes available with an MIT/X-like license (see classes/com/cohort/util/LICENSE.txt).
<li>Data from <a rel="help" href="http://www.opendap.org">OPeNDAP<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> servers are read 
    with <a rel="bookmark" href="http://www.opendap.org/download/index.html">Java DAP 1.1.7<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
    (license: LGPL).
<li>NetCDF files (.nc) and GMT-style NetCDF files (.grd) are read and written with code in the
  <a rel="help" href="http://www.unidata.ucar.edu/software/netcdf-java/index.htm">NetCDF Java Library<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
    (license: <a rel="bookmark" href="http://www.unidata.ucar.edu/software/netcdf/copyright.html">MIT/X-like<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>)
    from <a rel="bookmark" href="http://www.unidata.ucar.edu/">Unidata<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>.
<li>The NetCDF Java Library reads GRIB files via the Unidata
    <a rel="help" href="http://www.unidata.ucar.edu/software/decoders/">GRIB decoder (grib-6.0.jar)<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
  (license: <a rel="bookmark" href="http://www.unidata.ucar.edu/software/netcdf/copyright.html">MIT/X-like<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>).
<li>The NetCDF Java Library reads BUFR files via the Unidata
    <a rel="help" href="http://www.unidata.ucar.edu/software/decoders/">BUFR decoder <img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
  (license: <a rel="bookmark" href="http://www.unidata.ucar.edu/software/netcdf/copyright.html">MIT/X-like<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>).
<li>The NetCDF Java Library and Cassandra need <a rel="help" href="http://www.slf4j.org/"
  >slf4j from the Simple Logging Facade for Java</a> project.
  Currently, ERDDAP uses the slf4j-simple-xxx.jar renamed as slf4j.jar to meet this need.
    (license: <a rel="bookmark" href="http://www.slf4j.org/license.html">MIT/X<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>).
<li>ERDDAP and the NetCDF Java Library use <a rel="help" href="http://joda-time.sourceforge.net/">Joda<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> 
     for some calendar calculations.
     (license: <a rel="bookmark" href="http://joda-time.sourceforge.net/license.html">Apache<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>).
<li>The NetCDF Java Library uses code from some .jar files from 
  <a rel="help" href="http://www.apache.org/">Apache projects<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>:
  <a rel="help" href="http://commons.apache.org/codec/">commons-codec<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>, and
  <a rel="help" href="http://hc.apache.org/httpcomponents-client-ga/">commons-httpclient<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>.
  <!--a rel="help" href="http://commons.apache.org/logging/">commons-logging<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
  (license: <a rel="bookmark" href="http://www.apache.org/licenses/LICENSE-2.0">Apache<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>). -->
  Other parts of ERDDAP use code from other 
  <a rel="help" href="http://www.apache.org/">Apache projects<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>:
  <a rel="help" href="http://commons.apache.org/compress/">commons-compress<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> and
  <a rel="help" href="http://commons.apache.org/discovery/">commons-discovery<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
  (For all: license: <a rel="bookmark" href="http://www.apache.org/licenses/LICENSE-2.0">Apache<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>).
<li>The NetCDF Java Library uses XML processing code from 
    <a rel="help" href="http://www.jdom.org/">JDOM<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
    (license: <a rel="bookmark" href="http://www.jdom.org/docs/faq.html#a0030">Apache<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>).
<li>ERDDAP uses 
    <a rel="help" href="http://www.json.org/java/index.html">json.org's Java-based JSON library<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> 
    to parse <a rel="help" href="http://www.json.org/">JSON<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> data
  (license: <a rel="bookmark" href="http://www.json.org/license.html">copyrighted open source<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>).
<li>The graphs and maps are created on-the-fly with a modified version of NOAA's 
    <a rel="help" href="http://www.epic.noaa.gov/java/sgt/">SGT<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> version 3
  (a Java-based Scientific Graphics Toolkit written by Donald Denbo at
    <a rel="help" href="http://www.pmel.noaa.gov/">NOAA PMEL<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>)
  (license: <a rel="bookmark" href="http://www.epic.noaa.gov/java/license.html">copyrighted open source<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>).
<li>Big, HTML tooltips on ERDDAP's HTML pages are created with Walter Zorn's wz_tooltip.js
    <!-- was http://wztip.info/index.php/Main_Page -->
  (license: LGPL).
<li>Sliders and the drag and drop feature of the Slide Sorter are created with Walter Zorn's
  wz_dragdrop.js <!-- was http://www.walterzorn.com/dragdrop/dragdrop_e.htm -->
    (license: LGPL).
<li>The .pdf files are created with
    <a rel="help" href="http://itextpdf.com/">iText<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> 
      (version 1.3.1, which used the 
    <!-- was http://www.lowagie.com/iText/download.html --> Mozilla license),
    a free Java-PDF library by Bruno Lowagie and Paulo Soares.
<li>The shoreline and lake data are from
    <a rel="help" href="http://www.ngdc.noaa.gov/mgg/shorelines/gshhs.html">GSHHS<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
    - A Global Self-consistent, Hierarchical, 
    High-resolution Shoreline Database
    (license: <a rel="bookmark" href="http://www.soest.hawaii.edu/pwessel/gshhs/README.TXT">GPL<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>)
    and created by Paul Wessel and Walter Smith.
<li>The political boundary and river data are from the 
    <a rel="help" href="http://gmt.soest.hawaii.edu/gmt/doc/gmt/html/man/pscoast.html">pscoast<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
    program in 
    <a rel="help" href="http://gmt.soest.hawaii.edu">GMT<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>,
    which uses data from the 
  <a rel="help" href="http://www.evl.uic.edu/pape/data/WDB/">CIA World Data Bank II<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
    (license: public domain).
<li>The bathymetry/topography data used in the background of some maps is the  
  <a rel="help" href="http://www.ngdc.noaa.gov/mgg/global/global.html">ETOPO1 Global 1-Minute Gridded Elevation Data Set<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> 
      (Ice Surface, grid registered, binary, 
  2 byte int: etopo1_ice_g_i2.zip)
    (license:  
    <a rel="bookmark" href="http://www.ngdc.noaa.gov/ngdcinfo/privacy.html#copyright">public domain<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>), 
  which is distributed for free by 
    <a rel="bookmark" href="http://www.ngdc.noaa.gov">NOAA NGDC<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>.
<li> Emails are sent using code in mail.jar from Oracle's   
    <a rel="help" href="http://www.oracle.com/technetwork/java/javamail/index.html">JavaMail API<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
    (license: 
    <a rel="bookmark" href="http://download.oracle.com/otn-pub/java/licenses/OTN_JavaEE_Legacy_Binary-Code-License_30Jan2012.txt"
      >Oracle Binary Code License Agreement for Java EE Technologies<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>).
<!--li> JavaMail uses activation.jar from the 
    <a rel="help" href="http://www.oracle.com/technetwork/java/jaf11-139815.html">JavaBeans Activation Framework<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
    (license: 
    <a rel="bookmark" href="http://download.oracle.com/otn-pub/java/licenses/OTN_JavaEE_Legacy_Binary-Code-License_30Jan2012.txt"
    >Oracle Binary Code License Agreement for Java EE Technologies<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>. -->
<!-- li> For <a rel="help" href="http://openid.net/">OpenID<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> 
      authentication, ERDDAP uses the
     joid.jar and tsik.jar libraries from the 
     <a rel="help" href="https://github.com/bferg/joid">joid project<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> 
  from <a rel="bookmark" href="http://www.verisign.com">Verisign<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
     (license: <a rel="bookmark" href="http://code.google.com/p/joid/">Apache 2.0<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>). -->
<li> ERDDAP includes the 
     <a rel="help" href="http://jdbc.postgresql.org/">PostGres JDBC42<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> driver
     (license: <a rel="bookmark" href="http://jdbc.postgresql.org/license.html">BSD<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>).
    The driver is Copyright (c) 1997-2010, PostgreSQL Global Development Group. All rights reserved.
<li> ERDDAP includes  
     <a rel="help"
      href="http://cassandra.apache.org/">Cassandra's<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> 
     <a rel="help"
      href="http://www.datastax.com/download#dl-datastax-drivers">cassandra-driver-core.jar<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> 
     (license: <a rel="bookmark" 
      href="https://github.com/datastax/java-driver/blob/2.1/LICENSE">Apache 2.0<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>).

    <br>Cassandra's cassandra-driver-core.jar requires (and so ERDDAP includes):
    <ul>
    <li><a rel="help" href="http://netty.io/downloads.html">netty-all.jar<img 
        src="../images/external.png" align="bottom" alt=" (external link)" 
        title="This link to an external web site does not constitute an endorsement."/></a>
      (license: <a rel="bookmark" href="http://netty.io/downloads.html">Apache 2.0<img 
        src="../images/external.png" align="bottom" alt=" (external link)" 
        title="This link to an external web site does not constitute an endorsement."/></a>).

    <li><a rel="help" href="https://code.google.com/p/guava-libraries/">guava.jar<img 
        src="../images/external.png" align="bottom" alt=" (external link)" 
        title="This link to an external web site does not constitute an endorsement."/></a>
      (license: <a rel="bookmark" href="https://code.google.com/p/guava-libraries/">Apache 2.0<img 
        src="../images/external.png" align="bottom" alt=" (external link)" 
        title="This link to an external web site does not constitute an endorsement."/></a>).

    <li><a rel="help"
      href="http://mvnrepository.com/artifact/com.codahale.metrics/metrics-core/3.0.2">metrics-core.jar<img 
        src="../images/external.png" align="bottom" alt=" (external link)" 
        title="This link to an external web site does not constitute an endorsement."/></a>
      (license: <a rel="bookmark" href="https://github.com/codahale/metrics/blob/master/LICENSE">MIT<img 
        src="../images/external.png" align="bottom" alt=" (external link)" 
        title="This link to an external web site does not constitute an endorsement."/></a>).

    <li><a rel="help" href="http://repo1.maven.org/maven2/net/jpountz/lz4/lz4/">lz4.jar<img 
        src="../images/external.png" align="bottom" alt=" (external link)" 
        title="This link to an external web site does not constitute an endorsement."/></a>
      (license: 
      <a rel="bookmark" href="https://github.com/jpountz/lz4-java/blob/master/LICENSE.txt">Apache 2.0<img 
        src="../images/external.png" align="bottom" alt=" (external link)" 
        title="This link to an external web site does not constitute an endorsement."/></a>).

    <li><a rel="help" href="http://xerial.org/snappy-java/">snappy-java.jar<img 
        src="../images/external.png" align="bottom" alt=" (external link)" 
        title="This link to an external web site does not constitute an endorsement."/></a>
      (license: 
      <a rel="bookmark" href="https://github.com/xerial/snappy-java/blob/develop/LICENSE">Apache 2.0<img 
        src="../images/external.png" align="bottom" alt=" (external link)" 
        title="This link to an external web site does not constitute an endorsement."/></a>).
    </ul>

<li> For SOAP services, ERDDAP uses: 
  <ul>
  <li><a rel="help" href="http://ws.apache.org/axis/index.html">axis.jar<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> 
      (license: 
      <a rel="bookmark" href="http://www.apache.org/licenses/">Apache<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>)
  <li><a rel="help" href="http://java.net/projects/jax-rpc/">jaxrpc.jar<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> 
      (license: 
      <a rel="bookmark" href="http://www.opensource.org/licenses/cddl1.php">CDDL v1.0<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>)
  <li><a rel="help" href="http://java.net/projects/saaj/">saaj.jar<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> 
      (license: 
      <a rel="bookmark" href="http://www.opensource.org/licenses/cddl1.php">CDDL v1.0<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>)
  <li><a rel="help" href="http://sourceforge.net/projects/wsdl4j/">wsdl4j.jar<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> 
      (license: 
      <a rel="bookmark" href="http://sourceforge.net/projects/wsdl4j/">Common Public License 1.0<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>)
  </ul>

<li> EDDGridFromMergeIRFiles.java was written and contributed by
   Jonathan Lafite and Philippe Makowski of 
   <a rel="bookmark" href="http://rtech-engineering.com/?lang=en">R.Tech Engineering<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>
   (license: copyrighted open source).

<li> For working with Amazon AWS and S3, ERDDAP uses the
  <a rel="help" href="http://aws.amazon.com/sdk-for-java/">aws-java-sdk.jar<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> 
      (license: 
      <a rel="bookmark" href="http://www.apache.org/licenses/">Apache<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>).
  <br>aws-java-sdk.jar requires commons-codec.jar, commons-logging.jar,
      fluent-hc.jar,
      httpclient.jar, httpclient-cache.jar, httpclient-win.jar, 
      httpcore.jar, and httpmime.jar, which are all from the    
      <a rel="help" href="https://hc.apache.org/downloads.cgi">Apache Project<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> 
      (license: 
      <a rel="bookmark" href="http://www.apache.org/licenses/">Apache<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>).
  <br>aws-java-sdk.jar also requires the 
      <a rel="help" href="https://github.com/java-native-access/jna">Java Native Access 
      jna.jar and jna-platform.jar<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> 
      (license: 
      <a rel="bookmark" href="https://github.com/java-native-access/jna/blob/master/LICENSE">Apache 2.0<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>).
  <br>aws-java-sdk.jar also requires the 
      <a rel="help" href="http://mvnrepository.com/artifact/com.fasterxml.jackson.core"
      >jackson-annotations.jar, jackson-core.jar, and jackson-databind.jar<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> from 
      <a rel="help" href="https://github.com/FasterXML">FasterXML<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> 
      (license: 
      <a rel="bookmark" href="https://github.com/FasterXML/jackson-core#overview"
      >Apache 2.0<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>).

<li> ERDDAP uses code from the 
    <a rel="help" href="http://coastwatch.pfeg.noaa.gov/coastwatch/CWBrowser.jsp">CoastWatch Browser</a> 
    project from the
    <a rel="bookmark" href="http://coastwatch.noaa.gov">NOAA CoastWatch</a>
    <a rel="bookmark" href="http://coastwatch.pfeg.noaa.gov/">West Coast Regional Node</a>
    (license:  
    <a rel="bookmark" href="http://coastwatch.pfeg.noaa.gov/coastwatch/CWBrowserInfo.html#Credits">copyrighted open source</a>).
  That project was initiated and managed by Dave Foley, the Coordinator of the NOAA CoastWatch 
  West Coast Regional Node.  
  The CoastWatch Browser code was written by Bob Simons.
</ul>

<p>We are also very grateful for all of the software that we use when developing ERDDAP, 
including
    <a rel="help" href="https://www.google.com/chrome/browser/desktop/">Chrome<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>,
    <a rel="help" href="https://curl.haxx.se/">curl<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>, 
    <a rel="help" href="https://www.editplus.com/">EditPlus<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>,
    <a rel="help" href="https://filezilla-project.org/">FileZilla<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>.
    <a rel="help" href="https://github.com/">GitHub<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>,
    <a rel="help" href="https://www.google.com/webhp">Google Search<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>, 
    <a rel="help" href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html">PuTTY<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a>, 
    the Internet, the World Wide Web, and all the great, helpful websites.
Thank you very much.

<!-- ******* -->
<h2><a name="license">License</a></h2>
The ERDDAP-specific code is licensed as copyrighted open source, 
  with <a rel="bookmark" href="http://www.noaa.gov">NOAA<img 
      src="../images/external.png" align="bottom" alt=" (external link)" 
      title="This link to an external web site does not constitute an endorsement."/></a> holding the copyright.  
The license is:
<blockquote>
ERDDAP, Copyright 2016, NOAA.

<P>PERMISSION TO USE, COPY, MODIFY, AND DISTRIBUTE THIS SOFTWARE AND 
ITS DOCUMENTATION FOR ANY PURPOSE AND WITHOUT FEE IS HEREBY GRANTED,
PROVIDED THAT THE ABOVE COPYRIGHT NOTICE APPEAR IN ALL COPIES, THAT
BOTH THE COPYRIGHT NOTICE AND THIS PERMISSION NOTICE APPEAR IN
SUPPORTING DOCUMENTATION, AND THAT REDISTRIBUTIONS OF MODIFIED FORMS
OF THE SOURCE OR BINARY CODE CARRY PROMINENT NOTICES STATING THAT THE
ORIGINAL CODE WAS CHANGED AND THE DATE OF THE CHANGE.  THIS SOFTWARE
IS PROVIDED "AS IS" WITHOUT EXPRESS OR IMPLIED WARRANTY.
</blockquote>


<!-- ******* -->
<h2><a name="contact">Contact</a></h2>
Questions, comments, suggestions?  Please send an email to 
  <tt>bob dot simons at noaa dot gov</tt>
and include the ERDDAP URL directly related to your question or comment.

<p><a name="ERDDAPMailingList">Or,</a>
you can join the ERDDAP Google Group / Mailing List by visiting
<a rel="help"
href="https://groups.google.com/forum/#!forum/erddap">https://groups.google.com/forum/#!forum/erddap<img 
  src="../images/external.png" align="bottom" alt=" (external link)" 
  title="This link to an external web site does not constitute an endorsement."/></a> 
and clicking on "Apply for membership". 
Once you are a member, you can post your question there
or search to see if the question has already been asked and answered. 

<br>&nbsp;
<hr>
<p>ERDDAP, Version 1.70
<br><a rel="bookmark" href="http://coastwatch.pfeg.noaa.gov/erddap/legal.html">Disclaimers</a> | 
    <a rel="bookmark" href="http://coastwatch.pfeg.noaa.gov/erddap/legal.html#privacyPolicy">Privacy Policy</a>
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;
<p>&nbsp;

</td>
</tr>
</table>
</body>
</html>
